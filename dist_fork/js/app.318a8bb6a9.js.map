{
  "version": 3,
  "sources": ["../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/render/vnode.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/render/hyperscriptVnode.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/util/hasOwn.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/render/emptyAttrs.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/render/cachedAttrsIsStaticMap.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/render/hyperscript.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/render/trust.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/render/fragment.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/hyperscript.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/render/domFor.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/render/render.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/render.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/api/mount-redraw.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/mount-redraw.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/querystring/build.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/pathname/build.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/request/request.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/request.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/querystring/parse.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/pathname/parse.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/pathname/compileTemplate.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/util/censor.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/api/router.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/route.js", "../../node_modules/.deno/mithril@2.3.7/node_modules/mithril/index.js", "../../ts/index.ts", "../../ts/app.ts", "../../ts/components/header.ts", "../../ts/commons/events.ts", "../../node_modules/.deno/@rgrannell1+tribbledb@0.0.12/node_modules/@rgrannell1/tribbledb/dist/mod.js", "../../ts/services/dark-mode.ts", "../../ts/constants.ts", "../../ts/commons/strings.ts", "../../ts/semantic/derive.ts", "../../ts/semantic/data.ts", "../../ts/commons/numbers.ts", "../../ts/semantic/names.ts", "../../ts/commons/arrays.ts", "../../ts/services/things.ts", "../../ts/components/thing-link.ts", "../../ts/services/emoji.ts", "../../node_modules/.deno/valibot@1.1.0/node_modules/valibot/dist/index.js", "../../ts/parsers/schemas.ts", "../../ts/commons/logger.ts", "../../ts/parsers/parser.ts", "../../ts/parsers/location.ts", "../../ts/services/location.ts", "../../ts/parsers/album.ts", "../../ts/parsers/photo.ts", "../../ts/parsers/subject.ts", "../../ts/services/subjects.ts", "../../ts/services/photos.ts", "../../ts/parsers/video.ts", "../../ts/services/videos.ts", "../../ts/services/albums.ts", "../../ts/parsers/feature.ts", "../../ts/services/features.ts", "../../ts/state.ts", "../../ts/components/sidebar.ts", "../../ts/pages/albums.ts", "../../ts/components/album-stats.ts", "../../ts/components/photo-album-metadata.ts", "../../ts/services/window.ts", "../../ts/services/dates.ts", "../../ts/components/photo-album.ts", "../../ts/components/photo.ts", "../../ts/components/metadata-icon.ts", "../../ts/components/place-links.ts", "../../ts/models/urn.ts", "../../ts/pages/about.ts", "../../ts/pages/videos.ts", "../../ts/components/video.ts", "../../ts/pages/album.ts", "../../ts/components/album-share-button.ts", "../../ts/components/albums-button.ts", "../../ts/components/album-things.ts", "../../ts/pages/photos.ts", "../../ts/pages/photo.ts", "../../ts/components/album-button.ts", "../../ts/components/exif-data.ts", "../../ts/components/photo-info.ts", "../../ts/pages/listing.ts", "../../ts/pages/thing.ts", "../../ts/components/thing-title.ts", "../../ts/components/external-link.ts", "../../ts/components/places-list.ts", "../../ts/commons/sets.ts", "../../ts/components/listing-link.ts", "../../ts/components/features-list.ts", "../../ts/components/unesco-list.ts", "../../ts/components/unesco-link.ts"],
  "sourcesContent": ["\"use strict\"\n\nfunction Vnode(tag, key, attrs, children, text, dom) {\n\treturn {tag: tag, key: key, attrs: attrs, children: children, text: text, dom: dom, is: undefined, domSize: undefined, state: undefined, events: undefined, instance: undefined}\n}\nVnode.normalize = function(node) {\n\tif (Array.isArray(node)) return Vnode(\"[\", undefined, undefined, Vnode.normalizeChildren(node), undefined, undefined)\n\tif (node == null || typeof node === \"boolean\") return null\n\tif (typeof node === \"object\") return node\n\treturn Vnode(\"#\", undefined, undefined, String(node), undefined, undefined)\n}\nVnode.normalizeChildren = function(input) {\n\tvar children = []\n\tif (input.length) {\n\t\tvar isKeyed = input[0] != null && input[0].key != null\n\t\t// Note: this is a *very* perf-sensitive check.\n\t\t// Fun fact: merging the loop like this is somehow faster than splitting\n\t\t// it, noticeably so.\n\t\tfor (var i = 1; i < input.length; i++) {\n\t\t\tif ((input[i] != null && input[i].key != null) !== isKeyed) {\n\t\t\t\tthrow new TypeError(\n\t\t\t\t\tisKeyed && (input[i] == null || typeof input[i] === \"boolean\")\n\t\t\t\t\t\t? \"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.\"\n\t\t\t\t\t\t: \"In fragments, vnodes must either all have keys or none have keys.\"\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t\tfor (var i = 0; i < input.length; i++) {\n\t\t\tchildren[i] = Vnode.normalize(input[i])\n\t\t}\n\t}\n\treturn children\n}\n\nmodule.exports = Vnode\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\n\n// Note: the processing of variadic parameters is perf-sensitive.\n//\n// In native ES6, it might be preferable to define hyperscript and fragment\n// factories with a final ...args parameter and call hyperscriptVnode(...args),\n// since modern engines can optimize spread calls.\n//\n// However, benchmarks showed this was not faster. As a result, spread is used\n// only in the parameter lists of hyperscript and fragment, while an array is\n// passed to hyperscriptVnode.\nmodule.exports = function(attrs, children) {\n\tif (attrs == null || typeof attrs === \"object\" && attrs.tag == null && !Array.isArray(attrs)) {\n\t\tif (children.length === 1 && Array.isArray(children[0])) children = children[0]\n\t} else {\n\t\tchildren = children.length === 0 && Array.isArray(attrs) ? attrs : [attrs, ...children]\n\t\tattrs = undefined\n\t}\n\n\treturn Vnode(\"\", attrs && attrs.key, attrs, children)\n}\n", "// This exists so I'm only saving it once.\n\"use strict\"\n\nmodule.exports = {}.hasOwnProperty\n", "\"use strict\"\n\n// This is an attrs object that is used by default when attrs is undefined or null.\nmodule.exports = {}\n", "\"use strict\"\n\nvar emptyAttrs = require(\"./emptyAttrs\")\n\n// This Map manages the following:\n// - Whether an attrs is cached attrs generated by compileSelector().\n// - Whether the cached attrs is \"static\", i.e., does not contain any form attributes.\n// These information will be useful to skip updating attrs in render().\n//\n// Since the attrs used as keys in this map are not released from the selectorCache object,\n// there is no risk of memory leaks. Therefore, Map is used here instead of WeakMap.\nmodule.exports = new Map([[emptyAttrs, true]])\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\nvar hyperscriptVnode = require(\"./hyperscriptVnode\")\nvar hasOwn = require(\"../util/hasOwn\")\nvar emptyAttrs = require(\"./emptyAttrs\")\nvar cachedAttrsIsStaticMap = require(\"./cachedAttrsIsStaticMap\")\n\nvar selectorParser = /(?:(^|#|\\.)([^#\\.\\[\\]]+))|(\\[(.+?)(?:\\s*=\\s*(\"|'|)((?:\\\\[\"'\\]]|.)*?)\\5)?\\])/g\nvar selectorCache = Object.create(null)\n\nfunction isEmpty(object) {\n\tfor (var key in object) if (hasOwn.call(object, key)) return false\n\treturn true\n}\n\nfunction isFormAttributeKey(key) {\n\treturn key === \"value\" || key === \"checked\" || key === \"selectedIndex\" || key === \"selected\"\n}\n\nfunction compileSelector(selector) {\n\tvar match, tag = \"div\", classes = [], attrs = {}, isStatic = true\n\twhile (match = selectorParser.exec(selector)) {\n\t\tvar type = match[1], value = match[2]\n\t\tif (type === \"\" && value !== \"\") tag = value\n\t\telse if (type === \"#\") attrs.id = value\n\t\telse if (type === \".\") classes.push(value)\n\t\telse if (match[3][0] === \"[\") {\n\t\t\tvar attrValue = match[6]\n\t\t\tif (attrValue) attrValue = attrValue.replace(/\\\\([\"'])/g, \"$1\").replace(/\\\\\\\\/g, \"\\\\\")\n\t\t\tif (match[4] === \"class\") classes.push(attrValue)\n\t\t\telse {\n\t\t\t\tattrs[match[4]] = attrValue === \"\" ? attrValue : attrValue || true\n\t\t\t\tif (isFormAttributeKey(match[4])) isStatic = false\n\t\t\t}\n\t\t}\n\t}\n\tif (classes.length > 0) attrs.className = classes.join(\" \")\n\tif (isEmpty(attrs)) attrs = emptyAttrs\n\telse cachedAttrsIsStaticMap.set(attrs, isStatic)\n\treturn selectorCache[selector] = {tag: tag, attrs: attrs, is: attrs.is}\n}\n\nfunction execSelector(state, vnode) {\n\tvnode.tag = state.tag\n\n\tvar attrs = vnode.attrs\n\tif (attrs == null) {\n\t\tvnode.attrs = state.attrs\n\t\tvnode.is = state.is\n\t\treturn vnode\n\t}\n\n\tvar hasClass = hasOwn.call(attrs, \"class\")\n\tvar className = hasClass ? attrs.class : attrs.className\n\n\tif (state.attrs !== emptyAttrs) {\n\t\tattrs = Object.assign({}, state.attrs, attrs)\n\n\t\tif (className != null || state.attrs.className != null) attrs.className =\n\t\t\tclassName != null\n\t\t\t\t? state.attrs.className != null\n\t\t\t\t\t? String(state.attrs.className) + \" \" + String(className)\n\t\t\t\t\t: className\n\t\t\t\t: state.attrs.className\n\t} else {\n\t\tif (className != null) attrs.className = className\n\t}\n\n\tif (hasClass) attrs.class = null\n\n\t// workaround for #2622 (reorder keys in attrs to set \"type\" first)\n\t// The DOM does things to inputs based on the \"type\", so it needs set first.\n\t// See: https://github.com/MithrilJS/mithril.js/issues/2622\n\tif (state.tag === \"input\" && hasOwn.call(attrs, \"type\")) {\n\t\tattrs = Object.assign({type: attrs.type}, attrs)\n\t}\n\n\t// This reduces the complexity of the evaluation of \"is\" within the render function.\n\tvnode.is = attrs.is\n\n\tvnode.attrs = attrs\n\n\treturn vnode\n}\n\nfunction hyperscript(selector, attrs, ...children) {\n\tif (selector == null || typeof selector !== \"string\" && typeof selector !== \"function\" && typeof selector.view !== \"function\") {\n\t\tthrow Error(\"The selector must be either a string or a component.\");\n\t}\n\n\tvar vnode = hyperscriptVnode(attrs, children)\n\n\tif (typeof selector === \"string\") {\n\t\tvnode.children = Vnode.normalizeChildren(vnode.children)\n\t\tif (selector !== \"[\") return execSelector(selectorCache[selector] || compileSelector(selector), vnode)\n\t}\n\n\tif (vnode.attrs == null) vnode.attrs = {}\n\tvnode.tag = selector\n\treturn vnode\n}\n\nmodule.exports = hyperscript\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\n\nmodule.exports = function(html) {\n\tif (html == null) html = \"\"\n\treturn Vnode(\"<\", undefined, undefined, html, undefined, undefined)\n}\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\nvar hyperscriptVnode = require(\"./hyperscriptVnode\")\n\nmodule.exports = function(attrs, ...children) {\n\tvar vnode = hyperscriptVnode(attrs, children)\n\n\tif (vnode.attrs == null) vnode.attrs = {}\n\tvnode.tag = \"[\"\n\tvnode.children = Vnode.normalizeChildren(vnode.children)\n\treturn vnode\n}\n", "\"use strict\"\n\nvar hyperscript = require(\"./render/hyperscript\")\n\nhyperscript.trust = require(\"./render/trust\")\nhyperscript.fragment = require(\"./render/fragment\")\n\nmodule.exports = hyperscript\n", "\"use strict\"\n\nvar delayedRemoval = new WeakMap\n\nfunction *domFor(vnode) {\n\t// To avoid unintended mangling of the internal bundler,\n\t// parameter destructuring is not used here.\n\tvar dom = vnode.dom\n\tvar domSize = vnode.domSize\n\tvar generation = delayedRemoval.get(dom)\n\tif (dom != null) do {\n\t\tvar nextSibling = dom.nextSibling\n\n\t\tif (delayedRemoval.get(dom) === generation) {\n\t\t\tyield dom\n\t\t\tdomSize--\n\t\t}\n\n\t\tdom = nextSibling\n\t}\n\twhile (domSize)\n}\n\nmodule.exports = {\n\tdelayedRemoval: delayedRemoval,\n\tdomFor: domFor,\n}\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\nvar df = require(\"../render/domFor\")\nvar delayedRemoval = df.delayedRemoval\nvar domFor = df.domFor\nvar cachedAttrsIsStaticMap = require(\"./cachedAttrsIsStaticMap\")\n\nmodule.exports = function() {\n\tvar nameSpace = {\n\t\tsvg: \"http://www.w3.org/2000/svg\",\n\t\tmath: \"http://www.w3.org/1998/Math/MathML\"\n\t}\n\n\tvar currentRedraw\n\tvar currentRender\n\n\tfunction getDocument(dom) {\n\t\treturn dom.ownerDocument;\n\t}\n\n\tfunction getNameSpace(vnode) {\n\t\treturn vnode.attrs && vnode.attrs.xmlns || nameSpace[vnode.tag]\n\t}\n\n\t//sanity check to discourage people from doing `vnode.state = ...`\n\tfunction checkState(vnode, original) {\n\t\tif (vnode.state !== original) throw new Error(\"'vnode.state' must not be modified.\")\n\t}\n\n\t//Note: the hook is passed as the `this` argument to allow proxying the\n\t//arguments without requiring a full array allocation to do so. It also\n\t//takes advantage of the fact the current `vnode` is the first argument in\n\t//all lifecycle methods.\n\tfunction callHook(vnode) {\n\t\tvar original = vnode.state\n\t\ttry {\n\t\t\treturn this.apply(original, arguments)\n\t\t} finally {\n\t\t\tcheckState(vnode, original)\n\t\t}\n\t}\n\n\t// IE11 (at least) throws an UnspecifiedError when accessing document.activeElement when\n\t// inside an iframe. Catch and swallow this error, and heavy-handidly return null.\n\tfunction activeElement(dom) {\n\t\ttry {\n\t\t\treturn getDocument(dom).activeElement\n\t\t} catch (e) {\n\t\t\treturn null\n\t\t}\n\t}\n\t//create\n\tfunction createNodes(parent, vnodes, start, end, hooks, nextSibling, ns) {\n\t\tfor (var i = start; i < end; i++) {\n\t\t\tvar vnode = vnodes[i]\n\t\t\tif (vnode != null) {\n\t\t\t\tcreateNode(parent, vnode, hooks, ns, nextSibling)\n\t\t\t}\n\t\t}\n\t}\n\tfunction createNode(parent, vnode, hooks, ns, nextSibling) {\n\t\tvar tag = vnode.tag\n\t\tif (typeof tag === \"string\") {\n\t\t\tvnode.state = {}\n\t\t\tif (vnode.attrs != null) initLifecycle(vnode.attrs, vnode, hooks)\n\t\t\tswitch (tag) {\n\t\t\t\tcase \"#\": createText(parent, vnode, nextSibling); break\n\t\t\t\tcase \"<\": createHTML(parent, vnode, ns, nextSibling); break\n\t\t\t\tcase \"[\": createFragment(parent, vnode, hooks, ns, nextSibling); break\n\t\t\t\tdefault: createElement(parent, vnode, hooks, ns, nextSibling)\n\t\t\t}\n\t\t}\n\t\telse createComponent(parent, vnode, hooks, ns, nextSibling)\n\t}\n\tfunction createText(parent, vnode, nextSibling) {\n\t\tvnode.dom = getDocument(parent).createTextNode(vnode.children)\n\t\tinsertDOM(parent, vnode.dom, nextSibling)\n\t}\n\tvar possibleParents = {caption: \"table\", thead: \"table\", tbody: \"table\", tfoot: \"table\", tr: \"tbody\", th: \"tr\", td: \"tr\", colgroup: \"table\", col: \"colgroup\"}\n\tfunction createHTML(parent, vnode, ns, nextSibling) {\n\t\tvar match = vnode.children.match(/^\\s*?<(\\w+)/im) || []\n\t\t// not using the proper parent makes the child element(s) vanish.\n\t\t//     var div = document.createElement(\"div\")\n\t\t//     div.innerHTML = \"<td>i</td><td>j</td>\"\n\t\t//     console.log(div.innerHTML)\n\t\t// --> \"ij\", no <td> in sight.\n\t\tvar temp = getDocument(parent).createElement(possibleParents[match[1]] || \"div\")\n\t\tif (ns === \"http://www.w3.org/2000/svg\") {\n\t\t\ttemp.innerHTML = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\">\" + vnode.children + \"</svg>\"\n\t\t\ttemp = temp.firstChild\n\t\t} else {\n\t\t\ttemp.innerHTML = vnode.children\n\t\t}\n\t\tvnode.dom = temp.firstChild\n\t\tvnode.domSize = temp.childNodes.length\n\t\t// Capture nodes to remove, so we don't confuse them.\n\t\tvar fragment = getDocument(parent).createDocumentFragment()\n\t\tvar child\n\t\twhile (child = temp.firstChild) {\n\t\t\tfragment.appendChild(child)\n\t\t}\n\t\tinsertDOM(parent, fragment, nextSibling)\n\t}\n\tfunction createFragment(parent, vnode, hooks, ns, nextSibling) {\n\t\tvar fragment = getDocument(parent).createDocumentFragment()\n\t\tif (vnode.children != null) {\n\t\t\tvar children = vnode.children\n\t\t\tcreateNodes(fragment, children, 0, children.length, hooks, null, ns)\n\t\t}\n\t\tvnode.dom = fragment.firstChild\n\t\tvnode.domSize = fragment.childNodes.length\n\t\tinsertDOM(parent, fragment, nextSibling)\n\t}\n\tfunction createElement(parent, vnode, hooks, ns, nextSibling) {\n\t\tvar tag = vnode.tag\n\t\tvar attrs = vnode.attrs\n\t\tvar is = vnode.is\n\n\t\tns = getNameSpace(vnode) || ns\n\n\t\tvar element = ns ?\n\t\t\tis ? getDocument(parent).createElementNS(ns, tag, {is: is}) : getDocument(parent).createElementNS(ns, tag) :\n\t\t\tis ? getDocument(parent).createElement(tag, {is: is}) : getDocument(parent).createElement(tag)\n\t\tvnode.dom = element\n\n\t\tif (attrs != null) {\n\t\t\tsetAttrs(vnode, attrs, ns)\n\t\t}\n\n\t\tinsertDOM(parent, element, nextSibling)\n\n\t\tif (!maybeSetContentEditable(vnode)) {\n\t\t\tif (vnode.children != null) {\n\t\t\t\tvar children = vnode.children\n\t\t\t\tcreateNodes(element, children, 0, children.length, hooks, null, ns)\n\t\t\t\tif (vnode.tag === \"select\" && attrs != null) setLateSelectAttrs(vnode, attrs)\n\t\t\t}\n\t\t}\n\t}\n\tfunction initComponent(vnode, hooks) {\n\t\tvar sentinel\n\t\tif (typeof vnode.tag.view === \"function\") {\n\t\t\tvnode.state = Object.create(vnode.tag)\n\t\t\tsentinel = vnode.state.view\n\t\t\tif (sentinel.$$reentrantLock$$ != null) return\n\t\t\tsentinel.$$reentrantLock$$ = true\n\t\t} else {\n\t\t\tvnode.state = void 0\n\t\t\tsentinel = vnode.tag\n\t\t\tif (sentinel.$$reentrantLock$$ != null) return\n\t\t\tsentinel.$$reentrantLock$$ = true\n\t\t\tvnode.state = (vnode.tag.prototype != null && typeof vnode.tag.prototype.view === \"function\") ? new vnode.tag(vnode) : vnode.tag(vnode)\n\t\t}\n\t\tinitLifecycle(vnode.state, vnode, hooks)\n\t\tif (vnode.attrs != null) initLifecycle(vnode.attrs, vnode, hooks)\n\t\tvnode.instance = Vnode.normalize(callHook.call(vnode.state.view, vnode))\n\t\tif (vnode.instance === vnode) throw Error(\"A view cannot return the vnode it received as argument\")\n\t\tsentinel.$$reentrantLock$$ = null\n\t}\n\tfunction createComponent(parent, vnode, hooks, ns, nextSibling) {\n\t\tinitComponent(vnode, hooks)\n\t\tif (vnode.instance != null) {\n\t\t\tcreateNode(parent, vnode.instance, hooks, ns, nextSibling)\n\t\t\tvnode.dom = vnode.instance.dom\n\t\t\tvnode.domSize = vnode.dom != null ? vnode.instance.domSize : 0\n\t\t}\n\t\telse {\n\t\t\tvnode.domSize = 0\n\t\t}\n\t}\n\n\t//update\n\t/**\n\t * @param {Element|Fragment} parent - the parent element\n\t * @param {Vnode[] | null} old - the list of vnodes of the last `render()` call for\n\t *                               this part of the tree\n\t * @param {Vnode[] | null} vnodes - as above, but for the current `render()` call.\n\t * @param {Function[]} hooks - an accumulator of post-render hooks (oncreate/onupdate)\n\t * @param {Element | null} nextSibling - the next DOM node if we're dealing with a\n\t *                                       fragment that is not the last item in its\n\t *                                       parent\n\t * @param {'svg' | 'math' | String | null} ns) - the current XML namespace, if any\n\t * @returns void\n\t */\n\t// This function diffs and patches lists of vnodes, both keyed and unkeyed.\n\t//\n\t// We will:\n\t//\n\t// 1. describe its general structure\n\t// 2. focus on the diff algorithm optimizations\n\t// 3. discuss DOM node operations.\n\n\t// ## Overview:\n\t//\n\t// The updateNodes() function:\n\t// - deals with trivial cases\n\t// - determines whether the lists are keyed or unkeyed based on the first non-null node\n\t//   of each list.\n\t// - diffs them and patches the DOM if needed (that's the brunt of the code)\n\t// - manages the leftovers: after diffing, are there:\n\t//   - old nodes left to remove?\n\t// \t - new nodes to insert?\n\t// \t deal with them!\n\t//\n\t// The lists are only iterated over once, with an exception for the nodes in `old` that\n\t// are visited in the fourth part of the diff and in the `removeNodes` loop.\n\n\t// ## Diffing\n\t//\n\t// Reading https://github.com/localvoid/ivi/blob/ddc09d06abaef45248e6133f7040d00d3c6be853/packages/ivi/src/vdom/implementation.ts#L617-L837\n\t// may be good for context on longest increasing subsequence-based logic for moving nodes.\n\t//\n\t// In order to diff keyed lists, one has to\n\t//\n\t// 1) match nodes in both lists, per key, and update them accordingly\n\t// 2) create the nodes present in the new list, but absent in the old one\n\t// 3) remove the nodes present in the old list, but absent in the new one\n\t// 4) figure out what nodes in 1) to move in order to minimize the DOM operations.\n\t//\n\t// To achieve 1) one can create a dictionary of keys => index (for the old list), then iterate\n\t// over the new list and for each new vnode, find the corresponding vnode in the old list using\n\t// the map.\n\t// 2) is achieved in the same step: if a new node has no corresponding entry in the map, it is new\n\t// and must be created.\n\t// For the removals, we actually remove the nodes that have been updated from the old list.\n\t// The nodes that remain in that list after 1) and 2) have been performed can be safely removed.\n\t// The fourth step is a bit more complex and relies on the longest increasing subsequence (LIS)\n\t// algorithm.\n\t//\n\t// the longest increasing subsequence is the list of nodes that can remain in place. Imagine going\n\t// from `1,2,3,4,5` to `4,5,1,2,3` where the numbers are not necessarily the keys, but the indices\n\t// corresponding to the keyed nodes in the old list (keyed nodes `e,d,c,b,a` => `b,a,e,d,c` would\n\t//  match the above lists, for example).\n\t//\n\t// In there are two increasing subsequences: `4,5` and `1,2,3`, the latter being the longest. We\n\t// can update those nodes without moving them, and only call `insertNode` on `4` and `5`.\n\t//\n\t// @localvoid adapted the algo to also support node deletions and insertions (the `lis` is actually\n\t// the longest increasing subsequence *of old nodes still present in the new list*).\n\t//\n\t// It is a general algorithm that is fireproof in all circumstances, but it requires the allocation\n\t// and the construction of a `key => oldIndex` map, and three arrays (one with `newIndex => oldIndex`,\n\t// the `LIS` and a temporary one to create the LIS).\n\t//\n\t// So we cheat where we can: if the tails of the lists are identical, they are guaranteed to be part of\n\t// the LIS and can be updated without moving them.\n\t//\n\t// If two nodes are swapped, they are guaranteed not to be part of the LIS, and must be moved (with\n\t// the exception of the last node if the list is fully reversed).\n\t//\n\t// ## Finding the next sibling.\n\t//\n\t// `updateNode()` and `createNode()` expect a nextSibling parameter to perform DOM operations.\n\t// When the list is being traversed top-down, at any index, the DOM nodes up to the previous\n\t// vnode reflect the content of the new list, whereas the rest of the DOM nodes reflect the old\n\t// list. The next sibling must be looked for in the old list using `getNextSibling(... oldStart + 1 ...)`.\n\t//\n\t// In the other scenarios (swaps, upwards traversal, map-based diff),\n\t// the new vnodes list is traversed upwards. The DOM nodes at the bottom of the list reflect the\n\t// bottom part of the new vnodes list, and we can use the `v.dom`  value of the previous node\n\t// as the next sibling (cached in the `nextSibling` variable).\n\n\n\t// ## DOM node moves\n\t//\n\t// In most scenarios `updateNode()` and `createNode()` perform the DOM operations. However,\n\t// this is not the case if the node moved (second and fourth part of the diff algo). We move\n\t// the old DOM nodes before updateNode runs because it enables us to use the cached `nextSibling`\n\t// variable rather than fetching it using `getNextSibling()`.\n\n\tfunction updateNodes(parent, old, vnodes, hooks, nextSibling, ns) {\n\t\tif (old === vnodes || old == null && vnodes == null) return\n\t\telse if (old == null || old.length === 0) createNodes(parent, vnodes, 0, vnodes.length, hooks, nextSibling, ns)\n\t\telse if (vnodes == null || vnodes.length === 0) removeNodes(parent, old, 0, old.length)\n\t\telse {\n\t\t\tvar isOldKeyed = old[0] != null && old[0].key != null\n\t\t\tvar isKeyed = vnodes[0] != null && vnodes[0].key != null\n\t\t\tvar start = 0, oldStart = 0\n\t\t\tif (!isOldKeyed) while (oldStart < old.length && old[oldStart] == null) oldStart++\n\t\t\tif (!isKeyed) while (start < vnodes.length && vnodes[start] == null) start++\n\t\t\tif (isOldKeyed !== isKeyed) {\n\t\t\t\tremoveNodes(parent, old, oldStart, old.length)\n\t\t\t\tcreateNodes(parent, vnodes, start, vnodes.length, hooks, nextSibling, ns)\n\t\t\t} else if (!isKeyed) {\n\t\t\t\t// Don't index past the end of either list (causes deopts).\n\t\t\t\tvar commonLength = old.length < vnodes.length ? old.length : vnodes.length\n\t\t\t\t// Rewind if necessary to the first non-null index on either side.\n\t\t\t\t// We could alternatively either explicitly create or remove nodes when `start !== oldStart`\n\t\t\t\t// but that would be optimizing for sparse lists which are more rare than dense ones.\n\t\t\t\tstart = start < oldStart ? start : oldStart\n\t\t\t\tfor (; start < commonLength; start++) {\n\t\t\t\t\to = old[start]\n\t\t\t\t\tv = vnodes[start]\n\t\t\t\t\tif (o === v || o == null && v == null) continue\n\t\t\t\t\telse if (o == null) createNode(parent, v, hooks, ns, getNextSibling(old, start + 1, nextSibling))\n\t\t\t\t\telse if (v == null) removeNode(parent, o)\n\t\t\t\t\telse updateNode(parent, o, v, hooks, getNextSibling(old, start + 1, nextSibling), ns)\n\t\t\t\t}\n\t\t\t\tif (old.length > commonLength) removeNodes(parent, old, start, old.length)\n\t\t\t\tif (vnodes.length > commonLength) createNodes(parent, vnodes, start, vnodes.length, hooks, nextSibling, ns)\n\t\t\t} else {\n\t\t\t\t// keyed diff\n\t\t\t\tvar oldEnd = old.length - 1, end = vnodes.length - 1, map, o, v, oe, ve, topSibling\n\n\t\t\t\t// bottom-up\n\t\t\t\twhile (oldEnd >= oldStart && end >= start) {\n\t\t\t\t\toe = old[oldEnd]\n\t\t\t\t\tve = vnodes[end]\n\t\t\t\t\tif (oe.key !== ve.key) break\n\t\t\t\t\tif (oe !== ve) updateNode(parent, oe, ve, hooks, nextSibling, ns)\n\t\t\t\t\tif (ve.dom != null) nextSibling = ve.dom\n\t\t\t\t\toldEnd--, end--\n\t\t\t\t}\n\t\t\t\t// top-down\n\t\t\t\twhile (oldEnd >= oldStart && end >= start) {\n\t\t\t\t\to = old[oldStart]\n\t\t\t\t\tv = vnodes[start]\n\t\t\t\t\tif (o.key !== v.key) break\n\t\t\t\t\toldStart++, start++\n\t\t\t\t\tif (o !== v) updateNode(parent, o, v, hooks, getNextSibling(old, oldStart, nextSibling), ns)\n\t\t\t\t}\n\t\t\t\t// swaps and list reversals\n\t\t\t\twhile (oldEnd >= oldStart && end >= start) {\n\t\t\t\t\tif (start === end) break\n\t\t\t\t\tif (o.key !== ve.key || oe.key !== v.key) break\n\t\t\t\t\ttopSibling = getNextSibling(old, oldStart, nextSibling)\n\t\t\t\t\tmoveDOM(parent, oe, topSibling)\n\t\t\t\t\tif (oe !== v) updateNode(parent, oe, v, hooks, topSibling, ns)\n\t\t\t\t\tif (++start <= --end) moveDOM(parent, o, nextSibling)\n\t\t\t\t\tif (o !== ve) updateNode(parent, o, ve, hooks, nextSibling, ns)\n\t\t\t\t\tif (ve.dom != null) nextSibling = ve.dom\n\t\t\t\t\toldStart++; oldEnd--\n\t\t\t\t\toe = old[oldEnd]\n\t\t\t\t\tve = vnodes[end]\n\t\t\t\t\to = old[oldStart]\n\t\t\t\t\tv = vnodes[start]\n\t\t\t\t}\n\t\t\t\t// bottom up once again\n\t\t\t\twhile (oldEnd >= oldStart && end >= start) {\n\t\t\t\t\tif (oe.key !== ve.key) break\n\t\t\t\t\tif (oe !== ve) updateNode(parent, oe, ve, hooks, nextSibling, ns)\n\t\t\t\t\tif (ve.dom != null) nextSibling = ve.dom\n\t\t\t\t\toldEnd--, end--\n\t\t\t\t\toe = old[oldEnd]\n\t\t\t\t\tve = vnodes[end]\n\t\t\t\t}\n\t\t\t\tif (start > end) removeNodes(parent, old, oldStart, oldEnd + 1)\n\t\t\t\telse if (oldStart > oldEnd) createNodes(parent, vnodes, start, end + 1, hooks, nextSibling, ns)\n\t\t\t\telse {\n\t\t\t\t\t// inspired by ivi https://github.com/ivijs/ivi/ by Boris Kaul\n\t\t\t\t\tvar originalNextSibling = nextSibling, vnodesLength = end - start + 1, oldIndices = new Array(vnodesLength), li=0, i=0, pos = 2147483647, matched = 0, map, lisIndices\n\t\t\t\t\tfor (i = 0; i < vnodesLength; i++) oldIndices[i] = -1\n\t\t\t\t\tfor (i = end; i >= start; i--) {\n\t\t\t\t\t\tif (map == null) map = getKeyMap(old, oldStart, oldEnd + 1)\n\t\t\t\t\t\tve = vnodes[i]\n\t\t\t\t\t\tvar oldIndex = map[ve.key]\n\t\t\t\t\t\tif (oldIndex != null) {\n\t\t\t\t\t\t\tpos = (oldIndex < pos) ? oldIndex : -1 // becomes -1 if nodes were re-ordered\n\t\t\t\t\t\t\toldIndices[i-start] = oldIndex\n\t\t\t\t\t\t\toe = old[oldIndex]\n\t\t\t\t\t\t\told[oldIndex] = null\n\t\t\t\t\t\t\tif (oe !== ve) updateNode(parent, oe, ve, hooks, nextSibling, ns)\n\t\t\t\t\t\t\tif (ve.dom != null) nextSibling = ve.dom\n\t\t\t\t\t\t\tmatched++\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnextSibling = originalNextSibling\n\t\t\t\t\tif (matched !== oldEnd - oldStart + 1) removeNodes(parent, old, oldStart, oldEnd + 1)\n\t\t\t\t\tif (matched === 0) createNodes(parent, vnodes, start, end + 1, hooks, nextSibling, ns)\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (pos === -1) {\n\t\t\t\t\t\t\t// the indices of the indices of the items that are part of the\n\t\t\t\t\t\t\t// longest increasing subsequence in the oldIndices list\n\t\t\t\t\t\t\tlisIndices = makeLisIndices(oldIndices)\n\t\t\t\t\t\t\tli = lisIndices.length - 1\n\t\t\t\t\t\t\tfor (i = end; i >= start; i--) {\n\t\t\t\t\t\t\t\tv = vnodes[i]\n\t\t\t\t\t\t\t\tif (oldIndices[i-start] === -1) createNode(parent, v, hooks, ns, nextSibling)\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tif (lisIndices[li] === i - start) li--\n\t\t\t\t\t\t\t\t\telse moveDOM(parent, v, nextSibling)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (v.dom != null) nextSibling = vnodes[i].dom\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfor (i = end; i >= start; i--) {\n\t\t\t\t\t\t\t\tv = vnodes[i]\n\t\t\t\t\t\t\t\tif (oldIndices[i-start] === -1) createNode(parent, v, hooks, ns, nextSibling)\n\t\t\t\t\t\t\t\tif (v.dom != null) nextSibling = vnodes[i].dom\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfunction updateNode(parent, old, vnode, hooks, nextSibling, ns) {\n\t\tvar oldTag = old.tag, tag = vnode.tag\n\t\tif (oldTag === tag && old.is === vnode.is) {\n\t\t\tvnode.state = old.state\n\t\t\tvnode.events = old.events\n\t\t\tif (shouldNotUpdate(vnode, old)) return\n\t\t\tif (typeof oldTag === \"string\") {\n\t\t\t\tif (vnode.attrs != null) {\n\t\t\t\t\tupdateLifecycle(vnode.attrs, vnode, hooks)\n\t\t\t\t}\n\t\t\t\tswitch (oldTag) {\n\t\t\t\t\tcase \"#\": updateText(old, vnode); break\n\t\t\t\t\tcase \"<\": updateHTML(parent, old, vnode, ns, nextSibling); break\n\t\t\t\t\tcase \"[\": updateFragment(parent, old, vnode, hooks, nextSibling, ns); break\n\t\t\t\t\tdefault: updateElement(old, vnode, hooks, ns)\n\t\t\t\t}\n\t\t\t}\n\t\t\telse updateComponent(parent, old, vnode, hooks, nextSibling, ns)\n\t\t}\n\t\telse {\n\t\t\tremoveNode(parent, old)\n\t\t\tcreateNode(parent, vnode, hooks, ns, nextSibling)\n\t\t}\n\t}\n\tfunction updateText(old, vnode) {\n\t\tif (old.children.toString() !== vnode.children.toString()) {\n\t\t\told.dom.nodeValue = vnode.children\n\t\t}\n\t\tvnode.dom = old.dom\n\t}\n\tfunction updateHTML(parent, old, vnode, ns, nextSibling) {\n\t\tif (old.children !== vnode.children) {\n\t\t\tremoveDOM(parent, old)\n\t\t\tcreateHTML(parent, vnode, ns, nextSibling)\n\t\t}\n\t\telse {\n\t\t\tvnode.dom = old.dom\n\t\t\tvnode.domSize = old.domSize\n\t\t}\n\t}\n\tfunction updateFragment(parent, old, vnode, hooks, nextSibling, ns) {\n\t\tupdateNodes(parent, old.children, vnode.children, hooks, nextSibling, ns)\n\t\tvar domSize = 0, children = vnode.children\n\t\tvnode.dom = null\n\t\tif (children != null) {\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\tvar child = children[i]\n\t\t\t\tif (child != null && child.dom != null) {\n\t\t\t\t\tif (vnode.dom == null) vnode.dom = child.dom\n\t\t\t\t\tdomSize += child.domSize || 1\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (domSize !== 1) vnode.domSize = domSize\n\t\t}\n\t}\n\tfunction updateElement(old, vnode, hooks, ns) {\n\t\tvar element = vnode.dom = old.dom\n\t\tns = getNameSpace(vnode) || ns\n\n\t\tif (old.attrs != vnode.attrs || (vnode.attrs != null && !cachedAttrsIsStaticMap.get(vnode.attrs))) {\n\t\t\tupdateAttrs(vnode, old.attrs, vnode.attrs, ns)\n\t\t}\n\t\tif (!maybeSetContentEditable(vnode)) {\n\t\t\tupdateNodes(element, old.children, vnode.children, hooks, null, ns)\n\t\t}\n\t}\n\tfunction updateComponent(parent, old, vnode, hooks, nextSibling, ns) {\n\t\tvnode.instance = Vnode.normalize(callHook.call(vnode.state.view, vnode))\n\t\tif (vnode.instance === vnode) throw Error(\"A view cannot return the vnode it received as argument\")\n\t\tupdateLifecycle(vnode.state, vnode, hooks)\n\t\tif (vnode.attrs != null) updateLifecycle(vnode.attrs, vnode, hooks)\n\t\tif (vnode.instance != null) {\n\t\t\tif (old.instance == null) createNode(parent, vnode.instance, hooks, ns, nextSibling)\n\t\t\telse updateNode(parent, old.instance, vnode.instance, hooks, nextSibling, ns)\n\t\t\tvnode.dom = vnode.instance.dom\n\t\t\tvnode.domSize = vnode.instance.domSize\n\t\t}\n\t\telse if (old.instance != null) {\n\t\t\tremoveNode(parent, old.instance)\n\t\t\tvnode.dom = undefined\n\t\t\tvnode.domSize = 0\n\t\t}\n\t\telse {\n\t\t\tvnode.dom = old.dom\n\t\t\tvnode.domSize = old.domSize\n\t\t}\n\t}\n\tfunction getKeyMap(vnodes, start, end) {\n\t\tvar map = Object.create(null)\n\t\tfor (; start < end; start++) {\n\t\t\tvar vnode = vnodes[start]\n\t\t\tif (vnode != null) {\n\t\t\t\tvar key = vnode.key\n\t\t\t\tif (key != null) map[key] = start\n\t\t\t}\n\t\t}\n\t\treturn map\n\t}\n\t// Lifted from ivi https://github.com/ivijs/ivi/\n\t// takes a list of unique numbers (-1 is special and can\n\t// occur multiple times) and returns an array with the indices\n\t// of the items that are part of the longest increasing\n\t// subsequence\n\tvar lisTemp = []\n\tfunction makeLisIndices(a) {\n\t\tvar result = [0]\n\t\tvar u = 0, v = 0, i = 0\n\t\tvar il = lisTemp.length = a.length\n\t\tfor (var i = 0; i < il; i++) lisTemp[i] = a[i]\n\t\tfor (var i = 0; i < il; ++i) {\n\t\t\tif (a[i] === -1) continue\n\t\t\tvar j = result[result.length - 1]\n\t\t\tif (a[j] < a[i]) {\n\t\t\t\tlisTemp[i] = j\n\t\t\t\tresult.push(i)\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tu = 0\n\t\t\tv = result.length - 1\n\t\t\twhile (u < v) {\n\t\t\t\t// Fast integer average without overflow.\n\t\t\t\t// eslint-disable-next-line no-bitwise\n\t\t\t\tvar c = (u >>> 1) + (v >>> 1) + (u & v & 1)\n\t\t\t\tif (a[result[c]] < a[i]) {\n\t\t\t\t\tu = c + 1\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tv = c\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (a[i] < a[result[u]]) {\n\t\t\t\tif (u > 0) lisTemp[i] = result[u - 1]\n\t\t\t\tresult[u] = i\n\t\t\t}\n\t\t}\n\t\tu = result.length\n\t\tv = result[u - 1]\n\t\twhile (u-- > 0) {\n\t\t\tresult[u] = v\n\t\t\tv = lisTemp[v]\n\t\t}\n\t\tlisTemp.length = 0\n\t\treturn result\n\t}\n\n\tfunction getNextSibling(vnodes, i, nextSibling) {\n\t\tfor (; i < vnodes.length; i++) {\n\t\t\tif (vnodes[i] != null && vnodes[i].dom != null) return vnodes[i].dom\n\t\t}\n\t\treturn nextSibling\n\t}\n\n\t// This handles fragments with zombie children (removed from vdom, but persisted in DOM through onbeforeremove)\n\tfunction moveDOM(parent, vnode, nextSibling) {\n\t\tif (vnode.dom != null) {\n\t\t\tvar target\n\t\t\tif (vnode.domSize == null) {\n\t\t\t\t// don't allocate for the common case\n\t\t\t\ttarget = vnode.dom\n\t\t\t} else {\n\t\t\t\ttarget = getDocument(parent).createDocumentFragment()\n\t\t\t\tfor (var dom of domFor(vnode)) target.appendChild(dom)\n\t\t\t}\n\t\t\tinsertDOM(parent, target, nextSibling)\n\t\t}\n\t}\n\n\tfunction insertDOM(parent, dom, nextSibling) {\n\t\tif (nextSibling != null) parent.insertBefore(dom, nextSibling)\n\t\telse parent.appendChild(dom)\n\t}\n\n\tfunction maybeSetContentEditable(vnode) {\n\t\tif (vnode.attrs == null || (\n\t\t\tvnode.attrs.contenteditable == null && // attribute\n\t\t\tvnode.attrs.contentEditable == null // property\n\t\t)) return false\n\t\tvar children = vnode.children\n\t\tif (children != null && children.length === 1 && children[0].tag === \"<\") {\n\t\t\tvar content = children[0].children\n\t\t\tif (vnode.dom.innerHTML !== content) vnode.dom.innerHTML = content\n\t\t}\n\t\telse if (children != null && children.length !== 0) throw new Error(\"Child node of a contenteditable must be trusted.\")\n\t\treturn true\n\t}\n\n\t//remove\n\tfunction removeNodes(parent, vnodes, start, end) {\n\t\tfor (var i = start; i < end; i++) {\n\t\t\tvar vnode = vnodes[i]\n\t\t\tif (vnode != null) removeNode(parent, vnode)\n\t\t}\n\t}\n\tfunction tryBlockRemove(parent, vnode, source, counter) {\n\t\tvar original = vnode.state\n\t\tvar result = callHook.call(source.onbeforeremove, vnode)\n\t\tif (result == null) return\n\n\t\tvar generation = currentRender\n\t\tfor (var dom of domFor(vnode)) delayedRemoval.set(dom, generation)\n\t\tcounter.v++\n\n\t\tPromise.resolve(result).finally(function () {\n\t\t\tcheckState(vnode, original)\n\t\t\ttryResumeRemove(parent, vnode, counter)\n\t\t})\n\t}\n\tfunction tryResumeRemove(parent, vnode, counter) {\n\t\tif (--counter.v === 0) {\n\t\t\tonremove(vnode)\n\t\t\tremoveDOM(parent, vnode)\n\t\t}\n\t}\n\tfunction removeNode(parent, vnode) {\n\t\tvar counter = {v: 1}\n\t\tif (typeof vnode.tag !== \"string\" && typeof vnode.state.onbeforeremove === \"function\") tryBlockRemove(parent, vnode, vnode.state, counter)\n\t\tif (vnode.attrs && typeof vnode.attrs.onbeforeremove === \"function\") tryBlockRemove(parent, vnode, vnode.attrs, counter)\n\t\ttryResumeRemove(parent, vnode, counter)\n\t}\n\tfunction removeDOM(parent, vnode) {\n\t\tif (vnode.dom == null) return\n\t\tif (vnode.domSize == null) {\n\t\t\tparent.removeChild(vnode.dom)\n\t\t} else {\n\t\t\tfor (var dom of domFor(vnode)) parent.removeChild(dom)\n\t\t}\n\t}\n\n\tfunction onremove(vnode) {\n\t\tif (typeof vnode.tag !== \"string\" && typeof vnode.state.onremove === \"function\") callHook.call(vnode.state.onremove, vnode)\n\t\tif (vnode.attrs && typeof vnode.attrs.onremove === \"function\") callHook.call(vnode.attrs.onremove, vnode)\n\t\tif (typeof vnode.tag !== \"string\") {\n\t\t\tif (vnode.instance != null) onremove(vnode.instance)\n\t\t} else {\n\t\t\tif (vnode.events != null) vnode.events._ = null\n\t\t\tvar children = vnode.children\n\t\t\tif (Array.isArray(children)) {\n\t\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\t\tvar child = children[i]\n\t\t\t\t\tif (child != null) onremove(child)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t//attrs\n\tfunction setAttrs(vnode, attrs, ns) {\n\t\tfor (var key in attrs) {\n\t\t\tsetAttr(vnode, key, null, attrs[key], ns)\n\t\t}\n\t}\n\tfunction setAttr(vnode, key, old, value, ns) {\n\t\tif (key === \"key\" || value == null || isLifecycleMethod(key) || (old === value && !isFormAttribute(vnode, key)) && typeof value !== \"object\") return\n\t\tif (key[0] === \"o\" && key[1] === \"n\") return updateEvent(vnode, key, value)\n\t\tif (key.slice(0, 6) === \"xlink:\") vnode.dom.setAttributeNS(\"http://www.w3.org/1999/xlink\", key.slice(6), value)\n\t\telse if (key === \"style\") updateStyle(vnode.dom, old, value)\n\t\telse if (hasPropertyKey(vnode, key, ns)) {\n\t\t\tif (key === \"value\") {\n\t\t\t\t// Only do the coercion if we're actually going to check the value.\n\t\t\t\t/* eslint-disable no-implicit-coercion */\n\t\t\t\t//setting input[value] to same value by typing on focused element moves cursor to end in Chrome\n\t\t\t\t//setting input[type=file][value] to same value causes an error to be generated if it's non-empty\n\t\t\t\t//minlength/maxlength validation isn't performed on script-set values(#2256)\n\t\t\t\tif ((vnode.tag === \"input\" || vnode.tag === \"textarea\") && vnode.dom.value === \"\" + value) return\n\t\t\t\t//setting select[value] to same value while having select open blinks select dropdown in Chrome\n\t\t\t\tif (vnode.tag === \"select\" && old !== null && vnode.dom.value === \"\" + value) return\n\t\t\t\t//setting option[value] to same value while having select open blinks select dropdown in Chrome\n\t\t\t\tif (vnode.tag === \"option\" && old !== null && vnode.dom.value === \"\" + value) return\n\t\t\t\t//setting input[type=file][value] to different value is an error if it's non-empty\n\t\t\t\t// Not ideal, but it at least works around the most common source of uncaught exceptions for now.\n\t\t\t\tif (vnode.tag === \"input\" && vnode.attrs.type === \"file\" && \"\" + value !== \"\") { console.error(\"`value` is read-only on file inputs!\"); return }\n\t\t\t\t/* eslint-enable no-implicit-coercion */\n\t\t\t}\n\t\t\t// If you assign an input type that is not supported by IE 11 with an assignment expression, an error will occur.\n\t\t\tif (vnode.tag === \"input\" && key === \"type\") vnode.dom.setAttribute(key, value)\n\t\t\telse vnode.dom[key] = value\n\t\t} else {\n\t\t\tif (typeof value === \"boolean\") {\n\t\t\t\tif (value) vnode.dom.setAttribute(key, \"\")\n\t\t\t\telse vnode.dom.removeAttribute(key)\n\t\t\t}\n\t\t\telse vnode.dom.setAttribute(key === \"className\" ? \"class\" : key, value)\n\t\t}\n\t}\n\tfunction removeAttr(vnode, key, old, ns) {\n\t\tif (key === \"key\" || old == null || isLifecycleMethod(key)) return\n\t\tif (key[0] === \"o\" && key[1] === \"n\") updateEvent(vnode, key, undefined)\n\t\telse if (key === \"style\") updateStyle(vnode.dom, old, null)\n\t\telse if (\n\t\t\thasPropertyKey(vnode, key, ns)\n\t\t\t&& key !== \"className\"\n\t\t\t&& key !== \"title\" // creates \"null\" as title\n\t\t\t&& !(key === \"value\" && (\n\t\t\t\tvnode.tag === \"option\"\n\t\t\t\t|| vnode.tag === \"select\" && vnode.dom.selectedIndex === -1 && vnode.dom === activeElement(vnode.dom)\n\t\t\t))\n\t\t\t&& !(vnode.tag === \"input\" && key === \"type\")\n\t\t) {\n\t\t\tvnode.dom[key] = null\n\t\t} else {\n\t\t\tvar nsLastIndex = key.indexOf(\":\")\n\t\t\tif (nsLastIndex !== -1) key = key.slice(nsLastIndex + 1)\n\t\t\tif (old !== false) vnode.dom.removeAttribute(key === \"className\" ? \"class\" : key)\n\t\t}\n\t}\n\tfunction setLateSelectAttrs(vnode, attrs) {\n\t\tif (\"value\" in attrs) {\n\t\t\tif(attrs.value === null) {\n\t\t\t\tif (vnode.dom.selectedIndex !== -1) vnode.dom.value = null\n\t\t\t} else {\n\t\t\t\tvar normalized = \"\" + attrs.value // eslint-disable-line no-implicit-coercion\n\t\t\t\tif (vnode.dom.value !== normalized || vnode.dom.selectedIndex === -1) {\n\t\t\t\t\tvnode.dom.value = normalized\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (\"selectedIndex\" in attrs) setAttr(vnode, \"selectedIndex\", null, attrs.selectedIndex, undefined)\n\t}\n\tfunction updateAttrs(vnode, old, attrs, ns) {\n\t\t// Some attributes may NOT be case-sensitive (e.g. data-***),\n\t\t// so removal should be done first to prevent accidental removal for newly setting values.\n\t\tvar val\n\t\tif (old != null) {\n\t\t\tif (old === attrs && !cachedAttrsIsStaticMap.has(attrs)) {\n\t\t\t\tconsole.warn(\"Don't reuse attrs object, use new object for every redraw, this will throw in next major\")\n\t\t\t}\n\t\t\tfor (var key in old) {\n\t\t\t\tif (((val = old[key]) != null) && (attrs == null || attrs[key] == null)) {\n\t\t\t\t\tremoveAttr(vnode, key, val, ns)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (attrs != null) {\n\t\t\tfor (var key in attrs) {\n\t\t\t\tsetAttr(vnode, key, old && old[key], attrs[key], ns)\n\t\t\t}\n\t\t}\n\t}\n\tfunction isFormAttribute(vnode, attr) {\n\t\treturn attr === \"value\" || attr === \"checked\" || attr === \"selectedIndex\" || attr === \"selected\" && (vnode.dom === activeElement(vnode.dom) || vnode.tag === \"option\" && vnode.dom.parentNode === activeElement(vnode.dom))\n\t}\n\tfunction isLifecycleMethod(attr) {\n\t\treturn attr === \"oninit\" || attr === \"oncreate\" || attr === \"onupdate\" || attr === \"onremove\" || attr === \"onbeforeremove\" || attr === \"onbeforeupdate\"\n\t}\n\tfunction hasPropertyKey(vnode, key, ns) {\n\t\t// Filter out namespaced keys\n\t\treturn ns === undefined && (\n\t\t\t// If it's a custom element, just keep it.\n\t\t\tvnode.tag.indexOf(\"-\") > -1 || vnode.is ||\n\t\t\t// If it's a normal element, let's try to avoid a few browser bugs.\n\t\t\tkey !== \"href\" && key !== \"list\" && key !== \"form\" && key !== \"width\" && key !== \"height\"// && key !== \"type\"\n\t\t\t// Defer the property check until *after* we check everything.\n\t\t) && key in vnode.dom\n\t}\n\n\t//style\n\tfunction updateStyle(element, old, style) {\n\t\tif (old === style) {\n\t\t\t// Styles are equivalent, do nothing.\n\t\t} else if (style == null) {\n\t\t\t// New style is missing, just clear it.\n\t\t\telement.style = \"\"\n\t\t} else if (typeof style !== \"object\") {\n\t\t\t// New style is a string, let engine deal with patching.\n\t\t\telement.style = style\n\t\t} else if (old == null || typeof old !== \"object\") {\n\t\t\t// `old` is missing or a string, `style` is an object.\n\t\t\telement.style = \"\"\n\t\t\t// Add new style properties\n\t\t\tfor (var key in style) {\n\t\t\t\tvar value = style[key]\n\t\t\t\tif (value != null) {\n\t\t\t\t\tif (key.includes(\"-\")) element.style.setProperty(key, String(value))\n\t\t\t\t\telse element.style[key] = String(value)\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Both old & new are (different) objects.\n\t\t\t// Remove style properties that no longer exist\n\t\t\t// Style properties may have two cases(dash-case and camelCase),\n\t\t\t// so removal should be done first to prevent accidental removal for newly setting values.\n\t\t\tfor (var key in old) {\n\t\t\t\tif (old[key] != null && style[key] == null) {\n\t\t\t\t\tif (key.includes(\"-\")) element.style.removeProperty(key)\n\t\t\t\t\telse element.style[key] = \"\"\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Update style properties that have changed\n\t\t\tfor (var key in style) {\n\t\t\t\tvar value = style[key]\n\t\t\t\tif (value != null && (value = String(value)) !== String(old[key])) {\n\t\t\t\t\tif (key.includes(\"-\")) element.style.setProperty(key, value)\n\t\t\t\t\telse element.style[key] = value\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Here's an explanation of how this works:\n\t// 1. The event names are always (by design) prefixed by `on`.\n\t// 2. The EventListener interface accepts either a function or an object\n\t//    with a `handleEvent` method.\n\t// 3. The object does not inherit from `Object.prototype`, to avoid\n\t//    any potential interference with that (e.g. setters).\n\t// 4. The event name is remapped to the handler before calling it.\n\t// 5. In function-based event handlers, `ev.target === this`. We replicate\n\t//    that below.\n\t// 6. In function-based event handlers, `return false` prevents the default\n\t//    action and stops event propagation. We replicate that below.\n\tfunction EventDict() {\n\t\t// Save this, so the current redraw is correctly tracked.\n\t\tthis._ = currentRedraw\n\t}\n\tEventDict.prototype = Object.create(null)\n\tEventDict.prototype.handleEvent = function (ev) {\n\t\tvar handler = this[\"on\" + ev.type]\n\t\tvar result\n\t\tif (typeof handler === \"function\") result = handler.call(ev.currentTarget, ev)\n\t\telse if (typeof handler.handleEvent === \"function\") handler.handleEvent(ev)\n\t\tvar self = this\n\t\tif (self._ != null) {\n\t\t\tif (ev.redraw !== false) (0, self._)()\n\t\t\tif (result != null && typeof result.then === \"function\") {\n\t\t\t\tPromise.resolve(result).then(function () {\n\t\t\t\t\tif (self._ != null && ev.redraw !== false) (0, self._)()\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t\tif (result === false) {\n\t\t\tev.preventDefault()\n\t\t\tev.stopPropagation()\n\t\t}\n\t}\n\n\t//event\n\tfunction updateEvent(vnode, key, value) {\n\t\tif (vnode.events != null) {\n\t\t\tvnode.events._ = currentRedraw\n\t\t\tif (vnode.events[key] === value) return\n\t\t\tif (value != null && (typeof value === \"function\" || typeof value === \"object\")) {\n\t\t\t\tif (vnode.events[key] == null) vnode.dom.addEventListener(key.slice(2), vnode.events, false)\n\t\t\t\tvnode.events[key] = value\n\t\t\t} else {\n\t\t\t\tif (vnode.events[key] != null) vnode.dom.removeEventListener(key.slice(2), vnode.events, false)\n\t\t\t\tvnode.events[key] = undefined\n\t\t\t}\n\t\t} else if (value != null && (typeof value === \"function\" || typeof value === \"object\")) {\n\t\t\tvnode.events = new EventDict()\n\t\t\tvnode.dom.addEventListener(key.slice(2), vnode.events, false)\n\t\t\tvnode.events[key] = value\n\t\t}\n\t}\n\n\t//lifecycle\n\tfunction initLifecycle(source, vnode, hooks) {\n\t\tif (typeof source.oninit === \"function\") callHook.call(source.oninit, vnode)\n\t\tif (typeof source.oncreate === \"function\") hooks.push(callHook.bind(source.oncreate, vnode))\n\t}\n\tfunction updateLifecycle(source, vnode, hooks) {\n\t\tif (typeof source.onupdate === \"function\") hooks.push(callHook.bind(source.onupdate, vnode))\n\t}\n\tfunction shouldNotUpdate(vnode, old) {\n\t\tdo {\n\t\t\tif (vnode.attrs != null && typeof vnode.attrs.onbeforeupdate === \"function\") {\n\t\t\t\tvar force = callHook.call(vnode.attrs.onbeforeupdate, vnode, old)\n\t\t\t\tif (force !== undefined && !force) break\n\t\t\t}\n\t\t\tif (typeof vnode.tag !== \"string\" && typeof vnode.state.onbeforeupdate === \"function\") {\n\t\t\t\tvar force = callHook.call(vnode.state.onbeforeupdate, vnode, old)\n\t\t\t\tif (force !== undefined && !force) break\n\t\t\t}\n\t\t\treturn false\n\t\t} while (false); // eslint-disable-line no-constant-condition\n\t\tvnode.dom = old.dom\n\t\tvnode.domSize = old.domSize\n\t\tvnode.instance = old.instance\n\t\t// One would think having the actual latest attributes would be ideal,\n\t\t// but it doesn't let us properly diff based on our current internal\n\t\t// representation. We have to save not only the old DOM info, but also\n\t\t// the attributes used to create it, as we diff *that*, not against the\n\t\t// DOM directly (with a few exceptions in `setAttr`). And, of course, we\n\t\t// need to save the children and text as they are conceptually not\n\t\t// unlike special \"attributes\" internally.\n\t\tvnode.attrs = old.attrs\n\t\tvnode.children = old.children\n\t\tvnode.text = old.text\n\t\treturn true\n\t}\n\n\tvar currentDOM\n\n\treturn function(dom, vnodes, redraw) {\n\t\tif (!dom) throw new TypeError(\"DOM element being rendered to does not exist.\")\n\t\tif (currentDOM != null && dom.contains(currentDOM)) {\n\t\t\tthrow new TypeError(\"Node is currently being rendered to and thus is locked.\")\n\t\t}\n\t\tvar prevRedraw = currentRedraw\n\t\tvar prevDOM = currentDOM\n\t\tvar hooks = []\n\t\tvar active = activeElement(dom)\n\t\tvar namespace = dom.namespaceURI\n\n\t\tcurrentDOM = dom\n\t\tcurrentRedraw = typeof redraw === \"function\" ? redraw : undefined\n\t\tcurrentRender = {}\n\t\ttry {\n\t\t\t// First time rendering into a node clears it out\n\t\t\tif (dom.vnodes == null) dom.textContent = \"\"\n\t\t\tvnodes = Vnode.normalizeChildren(Array.isArray(vnodes) ? vnodes : [vnodes])\n\t\t\tupdateNodes(dom, dom.vnodes, vnodes, hooks, null, namespace === \"http://www.w3.org/1999/xhtml\" ? undefined : namespace)\n\t\t\tdom.vnodes = vnodes\n\t\t\t// `document.activeElement` can return null: https://html.spec.whatwg.org/multipage/interaction.html#dom-document-activeelement\n\t\t\tif (active != null && activeElement(dom) !== active && typeof active.focus === \"function\") active.focus()\n\t\t\tfor (var i = 0; i < hooks.length; i++) hooks[i]()\n\t\t} finally {\n\t\t\tcurrentRedraw = prevRedraw\n\t\t\tcurrentDOM = prevDOM\n\t\t}\n\t}\n}\n", "\"use strict\"\n\nmodule.exports = require(\"./render/render\")(typeof window !== \"undefined\" ? window : null)\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\n\nmodule.exports = function(render, schedule, console) {\n\tvar subscriptions = []\n\tvar pending = false\n\tvar offset = -1\n\n\tfunction sync() {\n\t\tfor (offset = 0; offset < subscriptions.length; offset += 2) {\n\t\t\ttry { render(subscriptions[offset], Vnode(subscriptions[offset + 1]), redraw) }\n\t\t\tcatch (e) { console.error(e) }\n\t\t}\n\t\toffset = -1\n\t}\n\n\tfunction redraw() {\n\t\tif (!pending) {\n\t\t\tpending = true\n\t\t\tschedule(function() {\n\t\t\t\tpending = false\n\t\t\t\tsync()\n\t\t\t})\n\t\t}\n\t}\n\n\tredraw.sync = sync\n\n\tfunction mount(root, component) {\n\t\tif (component != null && component.view == null && typeof component !== \"function\") {\n\t\t\tthrow new TypeError(\"m.mount expects a component, not a vnode.\")\n\t\t}\n\n\t\tvar index = subscriptions.indexOf(root)\n\t\tif (index >= 0) {\n\t\t\tsubscriptions.splice(index, 2)\n\t\t\tif (index <= offset) offset -= 2\n\t\t\trender(root, [])\n\t\t}\n\n\t\tif (component != null) {\n\t\t\tsubscriptions.push(root, component)\n\t\t\trender(root, Vnode(component), redraw)\n\t\t}\n\t}\n\n\treturn {mount: mount, redraw: redraw}\n}\n", "\"use strict\"\n\nvar render = require(\"./render\")\n\nmodule.exports = require(\"./api/mount-redraw\")(render, typeof requestAnimationFrame !== \"undefined\" ? requestAnimationFrame : null, typeof console !== \"undefined\" ? console : null)\n", "\"use strict\"\n\nmodule.exports = function(object) {\n\tif (Object.prototype.toString.call(object) !== \"[object Object]\") return \"\"\n\n\tvar args = []\n\tfor (var key in object) {\n\t\tdestructure(key, object[key])\n\t}\n\n\treturn args.join(\"&\")\n\n\tfunction destructure(key, value) {\n\t\tif (Array.isArray(value)) {\n\t\t\tfor (var i = 0; i < value.length; i++) {\n\t\t\t\tdestructure(key + \"[\" + i + \"]\", value[i])\n\t\t\t}\n\t\t}\n\t\telse if (Object.prototype.toString.call(value) === \"[object Object]\") {\n\t\t\tfor (var i in value) {\n\t\t\t\tdestructure(key + \"[\" + i + \"]\", value[i])\n\t\t\t}\n\t\t}\n\t\telse args.push(encodeURIComponent(key) + (value != null && value !== \"\" ? \"=\" + encodeURIComponent(value) : \"\"))\n\t}\n}\n", "\"use strict\"\n\nvar buildQueryString = require(\"../querystring/build\")\n\n// Returns `path` from `template` + `params`\nmodule.exports = function(template, params) {\n\tif ((/:([^\\/\\.-]+)(\\.{3})?:/).test(template)) {\n\t\tthrow new SyntaxError(\"Template parameter names must be separated by either a '/', '-', or '.'.\")\n\t}\n\tif (params == null) return template\n\tvar queryIndex = template.indexOf(\"?\")\n\tvar hashIndex = template.indexOf(\"#\")\n\tvar queryEnd = hashIndex < 0 ? template.length : hashIndex\n\tvar pathEnd = queryIndex < 0 ? queryEnd : queryIndex\n\tvar path = template.slice(0, pathEnd)\n\tvar query = {}\n\n\tObject.assign(query, params)\n\n\tvar resolved = path.replace(/:([^\\/\\.-]+)(\\.{3})?/g, function(m, key, variadic) {\n\t\tdelete query[key]\n\t\t// If no such parameter exists, don't interpolate it.\n\t\tif (params[key] == null) return m\n\t\t// Escape normal parameters, but not variadic ones.\n\t\treturn variadic ? params[key] : encodeURIComponent(String(params[key]))\n\t})\n\n\t// In case the template substitution adds new query/hash parameters.\n\tvar newQueryIndex = resolved.indexOf(\"?\")\n\tvar newHashIndex = resolved.indexOf(\"#\")\n\tvar newQueryEnd = newHashIndex < 0 ? resolved.length : newHashIndex\n\tvar newPathEnd = newQueryIndex < 0 ? newQueryEnd : newQueryIndex\n\tvar result = resolved.slice(0, newPathEnd)\n\n\tif (queryIndex >= 0) result += template.slice(queryIndex, queryEnd)\n\tif (newQueryIndex >= 0) result += (queryIndex < 0 ? \"?\" : \"&\") + resolved.slice(newQueryIndex, newQueryEnd)\n\tvar querystring = buildQueryString(query)\n\tif (querystring) result += (queryIndex < 0 && newQueryIndex < 0 ? \"?\" : \"&\") + querystring\n\tif (hashIndex >= 0) result += template.slice(hashIndex)\n\tif (newHashIndex >= 0) result += (hashIndex < 0 ? \"\" : \"&\") + resolved.slice(newHashIndex)\n\treturn result\n}\n", "\"use strict\"\n\nvar buildPathname = require(\"../pathname/build\")\nvar hasOwn = require(\"../util/hasOwn\")\n\nmodule.exports = function($window, oncompletion) {\n\tfunction PromiseProxy(executor) {\n\t\treturn new Promise(executor)\n\t}\n\n\tfunction makeRequest(url, args) {\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\turl = buildPathname(url, args.params)\n\t\t\tvar method = args.method != null ? args.method.toUpperCase() : \"GET\"\n\t\t\tvar body = args.body\n\t\t\tvar assumeJSON = (args.serialize == null || args.serialize === JSON.serialize) && !(body instanceof $window.FormData || body instanceof $window.URLSearchParams)\n\t\t\tvar responseType = args.responseType || (typeof args.extract === \"function\" ? \"\" : \"json\")\n\n\t\t\tvar xhr = new $window.XMLHttpRequest(), aborted = false, isTimeout = false\n\t\t\tvar original = xhr, replacedAbort\n\t\t\tvar abort = xhr.abort\n\n\t\t\txhr.abort = function() {\n\t\t\t\taborted = true\n\t\t\t\tabort.call(this)\n\t\t\t}\n\n\t\t\txhr.open(method, url, args.async !== false, typeof args.user === \"string\" ? args.user : undefined, typeof args.password === \"string\" ? args.password : undefined)\n\n\t\t\tif (assumeJSON && body != null && !hasHeader(args, \"content-type\")) {\n\t\t\t\txhr.setRequestHeader(\"Content-Type\", \"application/json; charset=utf-8\")\n\t\t\t}\n\t\t\tif (typeof args.deserialize !== \"function\" && !hasHeader(args, \"accept\")) {\n\t\t\t\txhr.setRequestHeader(\"Accept\", \"application/json, text/*\")\n\t\t\t}\n\t\t\tif (args.withCredentials) xhr.withCredentials = args.withCredentials\n\t\t\tif (args.timeout) xhr.timeout = args.timeout\n\t\t\txhr.responseType = responseType\n\n\t\t\tfor (var key in args.headers) {\n\t\t\t\tif (hasOwn.call(args.headers, key)) {\n\t\t\t\t\txhr.setRequestHeader(key, args.headers[key])\n\t\t\t\t}\n\t\t\t}\n\n\t\t\txhr.onreadystatechange = function(ev) {\n\t\t\t\t// Don't throw errors on xhr.abort().\n\t\t\t\tif (aborted) return\n\n\t\t\t\tif (ev.target.readyState === 4) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar success = (ev.target.status >= 200 && ev.target.status < 300) || ev.target.status === 304 || (/^file:\\/\\//i).test(url)\n\t\t\t\t\t\t// When the response type isn't \"\" or \"text\",\n\t\t\t\t\t\t// `xhr.responseText` is the wrong thing to use.\n\t\t\t\t\t\t// Browsers do the right thing and throw here, and we\n\t\t\t\t\t\t// should honor that and do the right thing by\n\t\t\t\t\t\t// preferring `xhr.response` where possible/practical.\n\t\t\t\t\t\tvar response = ev.target.response, message\n\n\t\t\t\t\t\tif (responseType === \"json\") {\n\t\t\t\t\t\t\t// For IE and Edge, which don't implement\n\t\t\t\t\t\t\t// `responseType: \"json\"`.\n\t\t\t\t\t\t\tif (!ev.target.responseType && typeof args.extract !== \"function\") {\n\t\t\t\t\t\t\t\t// Handle no-content which will not parse.\n\t\t\t\t\t\t\t\ttry { response = JSON.parse(ev.target.responseText) }\n\t\t\t\t\t\t\t\tcatch (e) { response = null }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (!responseType || responseType === \"text\") {\n\t\t\t\t\t\t\t// Only use this default if it's text. If a parsed\n\t\t\t\t\t\t\t// document is needed on old IE and friends (all\n\t\t\t\t\t\t\t// unsupported), the user should use a custom\n\t\t\t\t\t\t\t// `config` instead. They're already using this at\n\t\t\t\t\t\t\t// their own risk.\n\t\t\t\t\t\t\tif (response == null) response = ev.target.responseText\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (typeof args.extract === \"function\") {\n\t\t\t\t\t\t\tresponse = args.extract(ev.target, args)\n\t\t\t\t\t\t\tsuccess = true\n\t\t\t\t\t\t} else if (typeof args.deserialize === \"function\") {\n\t\t\t\t\t\t\tresponse = args.deserialize(response)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (success) {\n\t\t\t\t\t\t\tif (typeof args.type === \"function\") {\n\t\t\t\t\t\t\t\tif (Array.isArray(response)) {\n\t\t\t\t\t\t\t\t\tfor (var i = 0; i < response.length; i++) {\n\t\t\t\t\t\t\t\t\t\tresponse[i] = new args.type(response[i])\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse response = new args.type(response)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve(response)\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tvar completeErrorResponse = function() {\n\t\t\t\t\t\t\t\ttry { message = ev.target.responseText }\n\t\t\t\t\t\t\t\tcatch (e) { message = response }\n\t\t\t\t\t\t\t\tvar error = new Error(message)\n\t\t\t\t\t\t\t\terror.code = ev.target.status\n\t\t\t\t\t\t\t\terror.response = response\n\t\t\t\t\t\t\t\treject(error)\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (xhr.status === 0) {\n\t\t\t\t\t\t\t\t// Use setTimeout to push this code block onto the event queue\n\t\t\t\t\t\t\t\t// This allows `xhr.ontimeout` to run in the case that there is a timeout\n\t\t\t\t\t\t\t\t// Without this setTimeout, `xhr.ontimeout` doesn't have a chance to reject\n\t\t\t\t\t\t\t\t// as `xhr.onreadystatechange` will run before it\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\tif (isTimeout) return\n\t\t\t\t\t\t\t\t\tcompleteErrorResponse()\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t} else completeErrorResponse()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {\n\t\t\t\t\t\treject(e)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\txhr.ontimeout = function (ev) {\n\t\t\t\tisTimeout = true\n\t\t\t\tvar error = new Error(\"Request timed out\")\n\t\t\t\terror.code = ev.target.status\n\t\t\t\treject(error)\n\t\t\t}\n\n\t\t\tif (typeof args.config === \"function\") {\n\t\t\t\txhr = args.config(xhr, args, url) || xhr\n\n\t\t\t\t// Propagate the `abort` to any replacement XHR as well.\n\t\t\t\tif (xhr !== original) {\n\t\t\t\t\treplacedAbort = xhr.abort\n\t\t\t\t\txhr.abort = function() {\n\t\t\t\t\t\taborted = true\n\t\t\t\t\t\treplacedAbort.call(this)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (body == null) xhr.send()\n\t\t\telse if (typeof args.serialize === \"function\") xhr.send(args.serialize(body))\n\t\t\telse if (body instanceof $window.FormData || body instanceof $window.URLSearchParams) xhr.send(body)\n\t\t\telse xhr.send(JSON.stringify(body))\n\t\t})\n\t}\n\n\t// In case the global Promise is some userland library's where they rely on\n\t// `foo instanceof this.constructor`, `this.constructor.resolve(value)`, or\n\t// similar. Let's *not* break them.\n\tPromiseProxy.prototype = Promise.prototype\n\tPromiseProxy.__proto__ = Promise // eslint-disable-line no-proto\n\n\tfunction hasHeader(args, name) {\n\t\tfor (var key in args.headers) {\n\t\t\tif (hasOwn.call(args.headers, key) && key.toLowerCase() === name) return true\n\t\t}\n\t\treturn false\n\t}\n\n\treturn {\n\t\trequest: function(url, args) {\n\t\t\tif (typeof url !== \"string\") { args = url; url = url.url }\n\t\t\telse if (args == null) args = {}\n\t\t\tvar promise = makeRequest(url, args)\n\t\t\tif (args.background === true) return promise\n\t\t\tvar count = 0\n\t\t\tfunction complete() {\n\t\t\t\tif (--count === 0 && typeof oncompletion === \"function\") oncompletion()\n\t\t\t}\n\n\t\t\treturn wrap(promise)\n\n\t\t\tfunction wrap(promise) {\n\t\t\t\tvar then = promise.then\n\t\t\t\t// Set the constructor, so engines know to not await or resolve\n\t\t\t\t// this as a native promise. At the time of writing, this is\n\t\t\t\t// only necessary for V8, but their behavior is the correct\n\t\t\t\t// behavior per spec. See this spec issue for more details:\n\t\t\t\t// https://github.com/tc39/ecma262/issues/1577. Also, see the\n\t\t\t\t// corresponding comment in `request/tests/test-request.js` for\n\t\t\t\t// a bit more background on the issue at hand.\n\t\t\t\tpromise.constructor = PromiseProxy\n\t\t\t\tpromise.then = function() {\n\t\t\t\t\tcount++\n\t\t\t\t\tvar next = then.apply(promise, arguments)\n\t\t\t\t\tnext.then(complete, function(e) {\n\t\t\t\t\t\tcomplete()\n\t\t\t\t\t\tif (count === 0) throw e\n\t\t\t\t\t})\n\t\t\t\t\treturn wrap(next)\n\t\t\t\t}\n\t\t\t\treturn promise\n\t\t\t}\n\t\t}\n\t}\n}\n", "\"use strict\"\n\nvar mountRedraw = require(\"./mount-redraw\")\n\nmodule.exports = require(\"./request/request\")(typeof window !== \"undefined\" ? window : null, mountRedraw.redraw)\n", "\"use strict\"\n\nfunction decodeURIComponentSave(str) {\n\ttry {\n\t\treturn decodeURIComponent(str)\n\t} catch(err) {\n\t\treturn str\n\t}\n}\n\nmodule.exports = function(string) {\n\tif (string === \"\" || string == null) return {}\n\tif (string.charAt(0) === \"?\") string = string.slice(1)\n\n\tvar entries = string.split(\"&\"), counters = {}, data = {}\n\tfor (var i = 0; i < entries.length; i++) {\n\t\tvar entry = entries[i].split(\"=\")\n\t\tvar key = decodeURIComponentSave(entry[0])\n\t\tvar value = entry.length === 2 ? decodeURIComponentSave(entry[1]) : \"\"\n\n\t\tif (value === \"true\") value = true\n\t\telse if (value === \"false\") value = false\n\n\t\tvar levels = key.split(/\\]\\[?|\\[/)\n\t\tvar cursor = data\n\t\tif (key.indexOf(\"[\") > -1) levels.pop()\n\t\tfor (var j = 0; j < levels.length; j++) {\n\t\t\tvar level = levels[j], nextLevel = levels[j + 1]\n\t\t\tvar isNumber = nextLevel == \"\" || !isNaN(parseInt(nextLevel, 10))\n\t\t\tif (level === \"\") {\n\t\t\t\tvar key = levels.slice(0, j).join()\n\t\t\t\tif (counters[key] == null) {\n\t\t\t\t\tcounters[key] = Array.isArray(cursor) ? cursor.length : 0\n\t\t\t\t}\n\t\t\t\tlevel = counters[key]++\n\t\t\t}\n\t\t\t// Disallow direct prototype pollution\n\t\t\telse if (level === \"__proto__\") break\n\t\t\tif (j === levels.length - 1) cursor[level] = value\n\t\t\telse {\n\t\t\t\t// Read own properties exclusively to disallow indirect\n\t\t\t\t// prototype pollution\n\t\t\t\tvar desc = Object.getOwnPropertyDescriptor(cursor, level)\n\t\t\t\tif (desc != null) desc = desc.value\n\t\t\t\tif (desc == null) cursor[level] = desc = isNumber ? [] : {}\n\t\t\t\tcursor = desc\n\t\t\t}\n\t\t}\n\t}\n\treturn data\n}\n", "\"use strict\"\n\nvar parseQueryString = require(\"../querystring/parse\")\n\n// Returns `{path, params}` from `url`\nmodule.exports = function(url) {\n\tvar queryIndex = url.indexOf(\"?\")\n\tvar hashIndex = url.indexOf(\"#\")\n\tvar queryEnd = hashIndex < 0 ? url.length : hashIndex\n\tvar pathEnd = queryIndex < 0 ? queryEnd : queryIndex\n\tvar path = url.slice(0, pathEnd).replace(/\\/{2,}/g, \"/\")\n\n\tif (!path) path = \"/\"\n\telse {\n\t\tif (path[0] !== \"/\") path = \"/\" + path\n\t}\n\treturn {\n\t\tpath: path,\n\t\tparams: queryIndex < 0\n\t\t\t? {}\n\t\t\t: parseQueryString(url.slice(queryIndex + 1, queryEnd)),\n\t}\n}\n", "\"use strict\"\n\nvar parsePathname = require(\"./parse\")\n\n// Compiles a template into a function that takes a resolved path (without query\n// strings) and returns an object containing the template parameters with their\n// parsed values. This expects the input of the compiled template to be the\n// output of `parsePathname`. Note that it does *not* remove query parameters\n// specified in the template.\nmodule.exports = function(template) {\n\tvar templateData = parsePathname(template)\n\tvar templateKeys = Object.keys(templateData.params)\n\tvar keys = []\n\tvar regexp = new RegExp(\"^\" + templateData.path.replace(\n\t\t// I escape literal text so people can use things like `:file.:ext` or\n\t\t// `:lang-:locale` in routes. This is all merged into one pass so I\n\t\t// don't also accidentally escape `-` and make it harder to detect it to\n\t\t// ban it from template parameters.\n\t\t/:([^\\/.-]+)(\\.{3}|\\.(?!\\.)|-)?|[\\\\^$*+.()|\\[\\]{}]/g,\n\t\tfunction(m, key, extra) {\n\t\t\tif (key == null) return \"\\\\\" + m\n\t\t\tkeys.push({k: key, r: extra === \"...\"})\n\t\t\tif (extra === \"...\") return \"(.*)\"\n\t\t\tif (extra === \".\") return \"([^/]+)\\\\.\"\n\t\t\treturn \"([^/]+)\" + (extra || \"\")\n\t\t}\n\t) + \"\\\\/?$\")\n\treturn function(data) {\n\t\t// First, check the params. Usually, there isn't any, and it's just\n\t\t// checking a static set.\n\t\tfor (var i = 0; i < templateKeys.length; i++) {\n\t\t\tif (templateData.params[templateKeys[i]] !== data.params[templateKeys[i]]) return false\n\t\t}\n\t\t// If no interpolations exist, let's skip all the ceremony\n\t\tif (!keys.length) return regexp.test(data.path)\n\t\tvar values = regexp.exec(data.path)\n\t\tif (values == null) return false\n\t\tfor (var i = 0; i < keys.length; i++) {\n\t\t\tdata.params[keys[i].k] = keys[i].r ? values[i + 1] : decodeURIComponent(values[i + 1])\n\t\t}\n\t\treturn true\n\t}\n}\n", "\"use strict\"\n\n// Note: this is mildly perf-sensitive.\n//\n// It does *not* use `delete` - dynamic `delete`s usually cause objects to bail\n// out into dictionary mode and just generally cause a bunch of optimization\n// issues within engines.\n//\n// Ideally, I would've preferred to do this, if it weren't for the optimization\n// issues:\n//\n// ```js\n// const hasOwn = require(\"./hasOwn\")\n// const magic = [\n//     \"key\", \"oninit\", \"oncreate\", \"onbeforeupdate\", \"onupdate\",\n//     \"onbeforeremove\", \"onremove\",\n// ]\n// module.exports = (attrs, extras) => {\n//     const result = Object.assign(Object.create(null), attrs)\n//     for (const key of magic) delete result[key]\n//     if (extras != null) for (const key of extras) delete result[key]\n//     return result\n// }\n// ```\n\nvar hasOwn = require(\"./hasOwn\")\n// Words in RegExp literals are sometimes mangled incorrectly by the internal bundler, so use RegExp().\nvar magic = new RegExp(\"^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$\")\n\nmodule.exports = function(attrs, extras) {\n\tvar result = {}\n\n\tif (extras != null) {\n\t\tfor (var key in attrs) {\n\t\t\tif (hasOwn.call(attrs, key) && !magic.test(key) && extras.indexOf(key) < 0) {\n\t\t\t\tresult[key] = attrs[key]\n\t\t\t}\n\t\t}\n\t} else {\n\t\tfor (var key in attrs) {\n\t\t\tif (hasOwn.call(attrs, key) && !magic.test(key)) {\n\t\t\t\tresult[key] = attrs[key]\n\t\t\t}\n\t\t}\n\t}\n\n\treturn result\n}\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\nvar m = require(\"../render/hyperscript\")\n\nvar buildPathname = require(\"../pathname/build\")\nvar parsePathname = require(\"../pathname/parse\")\nvar compileTemplate = require(\"../pathname/compileTemplate\")\nvar censor = require(\"../util/censor\")\n\nfunction decodeURIComponentSave(component) {\n\ttry {\n\t\treturn decodeURIComponent(component)\n\t} catch(e) {\n\t\treturn component\n\t}\n}\n\nmodule.exports = function($window, mountRedraw) {\n\tvar callAsync = $window == null\n\t\t// In case Mithril.js' loaded globally without the DOM, let's not break\n\t\t? null\n\t\t: typeof $window.setImmediate === \"function\" ? $window.setImmediate : $window.setTimeout\n\tvar p = Promise.resolve()\n\n\tvar scheduled = false\n\n\tvar ready = false\n\tvar hasBeenResolved = false\n\n\tvar dom, compiled, fallbackRoute\n\n\tvar currentResolver, component, attrs, currentPath, lastUpdate\n\n\tvar RouterRoot = {\n\t\tonremove: function() {\n\t\t\tready = hasBeenResolved = false\n\t\t\t$window.removeEventListener(\"popstate\", fireAsync, false)\n\t\t},\n\t\tview: function() {\n\t\t\t// The route has already been resolved.\n\t\t\t// Therefore, the following early return is not needed.\n\t\t\t// if (!hasBeenResolved) return\n\n\t\t\tvar vnode = Vnode(component, attrs.key, attrs)\n\t\t\tif (currentResolver) return currentResolver.render(vnode)\n\t\t\t// Wrap in a fragment to preserve existing key semantics\n\t\t\treturn [vnode]\n\t\t},\n\t}\n\n\tvar SKIP = route.SKIP = {}\n\n\tfunction resolveRoute() {\n\t\tscheduled = false\n\t\t// Consider the pathname holistically. The prefix might even be invalid,\n\t\t// but that's not our problem.\n\t\tvar prefix = $window.location.hash\n\t\tif (route.prefix[0] !== \"#\") {\n\t\t\tprefix = $window.location.search + prefix\n\t\t\tif (route.prefix[0] !== \"?\") {\n\t\t\t\tprefix = $window.location.pathname + prefix\n\t\t\t\tif (prefix[0] !== \"/\") prefix = \"/\" + prefix\n\t\t\t}\n\t\t}\n\t\t// This seemingly useless `.concat()` speeds up the tests quite a bit,\n\t\t// since the representation is consistently a relatively poorly\n\t\t// optimized cons string.\n\t\tvar path = prefix.concat()\n\t\t\t.replace(/(?:%[a-f89][a-f0-9])+/gim, decodeURIComponentSave)\n\t\t\t.slice(route.prefix.length)\n\t\tvar data = parsePathname(path)\n\n\t\tObject.assign(data.params, $window.history.state)\n\n\t\tfunction reject(e) {\n\t\t\tconsole.error(e)\n\t\t\troute.set(fallbackRoute, null, {replace: true})\n\t\t}\n\n\t\tloop(0)\n\t\tfunction loop(i) {\n\t\t\tfor (; i < compiled.length; i++) {\n\t\t\t\tif (compiled[i].check(data)) {\n\t\t\t\t\tvar payload = compiled[i].component\n\t\t\t\t\tvar matchedRoute = compiled[i].route\n\t\t\t\t\tvar localComp = payload\n\t\t\t\t\tvar update = lastUpdate = function(comp) {\n\t\t\t\t\t\tif (update !== lastUpdate) return\n\t\t\t\t\t\tif (comp === SKIP) return loop(i + 1)\n\t\t\t\t\t\tcomponent = comp != null && (typeof comp.view === \"function\" || typeof comp === \"function\")? comp : \"div\"\n\t\t\t\t\t\tattrs = data.params, currentPath = path, lastUpdate = null\n\t\t\t\t\t\tcurrentResolver = payload.render ? payload : null\n\t\t\t\t\t\tif (hasBeenResolved) mountRedraw.redraw()\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\thasBeenResolved = true\n\t\t\t\t\t\t\tmountRedraw.mount(dom, RouterRoot)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// There's no understating how much I *wish* I could\n\t\t\t\t\t// use `async`/`await` here...\n\t\t\t\t\tif (payload.view || typeof payload === \"function\") {\n\t\t\t\t\t\tpayload = {}\n\t\t\t\t\t\tupdate(localComp)\n\t\t\t\t\t}\n\t\t\t\t\telse if (payload.onmatch) {\n\t\t\t\t\t\tp.then(function () {\n\t\t\t\t\t\t\treturn payload.onmatch(data.params, path, matchedRoute)\n\t\t\t\t\t\t}).then(update, path === fallbackRoute ? null : reject)\n\t\t\t\t\t}\n\t\t\t\t\telse update(/* \"div\" */)\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (path === fallbackRoute) {\n\t\t\t\tthrow new Error(\"Could not resolve default route \" + fallbackRoute + \".\")\n\t\t\t}\n\t\t\troute.set(fallbackRoute, null, {replace: true})\n\t\t}\n\t}\n\n\tfunction fireAsync() {\n\t\tif (!scheduled) {\n\t\t\tscheduled = true\n\t\t\t// TODO: just do `mountRedraw.redraw()` here and elide the timer\n\t\t\t// dependency. Note that this will muck with tests a *lot*, so it's\n\t\t\t// not as easy of a change as it sounds.\n\t\t\tcallAsync(resolveRoute)\n\t\t}\n\t}\n\n\tfunction route(root, defaultRoute, routes) {\n\t\tif (!root) throw new TypeError(\"DOM element being rendered to does not exist.\")\n\n\t\tcompiled = Object.keys(routes).map(function(route) {\n\t\t\tif (route[0] !== \"/\") throw new SyntaxError(\"Routes must start with a '/'.\")\n\t\t\tif ((/:([^\\/\\.-]+)(\\.{3})?:/).test(route)) {\n\t\t\t\tthrow new SyntaxError(\"Route parameter names must be separated with either '/', '.', or '-'.\")\n\t\t\t}\n\t\t\treturn {\n\t\t\t\troute: route,\n\t\t\t\tcomponent: routes[route],\n\t\t\t\tcheck: compileTemplate(route),\n\t\t\t}\n\t\t})\n\t\tfallbackRoute = defaultRoute\n\t\tif (defaultRoute != null) {\n\t\t\tvar defaultData = parsePathname(defaultRoute)\n\n\t\t\tif (!compiled.some(function (i) { return i.check(defaultData) })) {\n\t\t\t\tthrow new ReferenceError(\"Default route doesn't match any known routes.\")\n\t\t\t}\n\t\t}\n\t\tdom = root\n\n\t\t$window.addEventListener(\"popstate\", fireAsync, false)\n\n\t\tready = true\n\n\t\t// The RouterRoot component is mounted when the route is first resolved.\n\t\tresolveRoute()\n\t}\n\troute.set = function(path, data, options) {\n\t\tif (lastUpdate != null) {\n\t\t\toptions = options || {}\n\t\t\toptions.replace = true\n\t\t}\n\t\tlastUpdate = null\n\n\t\tpath = buildPathname(path, data)\n\t\tif (ready) {\n\t\t\tfireAsync()\n\t\t\tvar state = options ? options.state : null\n\t\t\tvar title = options ? options.title : null\n\t\t\tif (options && options.replace) $window.history.replaceState(state, title, route.prefix + path)\n\t\t\telse $window.history.pushState(state, title, route.prefix + path)\n\t\t}\n\t\telse {\n\t\t\t$window.location.href = route.prefix + path\n\t\t}\n\t}\n\troute.get = function() {return currentPath}\n\troute.prefix = \"#!\"\n\troute.Link = {\n\t\tview: function(vnode) {\n\t\t\t// Omit the used parameters from the rendered element - they are\n\t\t\t// internal. Also, censor the various lifecycle methods.\n\t\t\t//\n\t\t\t// We don't strip the other parameters because for convenience we\n\t\t\t// let them be specified in the selector as well.\n\t\t\tvar child = m(\n\t\t\t\tvnode.attrs.selector || \"a\",\n\t\t\t\tcensor(vnode.attrs, [\"options\", \"params\", \"selector\", \"onclick\"]),\n\t\t\t\tvnode.children\n\t\t\t)\n\t\t\tvar options, onclick, href\n\n\t\t\t// Let's provide a *right* way to disable a route link, rather than\n\t\t\t// letting people screw up accessibility on accident.\n\t\t\t//\n\t\t\t// The attribute is coerced so users don't get surprised over\n\t\t\t// `disabled: 0` resulting in a button that's somehow routable\n\t\t\t// despite being visibly disabled.\n\t\t\tif (child.attrs.disabled = Boolean(child.attrs.disabled)) {\n\t\t\t\tchild.attrs.href = null\n\t\t\t\tchild.attrs[\"aria-disabled\"] = \"true\"\n\t\t\t\t// If you *really* do want add `onclick` on a disabled link, use\n\t\t\t\t// an `oncreate` hook to add it.\n\t\t\t} else {\n\t\t\t\toptions = vnode.attrs.options\n\t\t\t\tonclick = vnode.attrs.onclick\n\t\t\t\t// Easier to build it now to keep it isomorphic.\n\t\t\t\thref = buildPathname(child.attrs.href, vnode.attrs.params)\n\t\t\t\tchild.attrs.href = route.prefix + href\n\t\t\t\tchild.attrs.onclick = function(e) {\n\t\t\t\t\tvar result\n\t\t\t\t\tif (typeof onclick === \"function\") {\n\t\t\t\t\t\tresult = onclick.call(e.currentTarget, e)\n\t\t\t\t\t} else if (onclick == null || typeof onclick !== \"object\") {\n\t\t\t\t\t\t// do nothing\n\t\t\t\t\t} else if (typeof onclick.handleEvent === \"function\") {\n\t\t\t\t\t\tonclick.handleEvent(e)\n\t\t\t\t\t}\n\n\t\t\t\t\t// Adapted from React Router's implementation:\n\t\t\t\t\t// https://github.com/ReactTraining/react-router/blob/520a0acd48ae1b066eb0b07d6d4d1790a1d02482/packages/react-router-dom/modules/Link.js\n\t\t\t\t\t//\n\t\t\t\t\t// Try to be flexible and intuitive in how we handle links.\n\t\t\t\t\t// Fun fact: links aren't as obvious to get right as you\n\t\t\t\t\t// would expect. There's a lot more valid ways to click a\n\t\t\t\t\t// link than this, and one might want to not simply click a\n\t\t\t\t\t// link, but right click or command-click it to copy the\n\t\t\t\t\t// link target, etc. Nope, this isn't just for blind people.\n\t\t\t\t\tif (\n\t\t\t\t\t\t// Skip if `onclick` prevented default\n\t\t\t\t\t\tresult !== false && !e.defaultPrevented &&\n\t\t\t\t\t\t// Ignore everything but left clicks\n\t\t\t\t\t\t(e.button === 0 || e.which === 0 || e.which === 1) &&\n\t\t\t\t\t\t// Let the browser handle `target=_blank`, etc.\n\t\t\t\t\t\t(!e.currentTarget.target || e.currentTarget.target === \"_self\") &&\n\t\t\t\t\t\t// No modifier keys\n\t\t\t\t\t\t!e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey\n\t\t\t\t\t) {\n\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\te.redraw = false\n\t\t\t\t\t\troute.set(href, null, options)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn child\n\t\t},\n\t}\n\troute.param = function(key) {\n\t\treturn attrs && key != null ? attrs[key] : attrs\n\t}\n\n\treturn route\n}\n", "\"use strict\"\n\nvar mountRedraw = require(\"./mount-redraw\")\n\nmodule.exports = require(\"./api/router\")(typeof window !== \"undefined\" ? window : null, mountRedraw)\n", "\"use strict\"\n\nvar hyperscript = require(\"./hyperscript\")\nvar request = require(\"./request\")\nvar mountRedraw = require(\"./mount-redraw\")\nvar domFor = require(\"./render/domFor\")\n\nvar m = function m() { return hyperscript.apply(this, arguments) }\nm.m = hyperscript\nm.trust = hyperscript.trust\nm.fragment = hyperscript.fragment\nm.Fragment = \"[\"\nm.mount = mountRedraw.mount\nm.route = require(\"./route\")\nm.render = require(\"./render\")\nm.redraw = mountRedraw.redraw\nm.request = request.request\nm.parseQueryString = require(\"./querystring/parse\")\nm.buildQueryString = require(\"./querystring/build\")\nm.parsePathname = require(\"./pathname/parse\")\nm.buildPathname = require(\"./pathname/build\")\nm.vnode = require(\"./render/vnode\")\nm.censor = require(\"./util/censor\")\nm.domFor = domFor.domFor\n\nmodule.exports = m\n", "import m from \"mithril\";\nimport {\n  AboutApp,\n  AlbumApp,\n  AlbumsApp,\n  ListingApp,\n  PhotoApp,\n  PhotosApp,\n  ThingApp,\n  VideosApp,\n} from \"./app.ts\";\n\nm.route(document.body, \"/albums\", {\n  \"/albums\": AlbumsApp,\n  \"/about\": AboutApp,\n  \"/videos\": VideosApp,\n  \"/photos\": PhotosApp,\n  \"/album/:id\": AlbumApp,\n  \"/thing/:pair\": ThingApp,\n  \"/photo/:id\": PhotoApp,\n  \"/listing/:type\": ListingApp,\n});\n", "/*\n * Mithril's Router wants components, so for the moment each page has a\n * wrapper app.\n */\n\nimport m from \"mithril\";\nimport { Header } from \"./components/header.ts\";\nimport { loadState } from \"./state.ts\";\nimport { Sidebar } from \"./components/sidebar.ts\";\nimport { AlbumsPage } from \"./pages/albums.ts\";\nimport {\n  readAlbum,\n  readAlbumPhotosByAlbumId,\n  readAlbumVideosByAlbumId,\n  readAllAlbums,\n  readThingsByAlbumId,\n} from \"./services/albums.ts\";\nimport { AboutPage } from \"./pages/about.ts\";\nimport { VideosPage } from \"./pages/videos.ts\";\nimport { readAllVideos } from \"./services/videos.ts\";\nimport { listen } from \"./commons/events.ts\";\nimport { asUrn } from \"@rgrannell1/tribbledb\";\nimport type { TripleObject } from \"@rgrannell1/tribbledb\";\nimport { AlbumPage } from \"./pages/album.ts\";\nimport { PhotosPage } from \"./pages/photos.ts\";\nimport { PhotoPage } from \"./pages/photo.ts\";\nimport { readAllPhotos, readPhoto } from \"./services/photos.ts\";\nimport { ListingPage } from \"./pages/listing.ts\";\nimport { readNamedTypeThings, readThing } from \"./services/things.ts\";\nimport type { Album } from \"./types.ts\";\nimport { ThingPage } from \"./pages/thing.ts\";\n\nconst state = await loadState();\ntype AppAttrs = {};\n\n/* */\nexport function AlbumsApp(): m.Component<AppAttrs> {\n  return {\n    oninit() {\n    },\n    view() {\n      return m(\"body\", [\n        m(\n          \"div.photos-app\",\n          { class: state.darkMode ? \"dark-mode\" : undefined },\n          [\n            m(Header, state),\n            m(\"div.app-container\", [\n              m(Sidebar, { visible: state.sidebarVisible }),\n              m(AlbumsPage, {\n                albums: readAllAlbums(state.data),\n              }),\n            ]),\n          ],\n        ),\n      ]);\n    },\n  };\n}\n\n/* */\nexport function AlbumApp(): m.Component<AppAttrs> {\n  return {\n    oninit() {\n      const id = m.route.param(\"id\");\n      state.currentAlbum = `urn:r\u00F3:album:${id}`;\n    },\n    view() {\n      if (!state.currentAlbum) {\n        return m(\"p\", \"No album selected\");\n      }\n      const album = readAlbum(state.data, state.currentAlbum) as Album;\n      const photos = readAlbumPhotosByAlbumId(state.data, state.currentAlbum);\n      const videos = readAlbumVideosByAlbumId(state.data, state.currentAlbum);\n\n      if (!album) {\n        return m(\"p\", \"Album not found\");\n      }\n\n      const { subjects, locations } = readThingsByAlbumId(\n        state.data,\n        state.currentAlbum,\n      );\n\n      return m(\"body\", [\n        m(\n          \"div.photos-app\",\n          { class: state.darkMode ? \"dark-mode\" : undefined },\n          [\n            m(Header, state),\n            m(\"div.app-container\", [\n              m(Sidebar, { visible: state.sidebarVisible }),\n              m(AlbumPage, {\n                album,\n                subjects,\n                locations,\n                photos,\n                videos,\n              }),\n            ]),\n          ],\n        ),\n      ]);\n    },\n  };\n}\n\n/* */\nexport function AboutApp(): m.Component<AppAttrs> {\n  return {\n    view() {\n      return m(\"body\", [\n        m(\n          \"div.photos-app\",\n          { class: state.darkMode ? \"dark-mode\" : undefined },\n          [\n            m(Header, state),\n            m(\"div.app-container\", [\n              m(Sidebar, { visible: state.sidebarVisible }),\n              m(AboutPage),\n            ]),\n          ],\n        ),\n      ]);\n    },\n  };\n}\n\n/* */\nexport function VideosApp(): m.Component<AppAttrs> {\n  return {\n    view() {\n      return m(\"body\", [\n        m(\n          \"div.photos-app\",\n          { class: state.darkMode ? \"dark-mode\" : undefined },\n          [\n            m(Header, state),\n            m(\"div.app-container\", [\n              m(Sidebar, { visible: state.sidebarVisible }),\n              m(VideosPage, {\n                videos: readAllVideos(state.data),\n              }),\n            ]),\n          ],\n        ),\n      ]);\n    },\n  };\n}\n\n/* */\nexport function PhotosApp(): m.Component<AppAttrs> {\n  return {\n    view() {\n      return m(\"body\", [\n        m(\n          \"div.photos-app\",\n          { class: state.darkMode ? \"dark-mode\" : undefined },\n          [\n            m(Header, state),\n            m(\"div.app-container\", [\n              m(Sidebar, { visible: state.sidebarVisible }),\n              m(PhotosPage, {\n                photos: readAllPhotos(state.data),\n              }),\n            ]),\n          ],\n        ),\n      ]);\n    },\n  };\n}\n\n/* */\nexport function ThingApp(): m.Component<AppAttrs> {\n  let things: TripleObject[] = [];\n\n  return {\n    view() {\n      const pair = m.route.param(\"pair\");\n      state.currentUrn = `urn:r\u00F3:${pair}`;\n\n      const parsed = asUrn(state.currentUrn);\n      if (parsed.id === \"*\") {\n        things = readNamedTypeThings(state.data, pair.split(\":\")[0]);\n      } else {\n        const thing = readThing(state.data, state.currentUrn);\n        if (thing) {\n          things = [thing];\n        }\n      }\n\n      if (!state.currentUrn) {\n        return m(\"p\", \"No thing selected\");\n      }\n\n      return m(\"body\", [\n        m(\n          \"div.photos-app\",\n          { class: state.darkMode ? \"dark-mode\" : undefined },\n          [\n            m(Header, state),\n            m(\"div.app-container\", [\n              m(Sidebar, { visible: state.sidebarVisible }),\n              m(ThingPage, {\n                urn: state.currentUrn,\n                things,\n                services: state.services,\n              }),\n            ]),\n          ],\n        ),\n      ]);\n    },\n  };\n}\n\n/* */\nexport function PhotoApp(): m.Component<AppAttrs> {\n  return {\n    oninit() {\n      const id = m.route.param(\"id\");\n      state.currentPhoto = `urn:r\u00F3:photo:${id}`;\n    },\n    view() {\n      if (!state.currentPhoto) {\n        return m(\"p\", \"No photo selected\");\n      }\n      const photo = readPhoto(state.data, state.currentPhoto);\n\n      if (!photo) {\n        return m(\"p\", \"Photo not found\");\n      }\n\n      return m(\"body\", [\n        m(\n          \"div.photos-app\",\n          { class: state.darkMode ? \"dark-mode\" : undefined },\n          [\n            m(Header, state),\n            m(\"div.app-container\", [\n              m(Sidebar, { visible: state.sidebarVisible }),\n              m(PhotoPage, { photo, services: state.services }),\n            ]),\n          ],\n        ),\n      ]);\n    },\n  };\n}\n\n/* */\nexport function ListingApp(): m.Component<AppAttrs> {\n  return {\n    oninit() {\n      const type = m.route.param(\"type\");\n      state.currentType = type;\n    },\n\n    view() {\n      if (!state.currentType) {\n        return m(\"p\", \"No type selected\");\n      }\n\n      const things = readNamedTypeThings(state.data, state.currentType);\n\n      return m(\"body\", [\n        m(\n          \"div.photos-app\",\n          { class: state.darkMode ? \"dark-mode\" : undefined },\n          [\n            m(Header, state),\n            m(\"div.app-container\", [\n              m(Sidebar, { visible: state.sidebarVisible }),\n              m(ListingPage, {\n                type: state.currentType,\n                things,\n              }),\n            ]),\n          ],\n        ),\n      ]);\n    },\n  };\n}\n\nlisten(\"navigate\", (event: Event) => {\n  const { route } = (event as CustomEvent).detail;\n  console.info(`navigating to route: ${route}`);\n\n  m.route.set(route);\n});\n\nlisten(\"switch_theme\", () => {\n  state.darkMode = !state.darkMode;\n});\n", "import m from \"mithril\";\nimport { broadcast } from \"../commons/events.ts\";\n\ntype HeaderAttrs = {\n  darkMode: boolean;\n};\n\n/* */\nfunction BurgerMenu() {\n  const onclick = (_: Event) => {\n    broadcast(\"click_burger_menu\", {});\n  };\n\n  return {\n    view() {\n      return m(\"a\", { href: \"/\", onclick }, m(\"span.burger\", \"\u039E\"));\n    },\n  };\n}\n\n/* */\nfunction HeaderBrandText() {\n  const BRAND_TEXT = \"photos\";\n\n  return {\n    view() {\n      return m(\"a\", { href: \"/\" }, m(\"span.brand\", BRAND_TEXT));\n    },\n  };\n}\n\n/* */\nfunction RSSIcon() {\n  const SVG_PATH = m(\"path\", {\n    fill: \"#ff9132\",\n    d: \"M 4.259,23.467c-2.35,0-4.259,1.917-4.259,4.252c0,2.349, 1.909,4.244, 4.259,4.244 c 2.358,0, 4.265-1.895, 4.265-4.244C 8.525,25.383, 6.618,23.467, 4.259,23.467zM 0.005,10.873l0,6.133 c 3.993,0, 7.749,1.562, 10.577,4.391c 2.825,2.822, 4.384,6.595, 4.384,10.603l 6.16,0 C 21.125,20.349, 11.648,10.873, 0.005,10.873zM 0.012,0l0,6.136 c 14.243,0, 25.836,11.604, 25.836,25.864L 32,32 C 32,14.36, 17.648,0, 0.012,0z\",\n  });\n\n  return {\n    view() {\n      return m(\"a.rss\", { title: \"rss\", href: \"/manifest/atom-index.xml\" }, [\n        m(\"svg\", {\n          alt: \"rss\",\n          width: \"25px\",\n          height: \"25px\",\n          viewBox: \"0 0 32 32\",\n          style: \"position: relative; top: 5px;\",\n        }, [\n          SVG_PATH,\n        ]),\n      ]);\n    },\n  };\n}\n\n/* */\nfunction ThemeSwitch() {\n  return {\n    view(vnode: m.Vnode<HeaderAttrs>) {\n      const text = vnode.attrs.darkMode ? \"\u2600\uFE0F\" : \"\uD83C\uDF19\";\n\n      return m(\n        \"a\",\n        {},\n        m(\"span.brand.switch\", {\n          onclick: () => {\n            broadcast(\"switch_theme\", {});\n          },\n        }, text),\n      );\n    },\n  };\n}\n\n/* */\nexport function Header() {\n  return {\n    view(vnode: m.Vnode<HeaderAttrs>) {\n      return m(\"nav.header\", { role: \"navigation\" }, [\n        m(\"ul\", [\n          m(\"li.header-item\", {}, m(BurgerMenu())),\n          m(\"li.header-item\", {}, m(HeaderBrandText())),\n          m(\"li.rss-tag header-item\", { style: \"float: right\" }, m(RSSIcon())),\n          m(\n            \"li.header-item\",\n            { style: \"float: right\" },\n            m(ThemeSwitch(), {\n              darkMode: vnode.attrs.darkMode,\n            }),\n          ),\n        ]),\n      ]);\n    },\n  };\n}\n", "/*\n * Handle state-updates in response to events by delegating to other services. Handles\n * state-updates and rerenders.\n */\n\nimport type { ApplicationEvents } from \"../types.ts\";\n\n/*\n * Broadcast a custom application event to the document.\n */\nexport function broadcast(\n  label: ApplicationEvents,\n  detail: CustomEvent[\"detail\"],\n) {\n  console.info(`broadcasting event: ${label}`, detail);\n\n  document.dispatchEvent(\n    new CustomEvent(label, {\n      detail,\n    }),\n  );\n}\n\n/*\n * Listen for custom application events.\n */\nexport function listen(\n  label: ApplicationEvents,\n  callback: (event: Event) => void,\n) {\n  document.addEventListener(label, callback);\n}\n\n/*\n * Prevent default action for an event.\n *\n * @param event The event to block.\n */\nexport function block(event: Event) {\n  event?.preventDefault();\n}\n\n/*\n * Broadcast a navigation event and block the default action.\n *\n * @param route The route to navigate to.\n */\nexport function navigate(route: string) {\n  return (event: Event) => {\n    broadcast(\"navigate\", { route });\n    block(event);\n  };\n}\n", "// src/sets.ts\nvar IndexedSet = class {\n  #idx;\n  #map;\n  #reverseMap;\n  constructor() {\n    this.#idx = 0;\n    this.#map = /* @__PURE__ */ new Map();\n    this.#reverseMap = /* @__PURE__ */ new Map();\n  }\n  /*\n   * Return the underlying map of values to indices\n   */\n  map() {\n    return this.#map;\n  }\n  /*\n   * Return the underlying map of indices to values\n   */\n  reverseMap() {\n    return this.#reverseMap;\n  }\n  /*\n   * Add a value to the set, and return its index\n   */\n  add(value) {\n    if (this.#map.has(value)) {\n      return this.#map.get(value);\n    }\n    this.#map.set(value, this.#idx);\n    this.#reverseMap.set(this.#idx, value);\n    this.#idx++;\n    return this.#idx - 1;\n  }\n  /**\n   * Set the index for a value in the set\n   */\n  setIndex(value, index) {\n    this.#map.set(value, index);\n    this.#reverseMap.set(index, value);\n  }\n  /**\n   * Get the index for a value in the set\n   */\n  getIndex(value) {\n    return this.#map.get(value);\n  }\n  /**\n   * Set the values for an index in the set\n   */\n  getValue(idx) {\n    return this.#reverseMap.get(idx);\n  }\n  /**\n   * Does this structure have a value?\n   */\n  has(value) {\n    return this.#map.has(value);\n  }\n};\nvar Sets = class {\n  /*\n   * Compute the intersection of multiple numeric sets.\n   * The number of sets will be low (we're not adding ninety\n   * query parameters to these URNs) so first sort the\n   * sets in ascending size.\n   */\n  static intersection(metrics, sets) {\n    if (sets.length === 0) {\n      return /* @__PURE__ */ new Set();\n    }\n    sets.sort((setA, setB) => {\n      return setA.size - setB.size;\n    });\n    const acc = new Set(sets[0]);\n    for (let idx = 1; idx < sets.length; idx++) {\n      const currentSet = sets[idx];\n      for (const value of acc) {\n        metrics.setCheck();\n        if (!currentSet.has(value)) {\n          acc.delete(value);\n        }\n      }\n      if (acc.size === 0) {\n        break;\n      }\n    }\n    return acc;\n  }\n  static append(set0, set1) {\n    for (const item of set1) {\n      set0.add(item);\n    }\n    return set0;\n  }\n};\n\n// src/tribble/parse.ts\nvar TribbleParser = class {\n  stringIndex;\n  constructor() {\n    this.stringIndex = new IndexedSet();\n  }\n  parseTriple(line) {\n    const match = line.match(/^(\\d+) (\\d+) (\\d+)$/);\n    if (!match) {\n      throw new SyntaxError(`Invalid format for triple line: ${line}`);\n    }\n    const src = this.stringIndex.getValue(parseInt(match[1], 10));\n    const rel = this.stringIndex.getValue(parseInt(match[2], 10));\n    const tgt = this.stringIndex.getValue(parseInt(match[3], 10));\n    if (src === void 0 || rel === void 0 || tgt === void 0) {\n      throw new SyntaxError(`Invalid triple reference: ${line}`);\n    }\n    return [src, rel, tgt];\n  }\n  parseDeclaration(line) {\n    const match = line.match(/^(\\d+) \"(.*)\"$/);\n    if (!match) {\n      throw new SyntaxError(`Invalid format for declaration line: ${line}`);\n    }\n    const id = match[1];\n    const value = match[2];\n    this.stringIndex.setIndex(value, parseInt(id, 10));\n  }\n  parse(line) {\n    const isTriple = /^(\\d+)\\s(\\d+)\\s(\\d+)$/;\n    if (isTriple.test(line)) {\n      return this.parseTriple(line);\n    } else {\n      this.parseDeclaration(line);\n      return;\n    }\n  }\n};\n\n// src/tribble/stringify.ts\nvar TribbleStringifier = class {\n  stringIndex;\n  constructor() {\n    this.stringIndex = new IndexedSet();\n  }\n  stringify(triple) {\n    const message = [];\n    const [source, relation, target] = triple;\n    for (const value of [source, relation, target]) {\n      if (!this.stringIndex.has(value)) {\n        const newId = this.stringIndex.add(value);\n        const stringifiedValue = value === \"null\" || value === null ? JSON.stringify(\"null\") : JSON.stringify(value.toString());\n        message.push(`${newId} ${stringifiedValue}`);\n      }\n    }\n    message.push(\n      `${this.stringIndex.getIndex(source)} ${this.stringIndex.getIndex(relation)} ${this.stringIndex.getIndex(target)}`\n    );\n    return message.join(\"\\n\");\n  }\n};\n\n// src/urn.ts\nfunction parseUrn(urn, namespace = \"r\\xF3\") {\n  if (!urn.startsWith(`urn:${namespace}:`)) {\n    throw new Error(`Invalid URN for namespace ${namespace}: ${urn}`);\n  }\n  const delimited = urn.split(\":\");\n  const type = delimited[2];\n  const idx = urn.indexOf(\"?\");\n  const queryString = idx !== -1 ? urn.slice(idx + 1) : \"\";\n  const id = idx !== -1 ? delimited[3].slice(0, delimited[3].indexOf(\"?\")) : delimited[3];\n  const qs = queryString ? Object.fromEntries(new URLSearchParams(queryString)) : {};\n  return {\n    type,\n    id,\n    qs\n  };\n}\nfunction asUrn(value, namespace = \"r\\xF3\") {\n  if (typeof value !== \"string\" || !value.startsWith(`urn:${namespace}:`)) {\n    return {\n      type: \"unknown\",\n      id: value,\n      qs: {}\n    };\n  }\n  return parseUrn(value, namespace);\n}\n\n// src/metrics.ts\nvar IndexPerformanceMetrics = class {\n  mapReadCount;\n  constructor() {\n    this.mapReadCount = 0;\n  }\n  mapRead() {\n    this.mapReadCount++;\n  }\n};\nvar TribbleDBPerformanceMetrics = class {\n  setCheckCount;\n  constructor() {\n    this.setCheckCount = 0;\n  }\n  setCheck() {\n    this.setCheckCount++;\n  }\n};\n\n// src/indices/index.ts\nvar Index = class {\n  // Internal indexed representation for memory efficiency\n  indexedTriples;\n  // String indexing sets for memory efficiency\n  stringIndex;\n  sourceType;\n  sourceId;\n  // note: QS uses a composite key: <key>=<value>\n  sourceQs;\n  relations;\n  targetType;\n  targetId;\n  targetQs;\n  metrics;\n  stringUrn;\n  constructor(triples) {\n    this.indexedTriples = [];\n    this.stringIndex = new IndexedSet();\n    this.sourceType = /* @__PURE__ */ new Map();\n    this.sourceId = /* @__PURE__ */ new Map();\n    this.sourceQs = /* @__PURE__ */ new Map();\n    this.relations = /* @__PURE__ */ new Map();\n    this.targetType = /* @__PURE__ */ new Map();\n    this.targetId = /* @__PURE__ */ new Map();\n    this.targetQs = /* @__PURE__ */ new Map();\n    this.stringUrn = /* @__PURE__ */ new Map();\n    this.add(triples);\n    this.metrics = new IndexPerformanceMetrics();\n  }\n  /*\n   * Add new triples to the index incrementally\n   */\n  add(triples) {\n    const startIdx = this.indexedTriples.length;\n    for (let jdx = 0; jdx < triples.length; jdx++) {\n      const idx = startIdx + jdx;\n      const triple = triples[jdx];\n      const source = triple[0];\n      const relation = triple[1];\n      const target = triple[2];\n      let parsedSource = this.stringUrn.get(source);\n      if (!parsedSource) {\n        parsedSource = asUrn(source);\n        this.stringUrn.set(source, parsedSource);\n      }\n      let parsedTarget = this.stringUrn.get(target);\n      if (!parsedTarget) {\n        parsedTarget = asUrn(target);\n        this.stringUrn.set(target, parsedTarget);\n      }\n      const sourceTypeIdx = this.stringIndex.add(parsedSource.type);\n      const sourceIdIdx = this.stringIndex.add(parsedSource.id);\n      const relationIdx = this.stringIndex.add(relation);\n      const targetTypeIdx = this.stringIndex.add(parsedTarget.type);\n      const targetIdIdx = this.stringIndex.add(parsedTarget.id);\n      this.indexedTriples.push([\n        this.stringIndex.add(source),\n        relationIdx,\n        this.stringIndex.add(target)\n      ]);\n      let sourceTypeSet = this.sourceType.get(sourceTypeIdx);\n      if (!sourceTypeSet) {\n        sourceTypeSet = /* @__PURE__ */ new Set();\n        this.sourceType.set(sourceTypeIdx, sourceTypeSet);\n      }\n      sourceTypeSet.add(idx);\n      let sourceIdSet = this.sourceId.get(sourceIdIdx);\n      if (!sourceIdSet) {\n        sourceIdSet = /* @__PURE__ */ new Set();\n        this.sourceId.set(sourceIdIdx, sourceIdSet);\n      }\n      sourceIdSet.add(idx);\n      for (const [key, val] of Object.entries(parsedSource.qs)) {\n        const qsIdx = this.stringIndex.add(`${key}=${val}`);\n        if (!this.sourceQs.has(qsIdx)) {\n          this.sourceQs.set(qsIdx, /* @__PURE__ */ new Set());\n        }\n        this.sourceQs.get(qsIdx).add(idx);\n      }\n      let relationSet = this.relations.get(relationIdx);\n      if (!relationSet) {\n        relationSet = /* @__PURE__ */ new Set();\n        this.relations.set(relationIdx, relationSet);\n      }\n      relationSet.add(idx);\n      let targetTypeSet = this.targetType.get(targetTypeIdx);\n      if (!targetTypeSet) {\n        targetTypeSet = /* @__PURE__ */ new Set();\n        this.targetType.set(targetTypeIdx, targetTypeSet);\n      }\n      targetTypeSet.add(idx);\n      let targetIdSet = this.targetId.get(targetIdIdx);\n      if (!targetIdSet) {\n        targetIdSet = /* @__PURE__ */ new Set();\n        this.targetId.set(targetIdIdx, targetIdSet);\n      }\n      targetIdSet.add(idx);\n      for (const [key, val] of Object.entries(parsedTarget.qs)) {\n        const qsIdx = this.stringIndex.add(`${key}=${val}`);\n        if (!this.targetQs.has(qsIdx)) {\n          this.targetQs.set(qsIdx, /* @__PURE__ */ new Set());\n        }\n        this.targetQs.get(qsIdx).add(idx);\n      }\n    }\n  }\n  /*\n   * Get the number of triples in the index\n   */\n  get length() {\n    return this.indexedTriples.length;\n  }\n  /*\n   * Reconstruct the original triples from the indexed representation\n   */\n  triples() {\n    return this.indexedTriples.map(([sourceIdx, relationIdx, targetIdx]) => [\n      this.stringIndex.getValue(sourceIdx),\n      this.stringIndex.getValue(relationIdx),\n      this.stringIndex.getValue(targetIdx)\n    ]);\n  }\n  /*\n   * Get a specific triple by index\n   */\n  getTriple(index) {\n    if (index < 0 || index >= this.indexedTriples.length) {\n      return void 0;\n    }\n    const [sourceIdx, relationIdx, targetIdx] = this.indexedTriples[index];\n    return [\n      this.stringIndex.getValue(sourceIdx),\n      this.stringIndex.getValue(relationIdx),\n      this.stringIndex.getValue(targetIdx)\n    ];\n  }\n  getTripleIndices(index) {\n    if (index < 0 || index >= this.indexedTriples.length) {\n      return void 0;\n    }\n    return this.indexedTriples[index];\n  }\n  /*\n   * Helper methods to convert string keys to indices for external API compatibility\n   */\n  getSourceTypeSet(type) {\n    const typeIdx = this.stringIndex.getIndex(type);\n    if (typeIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.sourceType.get(typeIdx);\n  }\n  getSourceIdSet(id) {\n    const idIdx = this.stringIndex.getIndex(id);\n    if (idIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.sourceId.get(idIdx);\n  }\n  getSourceQsSet(key, val) {\n    const qsIdx = this.stringIndex.getIndex(`${key}=${val}`);\n    if (qsIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.sourceQs.get(qsIdx);\n  }\n  getRelationSet(relation) {\n    const relationIdx = this.stringIndex.getIndex(relation);\n    if (relationIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.relations.get(relationIdx);\n  }\n  getTargetTypeSet(type) {\n    const typeIdx = this.stringIndex.getIndex(type);\n    if (typeIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.targetType.get(typeIdx);\n  }\n  getTargetIdSet(id) {\n    const idIdx = this.stringIndex.getIndex(id);\n    if (idIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.targetId.get(idIdx);\n  }\n  getTargetQsSet(key, val) {\n    const qsIdx = this.stringIndex.getIndex(`${key}=${val}`);\n    if (qsIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.targetQs.get(qsIdx);\n  }\n};\n\n// src/triples.ts\nvar Triples = class {\n  static source(triple) {\n    return triple[0];\n  }\n  static relation(triple) {\n    return triple[1];\n  }\n  static target(triple) {\n    return triple[2];\n  }\n};\n\n// src/tribble-db.ts\nvar TribbleDB = class _TribbleDB {\n  index;\n  triplesCount;\n  cursorIndices;\n  metrics;\n  validations;\n  constructor(triples, validations = {}) {\n    this.index = new Index(triples);\n    this.triplesCount = this.index.length;\n    this.cursorIndices = /* @__PURE__ */ new Set();\n    this.metrics = new TribbleDBPerformanceMetrics();\n    this.validations = validations;\n    for (let idx = 0; idx < this.triplesCount; idx++) {\n      this.cursorIndices.add(idx);\n    }\n  }\n  /*\n   * Clone the database.\n   *\n   * @returns A new TribbleDB instance, constructed with the same data as the original.\n   */\n  clone() {\n    const clonedDB = new _TribbleDB([]);\n    clonedDB.index = this.index;\n    clonedDB.triplesCount = this.triplesCount;\n    clonedDB.cursorIndices = this.cursorIndices;\n    clonedDB.metrics = this.metrics;\n    return clonedDB;\n  }\n  /*\n   * Convert an array of triples to a TribbleDB.\n   */\n  static of(triples) {\n    return new _TribbleDB(triples);\n  }\n  /*\n   * Convert an array of TripleObject instances to a TribbleDB.\n   *\n   * @param objects - An array of TripleObject instances.\n   *\n   * @returns A TribbleDB instance.\n   */\n  static from(objects) {\n    const triples = [];\n    for (const obj of objects) {\n      const { id, ...relations } = obj;\n      if (typeof id !== \"string\") {\n        throw new Error(\"Each TripleObject must have a string id.\");\n      }\n      for (const [relation, target] of Object.entries(relations)) {\n        if (Array.isArray(target)) {\n          for (const sub of target) {\n            triples.push([id, relation, sub]);\n          }\n        } else {\n          triples.push([id, relation, target]);\n        }\n      }\n    }\n    return new _TribbleDB(triples);\n  }\n  validateTriples(triples) {\n    const messages = [];\n    for (const [source, relation, target] of triples) {\n      const validator = this.validations[relation];\n      if (!validator) {\n        continue;\n      }\n      const { type } = asUrn(source);\n      const res = validator(type, relation, target);\n      if (typeof res === \"string\") {\n        messages.push(res);\n      }\n    }\n    if (messages.length > 0) {\n      throw new Error(`Triple validation failed:\n- ${messages.join(\"\\n- \")}`);\n    }\n  }\n  /**\n   * Add new triples to the database.\n   *\n   * @param triples - An array of triples to add.\n   */\n  add(triples) {\n    const oldLength = this.index.length;\n    this.validateTriples(triples);\n    this.index.add(triples);\n    this.triplesCount = this.index.length;\n    for (let idx = oldLength; idx < this.triplesCount; idx++) {\n      this.cursorIndices.add(idx);\n    }\n  }\n  /**\n   * Map over the triples in the database.\n   *\n   * @param fn - A mapping function.\n   * @returns A new TribbleDB instance containing the mapped triples.\n   */\n  map(fn) {\n    return new _TribbleDB(this.index.triples().map(fn));\n  }\n  /**\n   * Flat map over the triples in the database.\n   *\n   * @param fn - A mapping function.\n   * @returns A new TribbleDB instance containing the flat-mapped triples.\n   */\n  flatMap(fn) {\n    const flatMappedTriples = this.index.triples().flatMap(fn);\n    return new _TribbleDB(flatMappedTriples);\n  }\n  /**\n   * Get the first triple in the database.\n   *\n   * @returns The first triple, or undefined if there are no triples.\n   */\n  firstTriple() {\n    return this.index.length > 0 ? this.index.getTriple(0) : void 0;\n  }\n  /*\n   * Get the first source in the database.\n   */\n  firstSource() {\n    const first = this.firstTriple();\n    return first ? Triples.source(first) : void 0;\n  }\n  /**\n   * Get the first relation in the database.\n   */\n  firstRelation() {\n    const first = this.firstTriple();\n    return first ? Triples.relation(first) : void 0;\n  }\n  /**\n   * Get the first target in the database.\n   */\n  firstTarget() {\n    const first = this.firstTriple();\n    return first ? Triples.target(first) : void 0;\n  }\n  /*\n   * Get the first object in the database.\n   */\n  firstObject(listOnly = false) {\n    let firstId = void 0;\n    const obj = {};\n    for (const [source, relation, target] of this.index.triples()) {\n      if (firstId === void 0) {\n        firstId = source;\n        obj.id = source;\n      }\n      if (firstId !== source) {\n        continue;\n      }\n      if (!obj[relation]) {\n        obj[relation] = listOnly ? [target] : target;\n      } else if (Array.isArray(obj[relation])) {\n        obj[relation].push(target);\n      } else {\n        obj[relation] = [obj[relation], target];\n      }\n    }\n    return obj;\n  }\n  /*\n   * Get all triples in the database.\n   *\n   * @returns An array of all triples.\n   */\n  triples() {\n    return this.index.triples();\n  }\n  /**\n   * Get all unique sources in the database.\n   *\n   * @returns A set of all unique sources.\n   */\n  sources() {\n    return new Set(\n      this.index.triples().map(Triples.source)\n    );\n  }\n  /**\n   * Get all unique relations in the database.\n   *\n   * @returns A set of all unique relations.\n   */\n  relations() {\n    return new Set(\n      this.index.triples().map(Triples.relation)\n    );\n  }\n  /**\n   * Get all unique targets in the database.\n   *\n   * @returns A set of all unique targets.\n   */\n  targets() {\n    return new Set(\n      this.index.triples().map(Triples.target)\n    );\n  }\n  /*\n   * Get all unique objects represented by the triples.\n   *\n   * @returns An array of unique TripleObject instances.\n   */\n  objects(listOnly = false) {\n    const output = [];\n    for (const [id, obj] of Object.entries(this.#object(listOnly))) {\n      obj.id = id;\n      output.push(obj);\n    }\n    return output;\n  }\n  /*\n   * Internal function; convert all triples to an object representation.\n   *\n   * @param listOnly - Whether to always represent relation values as lists.\n   */\n  #object(listOnly = false) {\n    const objs = {};\n    for (const [source, relation, target] of this.index.triples()) {\n      if (!objs[source]) {\n        objs[source] = { id: source };\n      }\n      if (!objs[source][relation]) {\n        objs[source][relation] = listOnly ? [target] : target;\n      } else if (Array.isArray(objs[source][relation])) {\n        objs[source][relation].push(target);\n      } else {\n        objs[source][relation] = [objs[source][relation], target];\n      }\n    }\n    return objs;\n  }\n  /*\n   * Convert a node to a node DSL object.\n   */\n  nodeAsDSL(node) {\n    if (typeof node === \"undefined\") {\n      return void 0;\n    }\n    if (typeof node === \"string\") {\n      return { type: \"unknown\", id: node };\n    }\n    if (Array.isArray(node)) {\n      return { type: \"unknown\", id: node };\n    }\n    return node;\n  }\n  /*\n   * Convert a relation input to a relation DSL object\n   */\n  relationAsDSL(relation) {\n    if (typeof relation === \"undefined\") {\n      return void 0;\n    }\n    if (typeof relation === \"string\") {\n      return { relation: [relation] };\n    }\n    if (Array.isArray(relation)) {\n      return { relation };\n    }\n    return relation;\n  }\n  searchParamsToObject(params) {\n    if (!Array.isArray(params)) {\n      return params;\n    }\n    const [source, relation, target] = params;\n    return {\n      source: this.nodeAsDSL(source),\n      relation: this.relationAsDSL(relation),\n      target: this.nodeAsDSL(target)\n    };\n  }\n  #findMatchingRows(params) {\n    const matchingRowSets = [\n      this.cursorIndices\n    ];\n    const { source, relation, target } = this.searchParamsToObject(params);\n    if (typeof source === \"undefined\" && typeof target === \"undefined\" && typeof relation === \"undefined\") {\n      throw new Error(\"At least one search parameter must be defined\");\n    }\n    const allowedKeys = [\"source\", \"relation\", \"target\"];\n    if (!Array.isArray(params)) {\n      for (const key of Object.keys(params)) {\n        if (!Object.prototype.hasOwnProperty.call(params, key)) continue;\n        if (!allowedKeys.includes(key)) {\n          throw new Error(`Unexpected search parameter: ${key}`);\n        }\n      }\n    }\n    const expandedSource = this.nodeAsDSL(source);\n    const expandedRelation = this.relationAsDSL(relation);\n    const expandedTarget = this.nodeAsDSL(target);\n    if (expandedSource) {\n      if (expandedSource.type) {\n        const sourceTypeSet = this.index.getSourceTypeSet(expandedSource.type);\n        if (sourceTypeSet) {\n          matchingRowSets.push(sourceTypeSet);\n        } else {\n          return /* @__PURE__ */ new Set();\n        }\n      }\n      if (expandedSource.id) {\n        const ids = Array.isArray(expandedSource.id) ? expandedSource.id : [expandedSource.id];\n        const idSet = /* @__PURE__ */ new Set();\n        for (const id of ids) {\n          const sourceIdSet = this.index.getSourceIdSet(id);\n          if (sourceIdSet) {\n            Sets.append(idSet, sourceIdSet);\n          } else {\n            return /* @__PURE__ */ new Set();\n          }\n        }\n        matchingRowSets.push(idSet);\n      }\n      if (expandedSource.qs) {\n        for (const [key, val] of Object.entries(expandedSource.qs)) {\n          const sourceQsSet = this.index.getSourceQsSet(key, val);\n          if (sourceQsSet) {\n            matchingRowSets.push(sourceQsSet);\n          } else {\n            return /* @__PURE__ */ new Set();\n          }\n        }\n      }\n    }\n    if (expandedTarget) {\n      if (expandedTarget.type) {\n        const targetTypeSet = this.index.getTargetTypeSet(expandedTarget.type);\n        if (targetTypeSet) {\n          matchingRowSets.push(targetTypeSet);\n        } else {\n          return /* @__PURE__ */ new Set();\n        }\n      }\n      if (expandedTarget.id) {\n        const ids = Array.isArray(expandedTarget.id) ? expandedTarget.id : [expandedTarget.id];\n        const idSet = /* @__PURE__ */ new Set();\n        for (const id of ids) {\n          const targetIdSet = this.index.getTargetIdSet(id);\n          if (targetIdSet) {\n            Sets.append(idSet, targetIdSet);\n          } else {\n            return /* @__PURE__ */ new Set();\n          }\n        }\n        matchingRowSets.push(idSet);\n      }\n      if (expandedTarget.qs) {\n        for (const [key, val] of Object.entries(expandedTarget.qs)) {\n          const targetQsSet = this.index.getTargetQsSet(key, val);\n          if (targetQsSet) {\n            matchingRowSets.push(targetQsSet);\n          } else {\n            return /* @__PURE__ */ new Set();\n          }\n        }\n      }\n    }\n    if (expandedRelation && expandedRelation.relation) {\n      const unionedRelations = /* @__PURE__ */ new Set();\n      for (const rel of expandedRelation.relation) {\n        const relationSet = this.index.getRelationSet(rel);\n        if (relationSet) {\n          for (const elem of relationSet) {\n            unionedRelations.add(elem);\n          }\n        }\n      }\n      if (unionedRelations.size > 0) {\n        matchingRowSets.push(unionedRelations);\n      } else {\n        return /* @__PURE__ */ new Set();\n      }\n    }\n    const intersection = Sets.intersection(this.metrics, matchingRowSets);\n    const matchingTriples = /* @__PURE__ */ new Set();\n    const hasSourcePredicate = expandedSource?.predicate !== void 0;\n    const hasTargetPredicate = expandedTarget?.predicate !== void 0;\n    const hasRelationPredicate = typeof expandedRelation === \"object\" && expandedRelation.predicate !== void 0;\n    for (const index of intersection) {\n      const triple = this.index.getTriple(index);\n      if (!hasSourcePredicate && !hasTargetPredicate && !hasRelationPredicate) {\n        matchingTriples.add(index);\n        continue;\n      }\n      let isValid = true;\n      if (hasSourcePredicate) {\n        isValid = isValid && expandedSource.predicate(Triples.source(triple));\n      }\n      if (hasTargetPredicate && isValid) {\n        isValid = isValid && expandedTarget.predicate(Triples.target(triple));\n      }\n      if (hasRelationPredicate && isValid) {\n        isValid = isValid && expandedRelation.predicate(Triples.relation(triple));\n      }\n      if (isValid) {\n        matchingTriples.add(index);\n      }\n    }\n    return matchingTriples;\n  }\n  /*\n   * Search across all triples in the database. There are two forms of query possible:\n   *\n   * - Object: { source?, relation?, target }\n   * - Array: [ source?, relation?, target? ]\n   *\n   * @param params - The search parameters.\n   * @returns A new TribbleDB instance containing the matching triples.\n   */\n  search(params) {\n    const matchingTriples = [];\n    for (const rowIdx of this.#findMatchingRows(params)) {\n      const triple = this.index.getTriple(rowIdx);\n      if (triple) {\n        matchingTriples.push(triple);\n      }\n    }\n    return new _TribbleDB(matchingTriples);\n  }\n  /*\n   * Get performance metrics for the database.\n   */\n  getMetrics() {\n    return {\n      index: this.index.metrics,\n      db: this.metrics\n    };\n  }\n};\nexport {\n  TribbleDB,\n  TribbleParser,\n  TribbleStringifier,\n  asUrn,\n  parseUrn\n};\n", "/*\n * Manages dark mode preference in local storage\n */\nexport class DarkModes {\n  static load() {\n    return localStorage.getItem(\"darkMode\") === \"true\";\n  }\n\n  static save(value: boolean) {\n    return localStorage.setItem(\"darkMode\", `${value}`);\n  }\n}\n", "export const PHOTO_WIDTH = 400;\nexport const PHOTO_HEIGHT = 400;\n\nexport class KnownRelations {\n  static ALBUM_ID = \"albumId\";\n  static SUBJECT = \"subject\";\n  static LOCATION = \"location\";\n  static LONGITUDE = \"longitude\";\n  static LATITUDE = \"latitude\";\n  static COUNTRY = \"country\";\n  static FLAG = \"flag\";\n  static RATING = \"rating\";\n  static NAME = \"name\";\n  static BIRDWATCH_URL = \"birdwatchUrl\";\n  static WIKIPEDIA = \"wikipedia\";\n  static CREATED_AT = \"createdAt\";\n  static SEASON = \"season\";\n  static F_STOP = \"f_stop\";\n  static FOCAL_LENGTH = \"focalLength\";\n  static MODEL = \"model\";\n  static EXPOSURE_TIME = \"exposureTime\";\n  static ISO = \"iso\";\n  static WIDTH = \"width\";\n  static HEIGHT = \"height\";\n  static THUMBNAIL_URL = \"thumbnailUrl\";\n  static PNG_URL = \"pngUrl\";\n  static MID_IMAGE_LOSSY_URL = \"midImageLossyUrl\";\n  static FULL_IMAGE = \"fullImage\";\n  static POSTER_URL = \"posterUrl\";\n  static VIDEO_URL_1080P = \"videoUrl1080p\";\n  static VIDEO_URL_480P = \"videoUrl480p\";\n  static VIDEO_URL_720P = \"videoUrl720p\";\n  static VIDEO_URL_UNSCALED = \"videoUrlUnscaled\";\n  static YEAR = \"year\";\n  static CONTAINS = \"contains\";\n  static IN = \"in\";\n  static STYLE = \"style\";\n  // horrible\n  static FLAGS = \"flags\";\n}\n\nexport class KnownTypes {\n  static PLACE = \"place\";\n  static COUNTRY = \"country\";\n  static BIRD = \"bird\";\n  static MAMMAL = \"mammal\";\n  static REPTILE = \"reptile\";\n  static AMPHIBIAN = \"amphibian\";\n  static INSECT = \"insect\";\n  static CAMERA = \"camera\";\n  static PHOTO = \"photo\";\n  static VIDEO = \"video\";\n  static ALBUM = \"album\";\n  static UNESCO = \"unesco\";\n  static FISH = \"fish\";\n  static PLACE_FEATURE = \"place_feature\";\n}\n\n/*\n * It does make sense to say \"show every place photo\",\n * so designate some types as non-listable on the Listing page\n */\nexport const NonListableTypes = new Set([\n  KnownTypes.COUNTRY,\n  KnownTypes.CAMERA,\n  KnownTypes.PLACE,\n]);\n\n/*\n * A few words have irregular plurals; store them here\n * so we can display them without saying `Countrys`\n */\nexport const PLURALS = new Map<string, string>([\n  [\"country\", \"countries\"],\n]);\n\n/*\n * These relations should all expand to CDN urls\n */\nexport const CDN_RELATIONS = new Set([\n  KnownRelations.THUMBNAIL_URL,\n  KnownRelations.PNG_URL,\n  KnownRelations.MID_IMAGE_LOSSY_URL,\n  KnownRelations.FULL_IMAGE,\n  KnownRelations.POSTER_URL,\n  KnownRelations.VIDEO_URL_1080P,\n  KnownRelations.VIDEO_URL_480P,\n  KnownRelations.VIDEO_URL_720P,\n  KnownRelations.VIDEO_URL_UNSCALED,\n]);\n\n/*\n * Some relationships have inverses; store this data here\n * (though it could be passed in band in the Tribble file in future)\n */\nexport const RelationSymmetries = [\n  [KnownRelations.IN, KnownRelations.CONTAINS],\n];\n\n/*\n * A list of shortened Curies passed to the UI, and how to expand them\n */\nexport const CURIES = {\n  \"i\": \"urn:r\u00F3:\",\n  \"birdwatch\": \"https://birdwatchireland.ie/birds/\",\n  \"photos\": \"https://photos-cdn.rgrannell.xyz/\",\n  \"wiki\": \"https://en.wikipedia.org/wiki/\",\n};\n\n// Curies match this pattern\nexport const CURIE_REGEX = /^\\[([a-z]*):(.*)\\]$/;\n\n// TODO inject via environmental variable\nexport const ENDPOINT = \"https://photos-cdn.rgrannell.xyz\";\n\nexport const SCROLL_HIDE_THRESHOLD = 200;\n\n/*\n * Places have features, use these features to pick an emoji to represent the place\n */\nexport const PLACE_FEATURES_TO_EMOJI = {\n  aquarium: \"\uD83D\uDC20\",\n  archaeological: \"\uD83C\uDFFA\",\n  beach: \"\uD83C\uDFD6\uFE0F\",\n  bridge: \"\uD83C\uDF09\",\n  canal: \"\uD83D\uDEA4\",\n  castle: \"\uD83C\uDFF0\",\n  church: \"\u26EA\",\n  cathedral: \"\u26EA\",\n  cave: \"\u26CF\uFE0F\",\n  city: \"\uD83C\uDFD9\uFE0F\",\n  cliffs: \"\u26F0\uFE0F\",\n  county: \"\uD83D\uDDFA\uFE0F\",\n  district: \"\uD83C\uDFD8\uFE0F\",\n  garden: \"\uD83C\uDF3A\",\n  harbor: \"\u2693\",\n  island: \"\uD83C\uDFDD\uFE0F\",\n  lake: \"\uD83C\uDFDE\uFE0F\",\n  monument: \"\uD83D\uDDFF\",\n  mosque: \"\uD83D\uDD4C\",\n  mountain: \"\uD83C\uDFD4\uFE0F\",\n  mountains: \"\uD83C\uDFD4\uFE0F\",\n  museum: \"\uD83C\uDFDB\uFE0F\",\n  monastery: \"\uD83C\uDFEF\",\n  national: \"\uD83C\uDDFA\uD83C\uDDF3\",\n  nature: \"\uD83C\uDF3F\",\n  palace: \"\uD83C\uDFEF\",\n  park: \"\uD83C\uDF33\",\n  port: \"\uD83D\uDEF3\uFE0F\",\n  rainforest: \"\uD83C\uDF34\",\n  square: \"\uD83C\uDFE2\",\n  state: \"\uD83C\uDFDB\uFE0F\",\n  street: \"\uD83D\uDEB6\u200D\u2642\uFE0F\",\n  town: \"\uD83C\uDFD8\uFE0F\",\n  train: \"\uD83D\uDE86\",\n  unesco: \"\uD83C\uDFDB\uFE0F\",\n  village: \"\uD83C\uDFE1\",\n  volcano: \"\uD83C\uDF0B\",\n  waterfall: \"\uD83D\uDCA6\",\n  wildlife: \"\uD83E\uDD81\",\n  zoo: \"\uD83E\uDD93\",\n};\n\n/*\n * A list of cameras I've taken photos on\n */\nexport const CAMERA_MODELS = new Set([\n  \"dc-gh5\",\n  \"dc-gh6\",\n  \"dmc-fz72\",\n  \"dmc-g7\",\n  \"finepix-f70exr\",\n  \"xz-1\",\n]);\n\n/*\n * A list of phones I've taken photos on\n */\nexport const PHONE_MODELS = new Set([\n  \"pixel-4a\",\n  \"pixel-7-pro\",\n  \"pixel-9a\",\n  \"sm-a520f\",\n]);\n\nexport const BinomialTypes = new Set([\n  KnownTypes.BIRD,\n  KnownTypes.MAMMAL,\n  KnownTypes.REPTILE,\n  KnownTypes.AMPHIBIAN,\n  KnownTypes.FISH,\n  KnownTypes.INSECT,\n]);\n", "/* String Utilities */\n\nimport { PLURALS } from \"../constants.ts\";\n\nconst CAMEL_CASE_CACHE = new Map<string, string>();\n\nexport class Strings {\n  static capitalise(str: string): string {\n    return str.charAt(0).toUpperCase() + str.slice(1);\n  }\n  static pluralise(str: string): string {\n    if (PLURALS.has(str)) {\n      return PLURALS.get(str)!;\n    }\n\n    return str + \"s\";\n  }\n  static camelCase(str: string): string {\n    // Caching this since it took about 10ms at load time, so why not eliminate that?\n    if (CAMEL_CASE_CACHE.has(str)) {\n      return CAMEL_CASE_CACHE.get(str)!;\n    }\n\n    const result = str\n      .replace(/[-_ ]+([a-z0-9])/g, (_, char) => char.toUpperCase());\n\n    CAMEL_CASE_CACHE.set(str, result);\n    return result;\n  }\n\n  static binomial(binomial: string) {\n    const pretty = binomial.replace(/-/g, \" \");\n    return Strings.capitalise(pretty);\n  }\n}\n", "/*\n * We want to limit how much we send to the server,\n * so some triples are modified or derived client-side\n */\n\nimport type { Triple } from \"@rgrannell1/tribbledb\";\n\nimport {\n  CDN_RELATIONS,\n  CURIE_REGEX,\n  CURIES,\n  ENDPOINT,\n  KnownRelations,\n  RelationSymmetries,\n} from \"../constants.ts\";\nimport { Strings } from \"../commons/strings.ts\";\n\n/*\n * Convert star ratings into URNs.\n */\nexport function convertRatingsToUrns(triple: Triple): Triple[] {\n  const [src, rel, tgt] = triple;\n\n  if (rel !== KnownRelations.RATING) {\n    return [triple];\n  }\n\n  return [[\n    src,\n    rel,\n    `urn:r\u00F3:rating:${encodeURIComponent(tgt)}`,\n  ]];\n}\n\n/*\n * Convert `country` relations to URNs\n */\nexport function convertCountriesToUrns(triple: Triple): Triple[] {\n  const [src, rel, tgt] = triple;\n\n  if (rel !== KnownRelations.COUNTRY) {\n    return [triple];\n  }\n\n  const id = tgt.toLowerCase().replace(/ /g, \"-\");\n  const countryUrn = `urn:r\u00F3:country:${id}`;\n\n  return [[\n    src,\n    rel,\n    countryUrn,\n  ]];\n}\n\nconst styleNames = new Set<string>();\n\n/* */\nexport function convertStylesToUrns(triple: Triple): Triple[] {\n  const [src, rel, tgt] = triple;\n\n  if (rel !== KnownRelations.STYLE) {\n    return [triple];\n  }\n\n  const id = tgt.toLowerCase().replace(/ /g, \"-\");\n  const styleUrn = `urn:r\u00F3:style:${id}`;\n\n  if (!styleNames.has(tgt)) {\n    styleNames.add(tgt);\n    return [\n      [\n        src,\n        rel,\n        styleUrn,\n      ],\n      [\n        styleUrn,\n        KnownRelations.NAME,\n        tgt,\n      ],\n    ];\n  } else {\n    return [[\n      src,\n      rel,\n      styleUrn,\n    ]];\n  }\n}\n\n/*\n * Expand CDN urls with their endpoint\n */\nexport function expandCdnUrls(triple: Triple): Triple[] {\n  const [src, rel, tgt] = triple;\n\n  const isCDNRelation = Array.from(CDN_RELATIONS).some((candidate: string) => {\n    return rel === candidate;\n  });\n\n  if (!isCDNRelation) {\n    return [triple];\n  }\n\n  return [[\n    src,\n    rel,\n    `${ENDPOINT}${tgt}`,\n  ]];\n}\n\nexport function convertRelationCasing(triple: Triple): Triple[] {\n  const [src, rel, tgt] = triple;\n\n  return [[\n    src,\n    Strings.camelCase(rel),\n    tgt,\n  ]];\n}\n\n/*\n * Expand shortened URNS into urn:r\u00F3:\n */\nexport function expandUrns(triple: Triple): Triple[] {\n  const [src, rel, tgt] = triple;\n\n  return [[\n    typeof src === \"string\" && src.startsWith(\"::\")\n      ? `urn:r\u00F3:${src.slice(2)}`\n      : src,\n    rel,\n    typeof tgt === \"string\" && tgt.startsWith(\"::\")\n      ? `urn:r\u00F3:${tgt.slice(2)}`\n      : tgt,\n  ]];\n}\n\n/*\n * Allow search by season\n */\nexport function addSeason(triple: Triple) {\n  const [src, rel, tgt] = triple;\n\n  if (rel !== KnownRelations.CREATED_AT) {\n    return [triple];\n  }\n\n  const date = new Date(tgt);\n  if (isNaN(date.getTime())) {\n    return [triple];\n  }\n\n  const month = date.getUTCMonth() + 1;\n  let season = \"Winter\";\n  if (month >= 3 && month <= 5) {\n    season = \"Spring\";\n  } else if (month >= 6 && month <= 8) {\n    season = \"Summer\";\n  } else if (month >= 9 && month <= 11) {\n    season = \"Autumn\";\n  }\n\n  return [\n    triple,\n    [\n      src,\n      KnownRelations.SEASON,\n      season,\n    ],\n  ];\n}\n\n/*\n * Add years as a relation, when a date is present\n */\nexport function addYear(triple: Triple) {\n  const [src, rel, tgt] = triple;\n\n  if (rel !== KnownRelations.CREATED_AT) {\n    return [triple];\n  }\n\n  const date = new Date(tgt);\n  if (isNaN(date.getTime())) {\n    return [triple];\n  }\n\n  const year = date.getUTCFullYear().toString();\n\n  return [\n    triple,\n    [\n      src,\n      KnownRelations.YEAR,\n      year,\n    ],\n  ];\n}\n\n/*\n * Reverse relationships\n *\n * some relations imply other; X parent-of Y implies Y child-of X\n */\nexport function addInverseRelations(triple: Triple) {\n  const [src, rel, tgt] = triple;\n\n  for (const [to, from] of RelationSymmetries) {\n    if (rel === to) {\n      return [\n        triple,\n        [\n          tgt,\n          from,\n          src,\n        ],\n      ];\n    }\n  }\n\n  return [triple];\n}\n\nconst CURIE_CACHE = new Map<string, string>();\n\n/*\n * Expand curie-formatted URLS into their full form.\n */\nexport function expandCurie(curies: Record<string, string>, value: string) {\n  const cached = CURIE_CACHE.get(value);\n  if (cached) {\n    return cached;\n  }\n\n  if (typeof value !== \"string\" || !CURIE_REGEX.test(value)) {\n    return value;\n  }\n  const match = value.match(CURIE_REGEX);\n\n  if (!match) {\n    return value;\n  }\n\n  const prefix = match[1];\n  const id = match[2];\n\n  const result = curies[prefix] ? `${curies[prefix]}${id}` : value;\n\n  CURIE_CACHE.set(value, result);\n  return result;\n}\n\n/*\n * Some URNs are sent in CURIE format to compact them; expand\n * e.g [wiki:olm] => https://en.wikipedia.org/wiki/olm\n */\nexport function expandTripleCuries(\n  triple: Triple,\n) {\n  const [src, rel, tgt] = triple;\n\n  return [\n    [\n      expandCurie(CURIES, src),\n      rel,\n      expandCurie(CURIES, tgt),\n    ],\n  ];\n}\n\n// This is a bit unpleasant\nconst TREE_STATE = {\n  nodes: new Map<string, {\n    id: string;\n    parents: Set<string>;\n  }>,\n  // used later to detect whether a node is a leaf\n  branchIds: new Set<string>()\n}\n\n/*\n * Construct a location tree based on `in` relations.\n */\nexport function buildLocationTrees(\n  triple: Triple\n) {\n  const [src, rel, tgt] = triple;\n\n  if (rel !== KnownRelations.IN) {\n    return [triple];\n  }\n\n  const nodes = TREE_STATE.nodes;\n\n  // TODO this is probably not very efficient\n  if (!nodes.has(src)) {\n    nodes.set(src, { id: src, parents: new Set() });\n  }\n  const srcNode = nodes.get(src);\n\n  if (!nodes.has(tgt)) {\n    nodes.set(tgt, { id: tgt, parents: new Set() });\n  }\n\n  TREE_STATE.branchIds.add(tgt);\n  srcNode?.parents.add(tgt);\n\n  return [triple];\n}\n\n// This should be in mirror, but for testing...\nexport const HARD_CODED_TRIPLES: Triple[] = [\n  [\"urn:r\u00F3:rating:%E2%AD%90\", KnownRelations.NAME, \"\u2B50\"],\n  [\"urn:r\u00F3:rating:%E2%AD%90%E2%AD%90\", KnownRelations.NAME, \"\u2B50\u2B50\"],\n  [\"urn:r\u00F3:rating:%E2%AD%90%E2%AD%90%E2%AD%90\", KnownRelations.NAME, \"\u2B50\u2B50\u2B50\"],\n  [\n    \"urn:r\u00F3:rating:%E2%AD%90%E2%AD%90%E2%AD%90%E2%AD%90\",\n    KnownRelations.NAME,\n    \"\u2B50\u2B50\u2B50\u2B50\",\n  ],\n  [\n    \"urn:r\u00F3:rating:%E2%AD%90%E2%AD%90%E2%AD%90%E2%AD%90%E2%AD%90\",\n    KnownRelations.NAME,\n    \"\u2B50\u2B50\u2B50\u2B50\u2B50\",\n  ],\n];\n\n/*\n * Compose all triple modifiers together.\n *\n * This is a bottleneck (takes roughly 100ms to run)\n *\n * @param triple The input triple to modify.\n */\nexport function deriveTriples(\n  triple: Triple,\n): Triple[] {\n  const tripleProcessors = [\n    convertRatingsToUrns,\n    convertCountriesToUrns,\n    convertStylesToUrns,\n    convertRelationCasing,\n    expandCdnUrls,\n    expandUrns,\n    addSeason,\n    addYear,\n    addInverseRelations,\n    expandTripleCuries,\n    buildLocationTrees\n  ];\n\n  let outputTriples: Triple[] = [triple];\n  for (const fn of tripleProcessors) {\n    let nextStep: Triple[] = [];\n\n    for (const triple of outputTriples) {\n      nextStep.push(...(fn(triple) as Triple[]));\n    }\n\n    outputTriples = [...nextStep];\n    nextStep = [];\n  }\n\n  return outputTriples;\n}\n\n/*\n * During the initial flatmap processing of the ingested triples,\n * we built up a tree describing which places are contained in which others.\n * Construct the transitive relations in this function.\n */\nexport function addNestedLocations(): Triple[] {\n  /*\n   * Recurse up the tree from the leaves, tracing the path we followed.\n   */\n  function recurse(path: string[], urn: string): Triple[] {\n    const triples: Triple[] = [];\n\n    const node = TREE_STATE.nodes.get(urn);\n\n    // Probably not possible\n    if (!node) {\n      throw new Error(`no node in location tree for ${urn}`);\n    }\n\n    // Beats implementing cycle-detection\n    if (path.length > 5) {\n      throw new Error(`likely cycle; ${JSON.stringify(path)}`);\n    }\n\n    if (node.parents.size === 0) {\n      // in this case, we have a path A :IN B :IN C :IN D\n      // return [A, B], [A, C], [A, D], [B, C], ..., [C, D]\n      // which should be the set of transitive in relations.\n      // For good measure, throw in the `contains` inverse relation\n      const totalPath = [...path, urn];\n\n      for (let idx = 0; idx < totalPath.length - 1; idx++) {\n        for (let jdx = idx; jdx < totalPath.length; jdx++) {\n          const src = totalPath[idx];\n          const tgt = totalPath[jdx];\n\n          if (src === tgt) {\n            continue;\n          }\n\n          triples.push([ src, KnownRelations.IN, tgt ])\n          triples.push([ tgt, KnownRelations.CONTAINS, src ])\n        }\n      }\n    } else {\n      for (const parent of node.parents) {\n        triples.push(...recurse([...path, urn], parent));\n      }\n    }\n\n    return triples\n  }\n\n  const triples: Triple[] = [];\n\n  // Recurse up from all leaves A :IN B, and\n  // return all transitive location relations\n  for (const nodeId of TREE_STATE.nodes.keys()) {\n    if (TREE_STATE.branchIds.has(nodeId)) {\n      continue;\n    }\n\n    triples.push(...recurse([], nodeId));\n  }\n\n  return triples;\n}\n", "/*\n * Load tribblefile from a URL as a stream of triples.\n */\n\nimport { TribbleDB } from \"@rgrannell1/tribbledb\";\nimport type { Triple } from \"@rgrannell1/tribbledb\";\nimport { TribbleParser } from \"@rgrannell1/tribbledb\";\nimport { addNestedLocations } from \"./derive.ts\";\n\n/*\n * Stream triples from a URL\n *\n * @param url The URL to fetch triples from\n */\nexport async function* streamTribbles(url: string): AsyncGenerator<Triple[]> {\n  const parser = new TribbleParser();\n  const res = await fetch(url);\n  if (!res.body) {\n    throw new Error(\"No response body\");\n  }\n\n  const decoder = new TextDecoderStream();\n  const reader = res.body.pipeThrough(decoder).getReader();\n  let buffer = \"\";\n\n  // rather than yield 20k times, yield a few larger batches...\n  // experimentally, 500 items seems about right\n  const tripleBuffer: Triple[] = [];\n\n  while (true) {\n    const { value, done } = await reader.read();\n    if (done) {\n      break;\n    }\n    buffer += value;\n    const lines = buffer.split(\"\\n\");\n    buffer = lines.pop() ?? \"\";\n    for (const line of lines) {\n      const triple = parser.parse(line);\n      if (triple !== undefined) {\n        tripleBuffer.push(triple);\n      }\n\n      if (tripleBuffer.length >= 500) {\n        yield [...tripleBuffer];\n        tripleBuffer.length = 0;\n      }\n    }\n  }\n\n  // parse any remaining line in buffer\n  if (buffer.length > 0) {\n    const triple = parser.parse(buffer);\n    if (triple !== undefined) {\n      tripleBuffer.push(triple);\n    }\n  }\n\n  // and yield any leftover triples\n  if (tripleBuffer.length > 0) {\n    yield [...tripleBuffer];\n  }\n}\n\nlet tdb: TribbleDB | null = null;\n\n/*\n * Load triples from a URL. This takes about 500ms to run (Oct 27 2025) and\n * takes about 60% of load-time of the page. This needs to be reworked, as in the litelemet\n * version, to incrementally stream load the database while allowing the page to render.\n *\n * For now, lets make blocking load faster than 500ms...\n *\n * October 28 2025: about 250ms now\n */\nexport async function loadTriples(\n  url: string,\n  schema: Record<string, any> = {},\n  fn: (triple: Triple) => Triple[] = (x) => [x],\n): Promise<TribbleDB> {\n  if (!tdb) {\n    tdb = new TribbleDB([], schema);\n  }\n\n  for await (const triples of streamTribbles(url)) {\n    for (const triple of triples) {\n      tdb.add(fn(triple));\n    }\n  }\n\n  // construct transitive relations, which require\n  // indexing tobe done first.\n  tdb.add(addNestedLocations())\n\n\n  return tdb;\n}\n", "/*\n * Ensure a numberish value is an integer.\n */\nexport function asInt(value: string | number): number {\n  if (typeof value === \"number\") {\n    return value;\n  }\n\n  return parseInt(value, 10);\n}\n", "import { TribbleDB } from \"@rgrannell1/tribbledb\";\nimport { KnownRelations } from \"../constants.ts\";\n\nconst NAME_TO_URN_CACHE: Map<string, string> = new Map();\n\n/*\n * Fetch a single URN given a name\n *\n * @param tdb - The TribbleDB instance\n * @param name - The name to convert\n *\n * @returns The corresponding URN, or undefined if not found\n */\nexport function nameToUrn(tdb: TribbleDB, name: string): string | undefined {\n  if (NAME_TO_URN_CACHE.has(name)) {\n    return NAME_TO_URN_CACHE.get(name);\n  }\n\n  const urn = tdb.search({\n    relation: KnownRelations.NAME,\n    target: name,\n  }).firstSource();\n\n  if (urn) {\n    NAME_TO_URN_CACHE.set(name, urn as string);\n  }\n\n  return urn;\n}\n\n/*\n * Convert names to tribble URNs\n *\n * @param tdb - The TribbleDB instance\n * @param names - A set of names to convert\n *\n * @returns A set of corresponding URNs\n */\nexport function namesToUrns(tdb: TribbleDB, names: Set<string>): Set<string> {\n  const urns: Set<string> = new Set();\n  if (names.size === 0) {\n    return urns;\n  }\n\n  // lookup cached names first\n  for (const name of names) {\n    if (NAME_TO_URN_CACHE.has(name)) {\n      const cachedUrn = NAME_TO_URN_CACHE.get(name);\n      if (cachedUrn) {\n        urns.add(cachedUrn);\n      }\n    }\n  }\n\n  // if all names are cached, don't query TDB at all,\n  // since this method is slow\n  if (urns.size === names.size) {\n    return urns;\n  }\n\n  const namesCursor = tdb.search({\n    relation: KnownRelations.NAME,\n    target: Array.from(names),\n  });\n\n  for (const [urn, _, name] of namesCursor.triples()) {\n    if (names.has(name as string)) {\n      urns.add(urn as string);\n    }\n  }\n\n  return urns;\n}\n", "/*\n * Given a value, array of values, or undefined, return an array.\n * This is often required when dealing with relations that may have multiple values.\n */\nexport function arrayify<T>(value: T | T[] | undefined): T[] {\n  if (value === undefined) {\n    return [];\n  }\n\n  return Array.isArray(value) ? value : [value];\n}\n\n/*\n * Return the first value, or undefined. Often needed in cases where\n * a triple object theoretically could have multiple or missing values (e.g name)\n * but won't in practice.\n */\nexport function one<T>(value: T | T[] | undefined): T | undefined {\n  if (value === undefined) {\n    return undefined;\n  }\n\n  return Array.isArray(value) ? value[0] : value;\n}\n", "import m from \"mithril\";\nimport { asUrn, TribbleDB } from \"@rgrannell1/tribbledb\";\nimport type { TripleObject } from \"@rgrannell1/tribbledb\";\nimport { ThingLink } from \"../components/thing-link.ts\";\nimport type { ThingLinkAttrs } from \"../components/thing-link.ts\";\nimport { one } from \"../commons/arrays.ts\";\n\n/*\n * Read a thing as an undifferentiated TripleObject\n * by URN\n */\nexport function readThing(\n  tdb: TribbleDB,\n  urn: string,\n): TripleObject | undefined {\n  const parsed = asUrn(urn);\n\n  return tdb.search({\n    source: { id: parsed.id, type: parsed.type },\n  }).firstObject();\n}\n\n/*\n * Read and parse a thing by URN\n */\nexport function readParsedThing<T>(\n  parser: (tdb: TribbleDB, thing: TripleObject) => T | undefined,\n  tdb: TribbleDB,\n  id: string,\n): T | undefined {\n  const thing = readThing(tdb, id);\n  if (!thing) {\n    return undefined;\n  }\n\n  return parser(tdb, thing);\n}\n\n/*\n * Read an array of things by URN\n *\n * @param tdb TribbleDB instance\n * @param urns Set of URNs to read\n */\nexport function readThings(\n  tdb: TribbleDB,\n  urns: Set<string>,\n): TripleObject[] {\n  const things: TripleObject[] = [];\n\n  for (const urn of urns) {\n    const thing = readThing(tdb, urn);\n    if (thing) {\n      things.push(thing);\n    }\n  }\n\n  return things;\n}\n\n/*\n * Read an array of parsed things by URNs\n */\nexport const readParsedThings = function <T>(\n  parser: (tdb: TribbleDB, thing: TripleObject) => T | undefined,\n  tdb: TribbleDB,\n  urns: Set<string>,\n): T[] {\n  const parsedThings: T[] = [];\n\n  for (const urn of urns) {\n    const thing = readThing(tdb, urn);\n    if (!thing) {\n      continue;\n    }\n\n    const parsed = parser(tdb, thing);\n    if (parsed) {\n      parsedThings.push(parsed);\n    }\n  }\n\n  return parsedThings;\n};\n\n/*\n * Read all things of a given type that have a name\n */\nexport function readNamedTypeThings<T>(\n  tdb: TribbleDB,\n  type: string,\n): TripleObject[] {\n  const things = tdb.search({\n    source: { type },\n  }).objects();\n\n  return things\n    .filter((thing) => {\n      return Object.prototype.hasOwnProperty.call(thing, \"name\");\n    })\n    .sort((thinga, thingb) => {\n      const firstName = thinga.name;\n      const secondName = thingb.name;\n\n      const first = one(firstName) as string;\n      const second = one(secondName) as string;\n\n      return first.localeCompare(second);\n    });\n}\n\n// TODO: remove mithril, move to presenter folder!!\nexport function toThingLinks(\n  tdb: TribbleDB,\n  urns: (string | undefined)[],\n): m.Vnode<ThingLinkAttrs, {}>[] {\n  return urns.flatMap((urn) => {\n    if (!urn) {\n      return [];\n    }\n    const thing = readThing(tdb, urn);\n\n    if (!thing || !thing.name) {\n      return [];\n    }\n\n    return [m(ThingLink, {\n      urn,\n      thing: readThing(tdb, urn),\n    })];\n  });\n}\n", "import m from \"mithril\";\nimport { asUrn } from \"@rgrannell1/tribbledb\";\nimport { navigate } from \"../commons/events.ts\";\n\nimport { one } from \"../commons/arrays.ts\";\nimport { thingEmoji } from \"../services/emoji.ts\";\n\nexport type ThingLinkAttrs = {\n  urn: string;\n  thing: any;\n};\n\n/* */\nexport function ThingLink() {\n  return {\n    view(vnode: m.Vnode<ThingLinkAttrs>) {\n      const { urn, thing } = vnode.attrs;\n      const { type, id } = asUrn(urn);\n\n      const name = one(thing.name) ?? id;\n      const emoji = thingEmoji(urn, name, thing);\n\n      return m(\"a\", {\n        href: urn,\n        onclick: navigate(`/thing/${type}:${id}`),\n        class: [\"thing-link\", `${type}-link`].join(\" \"),\n      }, `${emoji}\\t${name}`);\n    },\n  };\n}\n", "import { asUrn } from \"@rgrannell1/tribbledb\";\nimport { one } from \"../commons/arrays.ts\";\nimport {\n  CAMERA_MODELS,\n  KnownTypes,\n  PHONE_MODELS,\n  PLACE_FEATURES_TO_EMOJI,\n} from \"../constants.ts\";\n\n/*\n * Pick an emoji based on the place feature\n *\n * @param thing The place\n */\nexport function placeEmoji(thing: any): string {\n  const feature = one(thing.feature);\n  const { id: featureId } = asUrn(feature);\n\n  if (\n    Object.prototype.hasOwnProperty.call(PLACE_FEATURES_TO_EMOJI, featureId)\n  ) {\n    return PLACE_FEATURES_TO_EMOJI[\n      featureId as keyof typeof PLACE_FEATURES_TO_EMOJI\n    ];\n  }\n\n  return \"\uD83D\uDCCD\";\n}\n\n/*\n * Load an emoji relating to a place (e.g church emoji for religious sites)\n */\nexport function placeFeatureEmoji(featureUrn: string): string {\n  const { id: featureId } = asUrn(featureUrn);\n\n  if (\n    Object.prototype.hasOwnProperty.call(PLACE_FEATURES_TO_EMOJI, featureId)\n  ) {\n    return PLACE_FEATURES_TO_EMOJI[\n      featureId as keyof typeof PLACE_FEATURES_TO_EMOJI\n    ];\n  }\n\n  return \"\uD83D\uDCCD\";\n}\n\n/*\n * Pick an flag based on the country definition\n *\n * @param thing The country thing\n */\nexport function countryEmoji(thing: any): string {\n  const flag = one(thing.flag);\n  return flag; //?? \"\uD83C\uDFF3\uFE0F\";\n}\n\n/*\n * Pick a bird emoji\n */\nfunction birdEmoji(): string {\n  return \"\uD83D\uDC24\";\n}\n\n/*\n * Pick an emoji for the camera\n *\n * @param thing The thing to get the emoji for, based on id\n */\nfunction cameraEmoji(thing: any): string {\n  const { id } = asUrn(thing.id);\n\n  if (CAMERA_MODELS.has(id)) {\n    return \"\uD83D\uDCF7\";\n  } else if (PHONE_MODELS.has(id)) {\n    return \"\uD83D\uDCF1\";\n  }\n\n  return \"\uD83D\uDCF7\";\n}\n\n/* */\nexport function thingEmoji(urn: string, name: string, thing: any): string {\n  const { type } = asUrn(urn);\n\n  switch (type) {\n    case KnownTypes.PLACE:\n      return placeEmoji(thing);\n    case KnownTypes.COUNTRY:\n      return countryEmoji(thing);\n    case KnownTypes.BIRD:\n      return birdEmoji();\n    case KnownTypes.CAMERA:\n      return cameraEmoji(thing);\n    case KnownTypes.PLACE_FEATURE:\n      return placeFeatureEmoji(urn);\n    default:\n      return \"\";\n  }\n}\n", "// src/storages/globalConfig/globalConfig.ts\nvar store;\nfunction setGlobalConfig(config2) {\n  store = { ...store, ...config2 };\n}\n// @__NO_SIDE_EFFECTS__\nfunction getGlobalConfig(config2) {\n  return {\n    lang: config2?.lang ?? store?.lang,\n    message: config2?.message,\n    abortEarly: config2?.abortEarly ?? store?.abortEarly,\n    abortPipeEarly: config2?.abortPipeEarly ?? store?.abortPipeEarly\n  };\n}\nfunction deleteGlobalConfig() {\n  store = void 0;\n}\n\n// src/storages/globalMessage/globalMessage.ts\nvar store2;\nfunction setGlobalMessage(message2, lang) {\n  if (!store2) store2 = /* @__PURE__ */ new Map();\n  store2.set(lang, message2);\n}\n// @__NO_SIDE_EFFECTS__\nfunction getGlobalMessage(lang) {\n  return store2?.get(lang);\n}\nfunction deleteGlobalMessage(lang) {\n  store2?.delete(lang);\n}\n\n// src/storages/schemaMessage/schemaMessage.ts\nvar store3;\nfunction setSchemaMessage(message2, lang) {\n  if (!store3) store3 = /* @__PURE__ */ new Map();\n  store3.set(lang, message2);\n}\n// @__NO_SIDE_EFFECTS__\nfunction getSchemaMessage(lang) {\n  return store3?.get(lang);\n}\nfunction deleteSchemaMessage(lang) {\n  store3?.delete(lang);\n}\n\n// src/storages/specificMessage/specificMessage.ts\nvar store4;\nfunction setSpecificMessage(reference, message2, lang) {\n  if (!store4) store4 = /* @__PURE__ */ new Map();\n  if (!store4.get(reference)) store4.set(reference, /* @__PURE__ */ new Map());\n  store4.get(reference).set(lang, message2);\n}\n// @__NO_SIDE_EFFECTS__\nfunction getSpecificMessage(reference, lang) {\n  return store4?.get(reference)?.get(lang);\n}\nfunction deleteSpecificMessage(reference, lang) {\n  store4?.get(reference)?.delete(lang);\n}\n\n// src/utils/_stringify/_stringify.ts\n// @__NO_SIDE_EFFECTS__\nfunction _stringify(input) {\n  const type = typeof input;\n  if (type === \"string\") {\n    return `\"${input}\"`;\n  }\n  if (type === \"number\" || type === \"bigint\" || type === \"boolean\") {\n    return `${input}`;\n  }\n  if (type === \"object\" || type === \"function\") {\n    return (input && Object.getPrototypeOf(input)?.constructor?.name) ?? \"null\";\n  }\n  return type;\n}\n\n// src/utils/_addIssue/_addIssue.ts\nfunction _addIssue(context, label, dataset, config2, other) {\n  const input = other && \"input\" in other ? other.input : dataset.value;\n  const expected = other?.expected ?? context.expects ?? null;\n  const received = other?.received ?? _stringify(input);\n  const issue = {\n    kind: context.kind,\n    type: context.type,\n    input,\n    expected,\n    received,\n    message: `Invalid ${label}: ${expected ? `Expected ${expected} but r` : \"R\"}eceived ${received}`,\n    requirement: context.requirement,\n    path: other?.path,\n    issues: other?.issues,\n    lang: config2.lang,\n    abortEarly: config2.abortEarly,\n    abortPipeEarly: config2.abortPipeEarly\n  };\n  const isSchema = context.kind === \"schema\";\n  const message2 = other?.message ?? context.message ?? getSpecificMessage(context.reference, issue.lang) ?? (isSchema ? getSchemaMessage(issue.lang) : null) ?? config2.message ?? getGlobalMessage(issue.lang);\n  if (message2 !== void 0) {\n    issue.message = typeof message2 === \"function\" ? (\n      // @ts-expect-error\n      message2(issue)\n    ) : message2;\n  }\n  if (isSchema) {\n    dataset.typed = false;\n  }\n  if (dataset.issues) {\n    dataset.issues.push(issue);\n  } else {\n    dataset.issues = [issue];\n  }\n}\n\n// src/utils/_getByteCount/_getByteCount.ts\nvar textEncoder;\n// @__NO_SIDE_EFFECTS__\nfunction _getByteCount(input) {\n  if (!textEncoder) {\n    textEncoder = new TextEncoder();\n  }\n  return textEncoder.encode(input).length;\n}\n\n// src/utils/_getGraphemeCount/_getGraphemeCount.ts\nvar segmenter;\n// @__NO_SIDE_EFFECTS__\nfunction _getGraphemeCount(input) {\n  if (!segmenter) {\n    segmenter = new Intl.Segmenter();\n  }\n  const segments = segmenter.segment(input);\n  let count = 0;\n  for (const _ of segments) {\n    count++;\n  }\n  return count;\n}\n\n// src/utils/_getLastMetadata/_getLastMetadata.ts\n// @__NO_SIDE_EFFECTS__\nfunction _getLastMetadata(schema, type) {\n  if (\"pipe\" in schema) {\n    const nestedSchemas = [];\n    for (let index = schema.pipe.length - 1; index >= 0; index--) {\n      const item = schema.pipe[index];\n      if (item.kind === \"schema\" && \"pipe\" in item) {\n        nestedSchemas.push(item);\n      } else if (item.kind === \"metadata\" && item.type === type) {\n        return item[type];\n      }\n    }\n    for (const nestedSchema of nestedSchemas) {\n      const result = /* @__PURE__ */ _getLastMetadata(nestedSchema, type);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n  }\n}\n\n// src/utils/_getStandardProps/_getStandardProps.ts\n// @__NO_SIDE_EFFECTS__\nfunction _getStandardProps(context) {\n  return {\n    version: 1,\n    vendor: \"valibot\",\n    validate(value2) {\n      return context[\"~run\"]({ value: value2 }, getGlobalConfig());\n    }\n  };\n}\n\n// src/utils/_getWordCount/_getWordCount.ts\nvar store5;\n// @__NO_SIDE_EFFECTS__\nfunction _getWordCount(locales, input) {\n  if (!store5) {\n    store5 = /* @__PURE__ */ new Map();\n  }\n  if (!store5.get(locales)) {\n    store5.set(locales, new Intl.Segmenter(locales, { granularity: \"word\" }));\n  }\n  const segments = store5.get(locales).segment(input);\n  let count = 0;\n  for (const segment of segments) {\n    if (segment.isWordLike) {\n      count++;\n    }\n  }\n  return count;\n}\n\n// src/utils/_isLuhnAlgo/_isLuhnAlgo.ts\nvar NON_DIGIT_REGEX = /\\D/gu;\n// @__NO_SIDE_EFFECTS__\nfunction _isLuhnAlgo(input) {\n  const number2 = input.replace(NON_DIGIT_REGEX, \"\");\n  let length2 = number2.length;\n  let bit = 1;\n  let sum = 0;\n  while (length2) {\n    const value2 = +number2[--length2];\n    bit ^= 1;\n    sum += bit ? [0, 2, 4, 6, 8, 1, 3, 5, 7, 9][value2] : value2;\n  }\n  return sum % 10 === 0;\n}\n\n// src/utils/_isValidObjectKey/_isValidObjectKey.ts\n// @__NO_SIDE_EFFECTS__\nfunction _isValidObjectKey(object2, key) {\n  return Object.hasOwn(object2, key) && key !== \"__proto__\" && key !== \"prototype\" && key !== \"constructor\";\n}\n\n// src/utils/_joinExpects/_joinExpects.ts\n// @__NO_SIDE_EFFECTS__\nfunction _joinExpects(values2, separator) {\n  const list = [...new Set(values2)];\n  if (list.length > 1) {\n    return `(${list.join(` ${separator} `)})`;\n  }\n  return list[0] ?? \"never\";\n}\n\n// src/utils/entriesFromList/entriesFromList.ts\n// @__NO_SIDE_EFFECTS__\nfunction entriesFromList(list, schema) {\n  const entries2 = {};\n  for (const key of list) {\n    entries2[key] = schema;\n  }\n  return entries2;\n}\n\n// src/utils/entriesFromObjects/entriesFromObjects.ts\n// @__NO_SIDE_EFFECTS__\nfunction entriesFromObjects(schemas) {\n  const entries2 = {};\n  for (const schema of schemas) {\n    Object.assign(entries2, schema.entries);\n  }\n  return entries2;\n}\n\n// src/utils/getDotPath/getDotPath.ts\n// @__NO_SIDE_EFFECTS__\nfunction getDotPath(issue) {\n  if (issue.path) {\n    let key = \"\";\n    for (const item of issue.path) {\n      if (typeof item.key === \"string\" || typeof item.key === \"number\") {\n        if (key) {\n          key += `.${item.key}`;\n        } else {\n          key += item.key;\n        }\n      } else {\n        return null;\n      }\n    }\n    return key;\n  }\n  return null;\n}\n\n// src/utils/isOfKind/isOfKind.ts\n// @__NO_SIDE_EFFECTS__\nfunction isOfKind(kind, object2) {\n  return object2.kind === kind;\n}\n\n// src/utils/isOfType/isOfType.ts\n// @__NO_SIDE_EFFECTS__\nfunction isOfType(type, object2) {\n  return object2.type === type;\n}\n\n// src/utils/isValiError/isValiError.ts\n// @__NO_SIDE_EFFECTS__\nfunction isValiError(error) {\n  return error instanceof ValiError;\n}\n\n// src/utils/ValiError/ValiError.ts\nvar ValiError = class extends Error {\n  /**\n   * Creates a Valibot error with useful information.\n   *\n   * @param issues The error issues.\n   */\n  constructor(issues) {\n    super(issues[0].message);\n    this.name = \"ValiError\";\n    this.issues = issues;\n  }\n};\n\n// src/actions/args/args.ts\n// @__NO_SIDE_EFFECTS__\nfunction args(schema) {\n  return {\n    kind: \"transformation\",\n    type: \"args\",\n    reference: args,\n    async: false,\n    schema,\n    \"~run\"(dataset, config2) {\n      const func = dataset.value;\n      dataset.value = (...args_) => {\n        const argsDataset = this.schema[\"~run\"]({ value: args_ }, config2);\n        if (argsDataset.issues) {\n          throw new ValiError(argsDataset.issues);\n        }\n        return func(...argsDataset.value);\n      };\n      return dataset;\n    }\n  };\n}\n\n// src/actions/args/argsAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction argsAsync(schema) {\n  return {\n    kind: \"transformation\",\n    type: \"args\",\n    reference: argsAsync,\n    async: false,\n    schema,\n    \"~run\"(dataset, config2) {\n      const func = dataset.value;\n      dataset.value = async (...args2) => {\n        const argsDataset = await schema[\"~run\"]({ value: args2 }, config2);\n        if (argsDataset.issues) {\n          throw new ValiError(argsDataset.issues);\n        }\n        return func(...argsDataset.value);\n      };\n      return dataset;\n    }\n  };\n}\n\n// src/actions/await/awaitAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction awaitAsync() {\n  return {\n    kind: \"transformation\",\n    type: \"await\",\n    reference: awaitAsync,\n    async: true,\n    async \"~run\"(dataset) {\n      dataset.value = await dataset.value;\n      return dataset;\n    }\n  };\n}\n\n// src/regex.ts\nvar BASE64_REGEX = /^(?:[\\da-z+/]{4})*(?:[\\da-z+/]{2}==|[\\da-z+/]{3}=)?$/iu;\nvar BIC_REGEX = /^[A-Z]{6}(?!00)[\\dA-Z]{2}(?:[\\dA-Z]{3})?$/u;\nvar CUID2_REGEX = /^[a-z][\\da-z]*$/u;\nvar DECIMAL_REGEX = /^[+-]?(?:\\d*\\.)?\\d+$/u;\nvar DIGITS_REGEX = /^\\d+$/u;\nvar EMAIL_REGEX = /^[\\w+-]+(?:\\.[\\w+-]+)*@[\\da-z]+(?:[.-][\\da-z]+)*\\.[a-z]{2,}$/iu;\nvar EMOJI_REGEX = (\n  // eslint-disable-next-line redos-detector/no-unsafe-regex, regexp/no-dupe-disjunctions -- false positives\n  /^(?:[\\u{1F1E6}-\\u{1F1FF}]{2}|\\u{1F3F4}[\\u{E0061}-\\u{E007A}]{2}[\\u{E0030}-\\u{E0039}\\u{E0061}-\\u{E007A}]{1,3}\\u{E007F}|(?:\\p{Emoji}\\uFE0F\\u20E3?|\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation})(?:\\u200D(?:\\p{Emoji}\\uFE0F\\u20E3?|\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation}))*)+$/u\n);\nvar HEXADECIMAL_REGEX = /^(?:0[hx])?[\\da-fA-F]+$/u;\nvar HEX_COLOR_REGEX = /^#(?:[\\da-fA-F]{3,4}|[\\da-fA-F]{6}|[\\da-fA-F]{8})$/u;\nvar IMEI_REGEX = /^\\d{15}$|^\\d{2}-\\d{6}-\\d{6}-\\d$/u;\nvar IPV4_REGEX = (\n  // eslint-disable-next-line redos-detector/no-unsafe-regex -- false positive\n  /^(?:(?:[1-9]|1\\d|2[0-4])?\\d|25[0-5])(?:\\.(?:(?:[1-9]|1\\d|2[0-4])?\\d|25[0-5])){3}$/u\n);\nvar IPV6_REGEX = /^(?:(?:[\\da-f]{1,4}:){7}[\\da-f]{1,4}|(?:[\\da-f]{1,4}:){1,7}:|(?:[\\da-f]{1,4}:){1,6}:[\\da-f]{1,4}|(?:[\\da-f]{1,4}:){1,5}(?::[\\da-f]{1,4}){1,2}|(?:[\\da-f]{1,4}:){1,4}(?::[\\da-f]{1,4}){1,3}|(?:[\\da-f]{1,4}:){1,3}(?::[\\da-f]{1,4}){1,4}|(?:[\\da-f]{1,4}:){1,2}(?::[\\da-f]{1,4}){1,5}|[\\da-f]{1,4}:(?::[\\da-f]{1,4}){1,6}|:(?:(?::[\\da-f]{1,4}){1,7}|:)|fe80:(?::[\\da-f]{0,4}){0,4}%[\\da-z]+|::(?:f{4}(?::0{1,4})?:)?(?:(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d)\\.){3}(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d)|(?:[\\da-f]{1,4}:){1,4}:(?:(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d)\\.){3}(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d))$/iu;\nvar IP_REGEX = /^(?:(?:[1-9]|1\\d|2[0-4])?\\d|25[0-5])(?:\\.(?:(?:[1-9]|1\\d|2[0-4])?\\d|25[0-5])){3}$|^(?:(?:[\\da-f]{1,4}:){7}[\\da-f]{1,4}|(?:[\\da-f]{1,4}:){1,7}:|(?:[\\da-f]{1,4}:){1,6}:[\\da-f]{1,4}|(?:[\\da-f]{1,4}:){1,5}(?::[\\da-f]{1,4}){1,2}|(?:[\\da-f]{1,4}:){1,4}(?::[\\da-f]{1,4}){1,3}|(?:[\\da-f]{1,4}:){1,3}(?::[\\da-f]{1,4}){1,4}|(?:[\\da-f]{1,4}:){1,2}(?::[\\da-f]{1,4}){1,5}|[\\da-f]{1,4}:(?::[\\da-f]{1,4}){1,6}|:(?:(?::[\\da-f]{1,4}){1,7}|:)|fe80:(?::[\\da-f]{0,4}){0,4}%[\\da-z]+|::(?:f{4}(?::0{1,4})?:)?(?:(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d)\\.){3}(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d)|(?:[\\da-f]{1,4}:){1,4}:(?:(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d)\\.){3}(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d))$/iu;\nvar ISO_DATE_REGEX = /^\\d{4}-(?:0[1-9]|1[0-2])-(?:[12]\\d|0[1-9]|3[01])$/u;\nvar ISO_DATE_TIME_REGEX = /^\\d{4}-(?:0[1-9]|1[0-2])-(?:[12]\\d|0[1-9]|3[01])[T ](?:0\\d|1\\d|2[0-3]):[0-5]\\d$/u;\nvar ISO_TIME_REGEX = /^(?:0\\d|1\\d|2[0-3]):[0-5]\\d$/u;\nvar ISO_TIME_SECOND_REGEX = /^(?:0\\d|1\\d|2[0-3])(?::[0-5]\\d){2}$/u;\nvar ISO_TIMESTAMP_REGEX = /^\\d{4}-(?:0[1-9]|1[0-2])-(?:[12]\\d|0[1-9]|3[01])[T ](?:0\\d|1\\d|2[0-3])(?::[0-5]\\d){2}(?:\\.\\d{1,9})?(?:Z|[+-](?:0\\d|1\\d|2[0-3])(?::?[0-5]\\d)?)$/u;\nvar ISO_WEEK_REGEX = /^\\d{4}-W(?:0[1-9]|[1-4]\\d|5[0-3])$/u;\nvar MAC48_REGEX = /^(?:[\\da-f]{2}:){5}[\\da-f]{2}$|^(?:[\\da-f]{2}-){5}[\\da-f]{2}$|^(?:[\\da-f]{4}\\.){2}[\\da-f]{4}$/iu;\nvar MAC64_REGEX = /^(?:[\\da-f]{2}:){7}[\\da-f]{2}$|^(?:[\\da-f]{2}-){7}[\\da-f]{2}$|^(?:[\\da-f]{4}\\.){3}[\\da-f]{4}$|^(?:[\\da-f]{4}:){3}[\\da-f]{4}$/iu;\nvar MAC_REGEX = /^(?:[\\da-f]{2}:){5}[\\da-f]{2}$|^(?:[\\da-f]{2}-){5}[\\da-f]{2}$|^(?:[\\da-f]{4}\\.){2}[\\da-f]{4}$|^(?:[\\da-f]{2}:){7}[\\da-f]{2}$|^(?:[\\da-f]{2}-){7}[\\da-f]{2}$|^(?:[\\da-f]{4}\\.){3}[\\da-f]{4}$|^(?:[\\da-f]{4}:){3}[\\da-f]{4}$/iu;\nvar NANO_ID_REGEX = /^[\\w-]+$/u;\nvar OCTAL_REGEX = /^(?:0o)?[0-7]+$/u;\nvar RFC_EMAIL_REGEX = (\n  // eslint-disable-next-line regexp/prefer-w, no-useless-escape, regexp/no-useless-escape, regexp/require-unicode-regexp\n  /^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/\n);\nvar SLUG_REGEX = /^[\\da-z]+(?:[-_][\\da-z]+)*$/u;\nvar ULID_REGEX = /^[\\da-hjkmnp-tv-zA-HJKMNP-TV-Z]{26}$/u;\nvar UUID_REGEX = /^[\\da-f]{8}(?:-[\\da-f]{4}){3}-[\\da-f]{12}$/iu;\n\n// src/actions/base64/base64.ts\n// @__NO_SIDE_EFFECTS__\nfunction base64(message2) {\n  return {\n    kind: \"validation\",\n    type: \"base64\",\n    reference: base64,\n    async: false,\n    expects: null,\n    requirement: BASE64_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"Base64\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/bic/bic.ts\n// @__NO_SIDE_EFFECTS__\nfunction bic(message2) {\n  return {\n    kind: \"validation\",\n    type: \"bic\",\n    reference: bic,\n    async: false,\n    expects: null,\n    requirement: BIC_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"BIC\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/brand/brand.ts\n// @__NO_SIDE_EFFECTS__\nfunction brand(name) {\n  return {\n    kind: \"transformation\",\n    type: \"brand\",\n    reference: brand,\n    async: false,\n    name,\n    \"~run\"(dataset) {\n      return dataset;\n    }\n  };\n}\n\n// src/actions/bytes/bytes.ts\n// @__NO_SIDE_EFFECTS__\nfunction bytes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"bytes\",\n    reference: bytes,\n    async: false,\n    expects: `${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const length2 = _getByteCount(dataset.value);\n        if (length2 !== this.requirement) {\n          _addIssue(this, \"bytes\", dataset, config2, {\n            received: `${length2}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/check/check.ts\n// @__NO_SIDE_EFFECTS__\nfunction check(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"check\",\n    reference: check,\n    async: false,\n    expects: null,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"input\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/check/checkAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction checkAsync(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"check\",\n    reference: checkAsync,\n    async: true,\n    expects: null,\n    requirement,\n    message: message2,\n    async \"~run\"(dataset, config2) {\n      if (dataset.typed && !await this.requirement(dataset.value)) {\n        _addIssue(this, \"input\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/checkItems/checkItems.ts\n// @__NO_SIDE_EFFECTS__\nfunction checkItems(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"check_items\",\n    reference: checkItems,\n    async: false,\n    expects: null,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        for (let index = 0; index < dataset.value.length; index++) {\n          const item = dataset.value[index];\n          if (!this.requirement(item, index, dataset.value)) {\n            _addIssue(this, \"item\", dataset, config2, {\n              input: item,\n              path: [\n                {\n                  type: \"array\",\n                  origin: \"value\",\n                  input: dataset.value,\n                  key: index,\n                  value: item\n                }\n              ]\n            });\n          }\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/checkItems/checkItemsAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction checkItemsAsync(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"check_items\",\n    reference: checkItemsAsync,\n    async: true,\n    expects: null,\n    requirement,\n    message: message2,\n    async \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const requirementResults = await Promise.all(\n          dataset.value.map(this.requirement)\n        );\n        for (let index = 0; index < dataset.value.length; index++) {\n          if (!requirementResults[index]) {\n            const item = dataset.value[index];\n            _addIssue(this, \"item\", dataset, config2, {\n              input: item,\n              path: [\n                {\n                  type: \"array\",\n                  origin: \"value\",\n                  input: dataset.value,\n                  key: index,\n                  value: item\n                }\n              ]\n            });\n          }\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/creditCard/creditCard.ts\nvar CREDIT_CARD_REGEX = /^(?:\\d{14,19}|\\d{4}(?: \\d{3,6}){2,4}|\\d{4}(?:-\\d{3,6}){2,4})$/u;\nvar SANITIZE_REGEX = /[- ]/gu;\nvar PROVIDER_REGEX_LIST = [\n  // American Express\n  /^3[47]\\d{13}$/u,\n  // Diners Club\n  /^3(?:0[0-5]|[68]\\d)\\d{11,13}$/u,\n  // Discover\n  /^6(?:011|5\\d{2})\\d{12,15}$/u,\n  // JCB\n  /^(?:2131|1800|35\\d{3})\\d{11}$/u,\n  // Mastercard\n  // eslint-disable-next-line redos-detector/no-unsafe-regex\n  /^5[1-5]\\d{2}|(?:222\\d|22[3-9]\\d|2[3-6]\\d{2}|27[01]\\d|2720)\\d{12}$/u,\n  // UnionPay\n  /^(?:6[27]\\d{14,17}|81\\d{14,17})$/u,\n  // Visa\n  /^4\\d{12}(?:\\d{3,6})?$/u\n];\n// @__NO_SIDE_EFFECTS__\nfunction creditCard(message2) {\n  return {\n    kind: \"validation\",\n    type: \"credit_card\",\n    reference: creditCard,\n    async: false,\n    expects: null,\n    requirement(input) {\n      let sanitized;\n      return CREDIT_CARD_REGEX.test(input) && // Remove any hyphens and blanks\n      (sanitized = input.replace(SANITIZE_REGEX, \"\")) && // Check if it matches a provider\n      PROVIDER_REGEX_LIST.some((regex2) => regex2.test(sanitized)) && // Check if passes luhn algorithm\n      _isLuhnAlgo(sanitized);\n    },\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"credit card\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/cuid2/cuid2.ts\n// @__NO_SIDE_EFFECTS__\nfunction cuid2(message2) {\n  return {\n    kind: \"validation\",\n    type: \"cuid2\",\n    reference: cuid2,\n    async: false,\n    expects: null,\n    requirement: CUID2_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"Cuid2\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/decimal/decimal.ts\n// @__NO_SIDE_EFFECTS__\nfunction decimal(message2) {\n  return {\n    kind: \"validation\",\n    type: \"decimal\",\n    reference: decimal,\n    async: false,\n    expects: null,\n    requirement: DECIMAL_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"decimal\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/description/description.ts\n// @__NO_SIDE_EFFECTS__\nfunction description(description_) {\n  return {\n    kind: \"metadata\",\n    type: \"description\",\n    reference: description,\n    description: description_\n  };\n}\n\n// src/actions/digits/digits.ts\n// @__NO_SIDE_EFFECTS__\nfunction digits(message2) {\n  return {\n    kind: \"validation\",\n    type: \"digits\",\n    reference: digits,\n    async: false,\n    expects: null,\n    requirement: DIGITS_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"digits\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/email/email.ts\n// @__NO_SIDE_EFFECTS__\nfunction email(message2) {\n  return {\n    kind: \"validation\",\n    type: \"email\",\n    reference: email,\n    expects: null,\n    async: false,\n    requirement: EMAIL_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"email\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/emoji/emoji.ts\n// @__NO_SIDE_EFFECTS__\nfunction emoji(message2) {\n  return {\n    kind: \"validation\",\n    type: \"emoji\",\n    reference: emoji,\n    async: false,\n    expects: null,\n    requirement: EMOJI_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"emoji\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/empty/empty.ts\n// @__NO_SIDE_EFFECTS__\nfunction empty(message2) {\n  return {\n    kind: \"validation\",\n    type: \"empty\",\n    reference: empty,\n    async: false,\n    expects: \"0\",\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.length > 0) {\n        _addIssue(this, \"length\", dataset, config2, {\n          received: `${dataset.value.length}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/endsWith/endsWith.ts\n// @__NO_SIDE_EFFECTS__\nfunction endsWith(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"ends_with\",\n    reference: endsWith,\n    async: false,\n    expects: `\"${requirement}\"`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !dataset.value.endsWith(this.requirement)) {\n        _addIssue(this, \"end\", dataset, config2, {\n          received: `\"${dataset.value.slice(-this.requirement.length)}\"`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/entries/entries.ts\n// @__NO_SIDE_EFFECTS__\nfunction entries(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"entries\",\n    reference: entries,\n    async: false,\n    expects: `${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (!dataset.typed) return dataset;\n      const count = Object.keys(dataset.value).length;\n      if (dataset.typed && count !== this.requirement) {\n        _addIssue(this, \"entries\", dataset, config2, {\n          received: `${count}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/everyItem/everyItem.ts\n// @__NO_SIDE_EFFECTS__\nfunction everyItem(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"every_item\",\n    reference: everyItem,\n    async: false,\n    expects: null,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !dataset.value.every(this.requirement)) {\n        _addIssue(this, \"item\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/excludes/excludes.ts\n// @__NO_SIDE_EFFECTS__\nfunction excludes(requirement, message2) {\n  const received = _stringify(requirement);\n  return {\n    kind: \"validation\",\n    type: \"excludes\",\n    reference: excludes,\n    async: false,\n    expects: `!${received}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.includes(this.requirement)) {\n        _addIssue(this, \"content\", dataset, config2, { received });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/filterItems/filterItems.ts\n// @__NO_SIDE_EFFECTS__\nfunction filterItems(operation) {\n  return {\n    kind: \"transformation\",\n    type: \"filter_items\",\n    reference: filterItems,\n    async: false,\n    operation,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.filter(this.operation);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/findItem/findItem.ts\n// @__NO_SIDE_EFFECTS__\nfunction findItem(operation) {\n  return {\n    kind: \"transformation\",\n    type: \"find_item\",\n    reference: findItem,\n    async: false,\n    operation,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.find(this.operation);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/finite/finite.ts\n// @__NO_SIDE_EFFECTS__\nfunction finite(message2) {\n  return {\n    kind: \"validation\",\n    type: \"finite\",\n    reference: finite,\n    async: false,\n    expects: null,\n    requirement: Number.isFinite,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"finite\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/flavor/flavor.ts\n// @__NO_SIDE_EFFECTS__\nfunction flavor(name) {\n  return {\n    kind: \"transformation\",\n    type: \"flavor\",\n    reference: flavor,\n    async: false,\n    name,\n    \"~run\"(dataset) {\n      return dataset;\n    }\n  };\n}\n\n// src/actions/graphemes/graphemes.ts\n// @__NO_SIDE_EFFECTS__\nfunction graphemes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"graphemes\",\n    reference: graphemes,\n    async: false,\n    expects: `${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getGraphemeCount(dataset.value);\n        if (count !== this.requirement) {\n          _addIssue(this, \"graphemes\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/gtValue/gtValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction gtValue(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"gt_value\",\n    reference: gtValue,\n    async: false,\n    expects: `>${requirement instanceof Date ? requirement.toJSON() : _stringify(requirement)}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !(dataset.value > this.requirement)) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/hash/hash.ts\nvar HASH_LENGTHS = {\n  md4: 32,\n  md5: 32,\n  sha1: 40,\n  sha256: 64,\n  sha384: 96,\n  sha512: 128,\n  ripemd128: 32,\n  ripemd160: 40,\n  tiger128: 32,\n  tiger160: 40,\n  tiger192: 48,\n  crc32: 8,\n  crc32b: 8,\n  adler32: 8\n};\n// @__NO_SIDE_EFFECTS__\nfunction hash(types, message2) {\n  return {\n    kind: \"validation\",\n    type: \"hash\",\n    reference: hash,\n    expects: null,\n    async: false,\n    requirement: RegExp(\n      types.map((type) => `^[a-f0-9]{${HASH_LENGTHS[type]}}$`).join(\"|\"),\n      \"iu\"\n    ),\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"hash\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/hexadecimal/hexadecimal.ts\n// @__NO_SIDE_EFFECTS__\nfunction hexadecimal(message2) {\n  return {\n    kind: \"validation\",\n    type: \"hexadecimal\",\n    reference: hexadecimal,\n    async: false,\n    expects: null,\n    requirement: HEXADECIMAL_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"hexadecimal\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/hexColor/hexColor.ts\n// @__NO_SIDE_EFFECTS__\nfunction hexColor(message2) {\n  return {\n    kind: \"validation\",\n    type: \"hex_color\",\n    reference: hexColor,\n    async: false,\n    expects: null,\n    requirement: HEX_COLOR_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"hex color\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/imei/imei.ts\n// @__NO_SIDE_EFFECTS__\nfunction imei(message2) {\n  return {\n    kind: \"validation\",\n    type: \"imei\",\n    reference: imei,\n    async: false,\n    expects: null,\n    requirement(input) {\n      return IMEI_REGEX.test(input) && _isLuhnAlgo(input);\n    },\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"IMEI\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/includes/includes.ts\n// @__NO_SIDE_EFFECTS__\nfunction includes(requirement, message2) {\n  const expects = _stringify(requirement);\n  return {\n    kind: \"validation\",\n    type: \"includes\",\n    reference: includes,\n    async: false,\n    expects,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !dataset.value.includes(this.requirement)) {\n        _addIssue(this, \"content\", dataset, config2, {\n          received: `!${expects}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/integer/integer.ts\n// @__NO_SIDE_EFFECTS__\nfunction integer(message2) {\n  return {\n    kind: \"validation\",\n    type: \"integer\",\n    reference: integer,\n    async: false,\n    expects: null,\n    requirement: Number.isInteger,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"integer\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/ip/ip.ts\n// @__NO_SIDE_EFFECTS__\nfunction ip(message2) {\n  return {\n    kind: \"validation\",\n    type: \"ip\",\n    reference: ip,\n    async: false,\n    expects: null,\n    requirement: IP_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"IP\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/ipv4/ipv4.ts\n// @__NO_SIDE_EFFECTS__\nfunction ipv4(message2) {\n  return {\n    kind: \"validation\",\n    type: \"ipv4\",\n    reference: ipv4,\n    async: false,\n    expects: null,\n    requirement: IPV4_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"IPv4\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/ipv6/ipv6.ts\n// @__NO_SIDE_EFFECTS__\nfunction ipv6(message2) {\n  return {\n    kind: \"validation\",\n    type: \"ipv6\",\n    reference: ipv6,\n    async: false,\n    expects: null,\n    requirement: IPV6_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"IPv6\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/isoDate/isoDate.ts\n// @__NO_SIDE_EFFECTS__\nfunction isoDate(message2) {\n  return {\n    kind: \"validation\",\n    type: \"iso_date\",\n    reference: isoDate,\n    async: false,\n    expects: null,\n    requirement: ISO_DATE_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"date\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/isoDateTime/isoDateTime.ts\n// @__NO_SIDE_EFFECTS__\nfunction isoDateTime(message2) {\n  return {\n    kind: \"validation\",\n    type: \"iso_date_time\",\n    reference: isoDateTime,\n    async: false,\n    expects: null,\n    requirement: ISO_DATE_TIME_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"date-time\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/isoTime/isoTime.ts\n// @__NO_SIDE_EFFECTS__\nfunction isoTime(message2) {\n  return {\n    kind: \"validation\",\n    type: \"iso_time\",\n    reference: isoTime,\n    async: false,\n    expects: null,\n    requirement: ISO_TIME_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"time\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/isoTimeSecond/isoTimeSecond.ts\n// @__NO_SIDE_EFFECTS__\nfunction isoTimeSecond(message2) {\n  return {\n    kind: \"validation\",\n    type: \"iso_time_second\",\n    reference: isoTimeSecond,\n    async: false,\n    expects: null,\n    requirement: ISO_TIME_SECOND_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"time-second\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/isoTimestamp/isoTimestamp.ts\n// @__NO_SIDE_EFFECTS__\nfunction isoTimestamp(message2) {\n  return {\n    kind: \"validation\",\n    type: \"iso_timestamp\",\n    reference: isoTimestamp,\n    async: false,\n    expects: null,\n    requirement: ISO_TIMESTAMP_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"timestamp\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/isoWeek/isoWeek.ts\n// @__NO_SIDE_EFFECTS__\nfunction isoWeek(message2) {\n  return {\n    kind: \"validation\",\n    type: \"iso_week\",\n    reference: isoWeek,\n    async: false,\n    expects: null,\n    requirement: ISO_WEEK_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"week\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/length/length.ts\n// @__NO_SIDE_EFFECTS__\nfunction length(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"length\",\n    reference: length,\n    async: false,\n    expects: `${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.length !== this.requirement) {\n        _addIssue(this, \"length\", dataset, config2, {\n          received: `${dataset.value.length}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/ltValue/ltValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction ltValue(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"lt_value\",\n    reference: ltValue,\n    async: false,\n    expects: `<${requirement instanceof Date ? requirement.toJSON() : _stringify(requirement)}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !(dataset.value < this.requirement)) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/mac/mac.ts\n// @__NO_SIDE_EFFECTS__\nfunction mac(message2) {\n  return {\n    kind: \"validation\",\n    type: \"mac\",\n    reference: mac,\n    async: false,\n    expects: null,\n    requirement: MAC_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"MAC\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/mac48/mac48.ts\n// @__NO_SIDE_EFFECTS__\nfunction mac48(message2) {\n  return {\n    kind: \"validation\",\n    type: \"mac48\",\n    reference: mac48,\n    async: false,\n    expects: null,\n    requirement: MAC48_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"48-bit MAC\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/mac64/mac64.ts\n// @__NO_SIDE_EFFECTS__\nfunction mac64(message2) {\n  return {\n    kind: \"validation\",\n    type: \"mac64\",\n    reference: mac64,\n    async: false,\n    expects: null,\n    requirement: MAC64_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"64-bit MAC\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/mapItems/mapItems.ts\n// @__NO_SIDE_EFFECTS__\nfunction mapItems(operation) {\n  return {\n    kind: \"transformation\",\n    type: \"map_items\",\n    reference: mapItems,\n    async: false,\n    operation,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.map(this.operation);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxBytes/maxBytes.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxBytes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_bytes\",\n    reference: maxBytes,\n    async: false,\n    expects: `<=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const length2 = _getByteCount(dataset.value);\n        if (length2 > this.requirement) {\n          _addIssue(this, \"bytes\", dataset, config2, {\n            received: `${length2}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxEntries/maxEntries.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxEntries(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_entries\",\n    reference: maxEntries,\n    async: false,\n    expects: `<=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (!dataset.typed) return dataset;\n      const count = Object.keys(dataset.value).length;\n      if (dataset.typed && count > this.requirement) {\n        _addIssue(this, \"entries\", dataset, config2, {\n          received: `${count}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxGraphemes/maxGraphemes.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxGraphemes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_graphemes\",\n    reference: maxGraphemes,\n    async: false,\n    expects: `<=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getGraphemeCount(dataset.value);\n        if (count > this.requirement) {\n          _addIssue(this, \"graphemes\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxLength/maxLength.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxLength(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_length\",\n    reference: maxLength,\n    async: false,\n    expects: `<=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.length > this.requirement) {\n        _addIssue(this, \"length\", dataset, config2, {\n          received: `${dataset.value.length}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxSize/maxSize.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxSize(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_size\",\n    reference: maxSize,\n    async: false,\n    expects: `<=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.size > this.requirement) {\n        _addIssue(this, \"size\", dataset, config2, {\n          received: `${dataset.value.size}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxValue/maxValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxValue(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_value\",\n    reference: maxValue,\n    async: false,\n    expects: `<=${requirement instanceof Date ? requirement.toJSON() : _stringify(requirement)}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !(dataset.value <= this.requirement)) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxWords/maxWords.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxWords(locales, requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_words\",\n    reference: maxWords,\n    async: false,\n    expects: `<=${requirement}`,\n    locales,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getWordCount(this.locales, dataset.value);\n        if (count > this.requirement) {\n          _addIssue(this, \"words\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/metadata/metadata.ts\n// @__NO_SIDE_EFFECTS__\nfunction metadata(metadata_) {\n  return {\n    kind: \"metadata\",\n    type: \"metadata\",\n    reference: metadata,\n    metadata: metadata_\n  };\n}\n\n// src/actions/mimeType/mimeType.ts\n// @__NO_SIDE_EFFECTS__\nfunction mimeType(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"mime_type\",\n    reference: mimeType,\n    async: false,\n    expects: _joinExpects(\n      requirement.map((option) => `\"${option}\"`),\n      \"|\"\n    ),\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.includes(dataset.value.type)) {\n        _addIssue(this, \"MIME type\", dataset, config2, {\n          received: `\"${dataset.value.type}\"`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minBytes/minBytes.ts\n// @__NO_SIDE_EFFECTS__\nfunction minBytes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_bytes\",\n    reference: minBytes,\n    async: false,\n    expects: `>=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const length2 = _getByteCount(dataset.value);\n        if (length2 < this.requirement) {\n          _addIssue(this, \"bytes\", dataset, config2, {\n            received: `${length2}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minEntries/minEntries.ts\n// @__NO_SIDE_EFFECTS__\nfunction minEntries(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_entries\",\n    reference: minEntries,\n    async: false,\n    expects: `>=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (!dataset.typed) return dataset;\n      const count = Object.keys(dataset.value).length;\n      if (dataset.typed && count < this.requirement) {\n        _addIssue(this, \"entries\", dataset, config2, {\n          received: `${count}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minGraphemes/minGraphemes.ts\n// @__NO_SIDE_EFFECTS__\nfunction minGraphemes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_graphemes\",\n    reference: minGraphemes,\n    async: false,\n    expects: `>=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getGraphemeCount(dataset.value);\n        if (count < this.requirement) {\n          _addIssue(this, \"graphemes\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minLength/minLength.ts\n// @__NO_SIDE_EFFECTS__\nfunction minLength(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_length\",\n    reference: minLength,\n    async: false,\n    expects: `>=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.length < this.requirement) {\n        _addIssue(this, \"length\", dataset, config2, {\n          received: `${dataset.value.length}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minSize/minSize.ts\n// @__NO_SIDE_EFFECTS__\nfunction minSize(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_size\",\n    reference: minSize,\n    async: false,\n    expects: `>=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.size < this.requirement) {\n        _addIssue(this, \"size\", dataset, config2, {\n          received: `${dataset.value.size}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minValue/minValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction minValue(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_value\",\n    reference: minValue,\n    async: false,\n    expects: `>=${requirement instanceof Date ? requirement.toJSON() : _stringify(requirement)}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !(dataset.value >= this.requirement)) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minWords/minWords.ts\n// @__NO_SIDE_EFFECTS__\nfunction minWords(locales, requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_words\",\n    reference: minWords,\n    async: false,\n    expects: `>=${requirement}`,\n    locales,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getWordCount(this.locales, dataset.value);\n        if (count < this.requirement) {\n          _addIssue(this, \"words\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/multipleOf/multipleOf.ts\n// @__NO_SIDE_EFFECTS__\nfunction multipleOf(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"multiple_of\",\n    reference: multipleOf,\n    async: false,\n    expects: `%${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value % this.requirement != 0) {\n        _addIssue(this, \"multiple\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/nanoid/nanoid.ts\n// @__NO_SIDE_EFFECTS__\nfunction nanoid(message2) {\n  return {\n    kind: \"validation\",\n    type: \"nanoid\",\n    reference: nanoid,\n    async: false,\n    expects: null,\n    requirement: NANO_ID_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"Nano ID\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/nonEmpty/nonEmpty.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonEmpty(message2) {\n  return {\n    kind: \"validation\",\n    type: \"non_empty\",\n    reference: nonEmpty,\n    async: false,\n    expects: \"!0\",\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.length === 0) {\n        _addIssue(this, \"length\", dataset, config2, {\n          received: \"0\"\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/normalize/normalize.ts\n// @__NO_SIDE_EFFECTS__\nfunction normalize(form) {\n  return {\n    kind: \"transformation\",\n    type: \"normalize\",\n    reference: normalize,\n    async: false,\n    form,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.normalize(this.form);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notBytes/notBytes.ts\n// @__NO_SIDE_EFFECTS__\nfunction notBytes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_bytes\",\n    reference: notBytes,\n    async: false,\n    expects: `!${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const length2 = _getByteCount(dataset.value);\n        if (length2 === this.requirement) {\n          _addIssue(this, \"bytes\", dataset, config2, {\n            received: `${length2}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notEntries/notEntries.ts\n// @__NO_SIDE_EFFECTS__\nfunction notEntries(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_entries\",\n    reference: notEntries,\n    async: false,\n    expects: `!${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (!dataset.typed) return dataset;\n      const count = Object.keys(dataset.value).length;\n      if (dataset.typed && count === this.requirement) {\n        _addIssue(this, \"entries\", dataset, config2, {\n          received: `${count}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notGraphemes/notGraphemes.ts\n// @__NO_SIDE_EFFECTS__\nfunction notGraphemes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_graphemes\",\n    reference: notGraphemes,\n    async: false,\n    expects: `!${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getGraphemeCount(dataset.value);\n        if (count === this.requirement) {\n          _addIssue(this, \"graphemes\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notLength/notLength.ts\n// @__NO_SIDE_EFFECTS__\nfunction notLength(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_length\",\n    reference: notLength,\n    async: false,\n    expects: `!${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.length === this.requirement) {\n        _addIssue(this, \"length\", dataset, config2, {\n          received: `${dataset.value.length}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notSize/notSize.ts\n// @__NO_SIDE_EFFECTS__\nfunction notSize(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_size\",\n    reference: notSize,\n    async: false,\n    expects: `!${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.size === this.requirement) {\n        _addIssue(this, \"size\", dataset, config2, {\n          received: `${dataset.value.size}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notValue/notValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction notValue(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_value\",\n    reference: notValue,\n    async: false,\n    expects: requirement instanceof Date ? `!${requirement.toJSON()}` : `!${_stringify(requirement)}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && this.requirement <= dataset.value && this.requirement >= dataset.value) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notValues/notValues.ts\n// @__NO_SIDE_EFFECTS__\nfunction notValues(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_values\",\n    reference: notValues,\n    async: false,\n    expects: `!${_joinExpects(\n      requirement.map(\n        (value2) => value2 instanceof Date ? value2.toJSON() : _stringify(value2)\n      ),\n      \"|\"\n    )}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && this.requirement.some(\n        (value2) => value2 <= dataset.value && value2 >= dataset.value\n      )) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notWords/notWords.ts\n// @__NO_SIDE_EFFECTS__\nfunction notWords(locales, requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_words\",\n    reference: notWords,\n    async: false,\n    expects: `!${requirement}`,\n    locales,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getWordCount(this.locales, dataset.value);\n        if (count === this.requirement) {\n          _addIssue(this, \"words\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/octal/octal.ts\n// @__NO_SIDE_EFFECTS__\nfunction octal(message2) {\n  return {\n    kind: \"validation\",\n    type: \"octal\",\n    reference: octal,\n    async: false,\n    expects: null,\n    requirement: OCTAL_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"octal\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/parseJson/parseJson.ts\n// @__NO_SIDE_EFFECTS__\nfunction parseJson(config2, message2) {\n  return {\n    kind: \"transformation\",\n    type: \"parse_json\",\n    reference: parseJson,\n    config: config2,\n    message: message2,\n    async: false,\n    \"~run\"(dataset, config3) {\n      try {\n        dataset.value = JSON.parse(dataset.value, this.config?.reviver);\n      } catch (error) {\n        if (error instanceof Error) {\n          _addIssue(this, \"JSON\", dataset, config3, {\n            received: `\"${error.message}\"`\n          });\n          dataset.typed = false;\n        } else {\n          throw error;\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/partialCheck/utils/_isPartiallyTyped/_isPartiallyTyped.ts\n// @__NO_SIDE_EFFECTS__\nfunction _isPartiallyTyped(dataset, paths) {\n  if (dataset.issues) {\n    for (const path of paths) {\n      for (const issue of dataset.issues) {\n        let typed = false;\n        const bound = Math.min(path.length, issue.path?.length ?? 0);\n        for (let index = 0; index < bound; index++) {\n          if (\n            // @ts-expect-error\n            path[index] !== issue.path[index].key && // @ts-expect-error\n            (path[index] !== \"$\" || issue.path[index].type !== \"array\")\n          ) {\n            typed = true;\n            break;\n          }\n        }\n        if (!typed) {\n          return false;\n        }\n      }\n    }\n  }\n  return true;\n}\n\n// src/actions/partialCheck/partialCheck.ts\n// @__NO_SIDE_EFFECTS__\nfunction partialCheck(paths, requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"partial_check\",\n    reference: partialCheck,\n    async: false,\n    expects: null,\n    paths,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if ((dataset.typed || _isPartiallyTyped(dataset, paths)) && // @ts-expect-error\n      !this.requirement(dataset.value)) {\n        _addIssue(this, \"input\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/partialCheck/partialCheckAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction partialCheckAsync(paths, requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"partial_check\",\n    reference: partialCheckAsync,\n    async: true,\n    expects: null,\n    paths,\n    requirement,\n    message: message2,\n    async \"~run\"(dataset, config2) {\n      if ((dataset.typed || _isPartiallyTyped(dataset, paths)) && // @ts-expect-error\n      !await this.requirement(dataset.value)) {\n        _addIssue(this, \"input\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/rawCheck/rawCheck.ts\n// @__NO_SIDE_EFFECTS__\nfunction rawCheck(action) {\n  return {\n    kind: \"validation\",\n    type: \"raw_check\",\n    reference: rawCheck,\n    async: false,\n    expects: null,\n    \"~run\"(dataset, config2) {\n      action({\n        dataset,\n        config: config2,\n        addIssue: (info) => _addIssue(this, info?.label ?? \"input\", dataset, config2, info)\n      });\n      return dataset;\n    }\n  };\n}\n\n// src/actions/rawCheck/rawCheckAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction rawCheckAsync(action) {\n  return {\n    kind: \"validation\",\n    type: \"raw_check\",\n    reference: rawCheckAsync,\n    async: true,\n    expects: null,\n    async \"~run\"(dataset, config2) {\n      await action({\n        dataset,\n        config: config2,\n        addIssue: (info) => _addIssue(this, info?.label ?? \"input\", dataset, config2, info)\n      });\n      return dataset;\n    }\n  };\n}\n\n// src/actions/rawTransform/rawTransform.ts\n// @__NO_SIDE_EFFECTS__\nfunction rawTransform(action) {\n  return {\n    kind: \"transformation\",\n    type: \"raw_transform\",\n    reference: rawTransform,\n    async: false,\n    \"~run\"(dataset, config2) {\n      const output = action({\n        dataset,\n        config: config2,\n        addIssue: (info) => _addIssue(this, info?.label ?? \"input\", dataset, config2, info),\n        NEVER: null\n      });\n      if (dataset.issues) {\n        dataset.typed = false;\n      } else {\n        dataset.value = output;\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/rawTransform/rawTransformAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction rawTransformAsync(action) {\n  return {\n    kind: \"transformation\",\n    type: \"raw_transform\",\n    reference: rawTransformAsync,\n    async: true,\n    async \"~run\"(dataset, config2) {\n      const output = await action({\n        dataset,\n        config: config2,\n        addIssue: (info) => _addIssue(this, info?.label ?? \"input\", dataset, config2, info),\n        NEVER: null\n      });\n      if (dataset.issues) {\n        dataset.typed = false;\n      } else {\n        dataset.value = output;\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/readonly/readonly.ts\n// @__NO_SIDE_EFFECTS__\nfunction readonly() {\n  return {\n    kind: \"transformation\",\n    type: \"readonly\",\n    reference: readonly,\n    async: false,\n    \"~run\"(dataset) {\n      return dataset;\n    }\n  };\n}\n\n// src/actions/reduceItems/reduceItems.ts\n// @__NO_SIDE_EFFECTS__\nfunction reduceItems(operation, initial) {\n  return {\n    kind: \"transformation\",\n    type: \"reduce_items\",\n    reference: reduceItems,\n    async: false,\n    operation,\n    initial,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.reduce(this.operation, this.initial);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/regex/regex.ts\n// @__NO_SIDE_EFFECTS__\nfunction regex(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"regex\",\n    reference: regex,\n    async: false,\n    expects: `${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"format\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/returns/returns.ts\n// @__NO_SIDE_EFFECTS__\nfunction returns(schema) {\n  return {\n    kind: \"transformation\",\n    type: \"returns\",\n    reference: returns,\n    async: false,\n    schema,\n    \"~run\"(dataset, config2) {\n      const func = dataset.value;\n      dataset.value = (...args_) => {\n        const returnsDataset = this.schema[\"~run\"](\n          { value: func(...args_) },\n          config2\n        );\n        if (returnsDataset.issues) {\n          throw new ValiError(returnsDataset.issues);\n        }\n        return returnsDataset.value;\n      };\n      return dataset;\n    }\n  };\n}\n\n// src/actions/returns/returnsAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction returnsAsync(schema) {\n  return {\n    kind: \"transformation\",\n    type: \"returns\",\n    reference: returnsAsync,\n    async: false,\n    schema,\n    \"~run\"(dataset, config2) {\n      const func = dataset.value;\n      dataset.value = async (...args_) => {\n        const returnsDataset = await this.schema[\"~run\"](\n          { value: await func(...args_) },\n          config2\n        );\n        if (returnsDataset.issues) {\n          throw new ValiError(returnsDataset.issues);\n        }\n        return returnsDataset.value;\n      };\n      return dataset;\n    }\n  };\n}\n\n// src/actions/rfcEmail/rfcEmail.ts\n// @__NO_SIDE_EFFECTS__\nfunction rfcEmail(message2) {\n  return {\n    kind: \"validation\",\n    type: \"rfc_email\",\n    reference: rfcEmail,\n    expects: null,\n    async: false,\n    requirement: RFC_EMAIL_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"email\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/safeInteger/safeInteger.ts\n// @__NO_SIDE_EFFECTS__\nfunction safeInteger(message2) {\n  return {\n    kind: \"validation\",\n    type: \"safe_integer\",\n    reference: safeInteger,\n    async: false,\n    expects: null,\n    requirement: Number.isSafeInteger,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"safe integer\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/size/size.ts\n// @__NO_SIDE_EFFECTS__\nfunction size(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"size\",\n    reference: size,\n    async: false,\n    expects: `${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.size !== this.requirement) {\n        _addIssue(this, \"size\", dataset, config2, {\n          received: `${dataset.value.size}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/slug/slug.ts\n// @__NO_SIDE_EFFECTS__\nfunction slug(message2) {\n  return {\n    kind: \"validation\",\n    type: \"slug\",\n    reference: slug,\n    async: false,\n    expects: null,\n    requirement: SLUG_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"slug\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/someItem/someItem.ts\n// @__NO_SIDE_EFFECTS__\nfunction someItem(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"some_item\",\n    reference: someItem,\n    async: false,\n    expects: null,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !dataset.value.some(this.requirement)) {\n        _addIssue(this, \"item\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/sortItems/sortItems.ts\n// @__NO_SIDE_EFFECTS__\nfunction sortItems(operation) {\n  return {\n    kind: \"transformation\",\n    type: \"sort_items\",\n    reference: sortItems,\n    async: false,\n    operation,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.sort(this.operation);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/startsWith/startsWith.ts\n// @__NO_SIDE_EFFECTS__\nfunction startsWith(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"starts_with\",\n    reference: startsWith,\n    async: false,\n    expects: `\"${requirement}\"`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !dataset.value.startsWith(this.requirement)) {\n        _addIssue(this, \"start\", dataset, config2, {\n          received: `\"${dataset.value.slice(0, this.requirement.length)}\"`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/stringifyJson/stringifyJson.ts\n// @__NO_SIDE_EFFECTS__\nfunction stringifyJson(config2, message2) {\n  return {\n    kind: \"transformation\",\n    type: \"stringify_json\",\n    reference: stringifyJson,\n    message: message2,\n    config: config2,\n    async: false,\n    \"~run\"(dataset, config3) {\n      try {\n        const output = JSON.stringify(\n          dataset.value,\n          // @ts-expect-error\n          this.config?.replacer,\n          this.config?.space\n        );\n        if (output === void 0) {\n          _addIssue(this, \"JSON\", dataset, config3);\n          dataset.typed = false;\n        }\n        dataset.value = output;\n      } catch (error) {\n        if (error instanceof Error) {\n          _addIssue(this, \"JSON\", dataset, config3, {\n            received: `\"${error.message}\"`\n          });\n          dataset.typed = false;\n        } else {\n          throw error;\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/title/title.ts\n// @__NO_SIDE_EFFECTS__\nfunction title(title_) {\n  return {\n    kind: \"metadata\",\n    type: \"title\",\n    reference: title,\n    title: title_\n  };\n}\n\n// src/actions/toLowerCase/toLowerCase.ts\n// @__NO_SIDE_EFFECTS__\nfunction toLowerCase() {\n  return {\n    kind: \"transformation\",\n    type: \"to_lower_case\",\n    reference: toLowerCase,\n    async: false,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.toLowerCase();\n      return dataset;\n    }\n  };\n}\n\n// src/actions/toMaxValue/toMaxValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction toMaxValue(requirement) {\n  return {\n    kind: \"transformation\",\n    type: \"to_max_value\",\n    reference: toMaxValue,\n    async: false,\n    requirement,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value > this.requirement ? this.requirement : dataset.value;\n      return dataset;\n    }\n  };\n}\n\n// src/actions/toMinValue/toMinValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction toMinValue(requirement) {\n  return {\n    kind: \"transformation\",\n    type: \"to_min_value\",\n    reference: toMinValue,\n    async: false,\n    requirement,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value < this.requirement ? this.requirement : dataset.value;\n      return dataset;\n    }\n  };\n}\n\n// src/actions/toUpperCase/toUpperCase.ts\n// @__NO_SIDE_EFFECTS__\nfunction toUpperCase() {\n  return {\n    kind: \"transformation\",\n    type: \"to_upper_case\",\n    reference: toUpperCase,\n    async: false,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.toUpperCase();\n      return dataset;\n    }\n  };\n}\n\n// src/actions/transform/transform.ts\n// @__NO_SIDE_EFFECTS__\nfunction transform(operation) {\n  return {\n    kind: \"transformation\",\n    type: \"transform\",\n    reference: transform,\n    async: false,\n    operation,\n    \"~run\"(dataset) {\n      dataset.value = this.operation(dataset.value);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/transform/transformAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction transformAsync(operation) {\n  return {\n    kind: \"transformation\",\n    type: \"transform\",\n    reference: transformAsync,\n    async: true,\n    operation,\n    async \"~run\"(dataset) {\n      dataset.value = await this.operation(dataset.value);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/trim/trim.ts\n// @__NO_SIDE_EFFECTS__\nfunction trim() {\n  return {\n    kind: \"transformation\",\n    type: \"trim\",\n    reference: trim,\n    async: false,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.trim();\n      return dataset;\n    }\n  };\n}\n\n// src/actions/trimEnd/trimEnd.ts\n// @__NO_SIDE_EFFECTS__\nfunction trimEnd() {\n  return {\n    kind: \"transformation\",\n    type: \"trim_end\",\n    reference: trimEnd,\n    async: false,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.trimEnd();\n      return dataset;\n    }\n  };\n}\n\n// src/actions/trimStart/trimStart.ts\n// @__NO_SIDE_EFFECTS__\nfunction trimStart() {\n  return {\n    kind: \"transformation\",\n    type: \"trim_start\",\n    reference: trimStart,\n    async: false,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.trimStart();\n      return dataset;\n    }\n  };\n}\n\n// src/actions/ulid/ulid.ts\n// @__NO_SIDE_EFFECTS__\nfunction ulid(message2) {\n  return {\n    kind: \"validation\",\n    type: \"ulid\",\n    reference: ulid,\n    async: false,\n    expects: null,\n    requirement: ULID_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"ULID\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/url/url.ts\n// @__NO_SIDE_EFFECTS__\nfunction url(message2) {\n  return {\n    kind: \"validation\",\n    type: \"url\",\n    reference: url,\n    async: false,\n    expects: null,\n    requirement(input) {\n      try {\n        new URL(input);\n        return true;\n      } catch {\n        return false;\n      }\n    },\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"URL\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/uuid/uuid.ts\n// @__NO_SIDE_EFFECTS__\nfunction uuid(message2) {\n  return {\n    kind: \"validation\",\n    type: \"uuid\",\n    reference: uuid,\n    async: false,\n    expects: null,\n    requirement: UUID_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"UUID\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/value/value.ts\n// @__NO_SIDE_EFFECTS__\nfunction value(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"value\",\n    reference: value,\n    async: false,\n    expects: requirement instanceof Date ? requirement.toJSON() : _stringify(requirement),\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !(this.requirement <= dataset.value && this.requirement >= dataset.value)) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/values/values.ts\n// @__NO_SIDE_EFFECTS__\nfunction values(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"values\",\n    reference: values,\n    async: false,\n    expects: `${_joinExpects(\n      requirement.map(\n        (value2) => value2 instanceof Date ? value2.toJSON() : _stringify(value2)\n      ),\n      \"|\"\n    )}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.some(\n        (value2) => value2 <= dataset.value && value2 >= dataset.value\n      )) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/words/words.ts\n// @__NO_SIDE_EFFECTS__\nfunction words(locales, requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"words\",\n    reference: words,\n    async: false,\n    expects: `${requirement}`,\n    locales,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getWordCount(this.locales, dataset.value);\n        if (count !== this.requirement) {\n          _addIssue(this, \"words\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/methods/assert/assert.ts\nfunction assert(schema, input) {\n  const issues = schema[\"~run\"]({ value: input }, { abortEarly: true }).issues;\n  if (issues) {\n    throw new ValiError(issues);\n  }\n}\n\n// src/methods/config/config.ts\n// @__NO_SIDE_EFFECTS__\nfunction config(schema, config2) {\n  return {\n    ...schema,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config_) {\n      return schema[\"~run\"](dataset, { ...config_, ...config2 });\n    }\n  };\n}\n\n// src/methods/getFallback/getFallback.ts\n// @__NO_SIDE_EFFECTS__\nfunction getFallback(schema, dataset, config2) {\n  return typeof schema.fallback === \"function\" ? (\n    // @ts-expect-error\n    schema.fallback(dataset, config2)\n  ) : (\n    // @ts-expect-error\n    schema.fallback\n  );\n}\n\n// src/methods/fallback/fallback.ts\n// @__NO_SIDE_EFFECTS__\nfunction fallback(schema, fallback2) {\n  return {\n    ...schema,\n    fallback: fallback2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const outputDataset = schema[\"~run\"](dataset, config2);\n      return outputDataset.issues ? { typed: true, value: getFallback(this, outputDataset, config2) } : outputDataset;\n    }\n  };\n}\n\n// src/methods/fallback/fallbackAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction fallbackAsync(schema, fallback2) {\n  return {\n    ...schema,\n    fallback: fallback2,\n    async: true,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const outputDataset = await schema[\"~run\"](dataset, config2);\n      return outputDataset.issues ? {\n        typed: true,\n        value: await getFallback(this, outputDataset, config2)\n      } : outputDataset;\n    }\n  };\n}\n\n// src/methods/flatten/flatten.ts\n// @__NO_SIDE_EFFECTS__\nfunction flatten(issues) {\n  const flatErrors = {};\n  for (const issue of issues) {\n    if (issue.path) {\n      const dotPath = getDotPath(issue);\n      if (dotPath) {\n        if (!flatErrors.nested) {\n          flatErrors.nested = {};\n        }\n        if (flatErrors.nested[dotPath]) {\n          flatErrors.nested[dotPath].push(issue.message);\n        } else {\n          flatErrors.nested[dotPath] = [issue.message];\n        }\n      } else {\n        if (flatErrors.other) {\n          flatErrors.other.push(issue.message);\n        } else {\n          flatErrors.other = [issue.message];\n        }\n      }\n    } else {\n      if (flatErrors.root) {\n        flatErrors.root.push(issue.message);\n      } else {\n        flatErrors.root = [issue.message];\n      }\n    }\n  }\n  return flatErrors;\n}\n\n// src/methods/forward/forward.ts\n// @__NO_SIDE_EFFECTS__\nfunction forward(action, path) {\n  return {\n    ...action,\n    \"~run\"(dataset, config2) {\n      const prevIssues = dataset.issues && [...dataset.issues];\n      dataset = action[\"~run\"](dataset, config2);\n      if (dataset.issues) {\n        for (const issue of dataset.issues) {\n          if (!prevIssues?.includes(issue)) {\n            let pathInput = dataset.value;\n            for (const key of path) {\n              const pathValue = pathInput[key];\n              const pathItem = {\n                type: \"unknown\",\n                origin: \"value\",\n                input: pathInput,\n                key,\n                value: pathValue\n              };\n              if (issue.path) {\n                issue.path.push(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              if (!pathValue) {\n                break;\n              }\n              pathInput = pathValue;\n            }\n          }\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/methods/forward/forwardAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction forwardAsync(action, path) {\n  return {\n    ...action,\n    async: true,\n    async \"~run\"(dataset, config2) {\n      const prevIssues = dataset.issues && [...dataset.issues];\n      dataset = await action[\"~run\"](dataset, config2);\n      if (dataset.issues) {\n        for (const issue of dataset.issues) {\n          if (!prevIssues?.includes(issue)) {\n            let pathInput = dataset.value;\n            for (const key of path) {\n              const pathValue = pathInput[key];\n              const pathItem = {\n                type: \"unknown\",\n                origin: \"value\",\n                input: pathInput,\n                key,\n                value: pathValue\n              };\n              if (issue.path) {\n                issue.path.push(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              if (!pathValue) {\n                break;\n              }\n              pathInput = pathValue;\n            }\n          }\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/methods/getDefault/getDefault.ts\n// @__NO_SIDE_EFFECTS__\nfunction getDefault(schema, dataset, config2) {\n  return typeof schema.default === \"function\" ? (\n    // @ts-expect-error\n    schema.default(dataset, config2)\n  ) : (\n    // @ts-expect-error\n    schema.default\n  );\n}\n\n// src/methods/getDefaults/getDefaults.ts\n// @__NO_SIDE_EFFECTS__\nfunction getDefaults(schema) {\n  if (\"entries\" in schema) {\n    const object2 = {};\n    for (const key in schema.entries) {\n      object2[key] = /* @__PURE__ */ getDefaults(schema.entries[key]);\n    }\n    return object2;\n  }\n  if (\"items\" in schema) {\n    return schema.items.map(getDefaults);\n  }\n  return getDefault(schema);\n}\n\n// src/methods/getDefaults/getDefaultsAsync.ts\n// @__NO_SIDE_EFFECTS__\nasync function getDefaultsAsync(schema) {\n  if (\"entries\" in schema) {\n    return Object.fromEntries(\n      await Promise.all(\n        Object.entries(schema.entries).map(async ([key, value2]) => [\n          key,\n          await /* @__PURE__ */ getDefaultsAsync(value2)\n        ])\n      )\n    );\n  }\n  if (\"items\" in schema) {\n    return Promise.all(schema.items.map(getDefaultsAsync));\n  }\n  return getDefault(schema);\n}\n\n// src/methods/getDescription/getDescription.ts\n// @__NO_SIDE_EFFECTS__\nfunction getDescription(schema) {\n  return _getLastMetadata(schema, \"description\");\n}\n\n// src/methods/getFallbacks/getFallbacks.ts\n// @__NO_SIDE_EFFECTS__\nfunction getFallbacks(schema) {\n  if (\"entries\" in schema) {\n    const object2 = {};\n    for (const key in schema.entries) {\n      object2[key] = /* @__PURE__ */ getFallbacks(schema.entries[key]);\n    }\n    return object2;\n  }\n  if (\"items\" in schema) {\n    return schema.items.map(getFallbacks);\n  }\n  return getFallback(schema);\n}\n\n// src/methods/getFallbacks/getFallbacksAsync.ts\n// @__NO_SIDE_EFFECTS__\nasync function getFallbacksAsync(schema) {\n  if (\"entries\" in schema) {\n    return Object.fromEntries(\n      await Promise.all(\n        Object.entries(schema.entries).map(async ([key, value2]) => [\n          key,\n          await /* @__PURE__ */ getFallbacksAsync(value2)\n        ])\n      )\n    );\n  }\n  if (\"items\" in schema) {\n    return Promise.all(schema.items.map(getFallbacksAsync));\n  }\n  return getFallback(schema);\n}\n\n// src/methods/getMetadata/getMetadata.ts\n// @__NO_SIDE_EFFECTS__\nfunction getMetadata(schema) {\n  const result = {};\n  function depthFirstMerge(schema2) {\n    if (\"pipe\" in schema2) {\n      for (const item of schema2.pipe) {\n        if (item.kind === \"schema\" && \"pipe\" in item) {\n          depthFirstMerge(item);\n        } else if (item.kind === \"metadata\" && item.type === \"metadata\") {\n          Object.assign(result, item.metadata);\n        }\n      }\n    }\n  }\n  depthFirstMerge(schema);\n  return result;\n}\n\n// src/methods/getTitle/getTitle.ts\n// @__NO_SIDE_EFFECTS__\nfunction getTitle(schema) {\n  return _getLastMetadata(schema, \"title\");\n}\n\n// src/methods/is/is.ts\n// @__NO_SIDE_EFFECTS__\nfunction is(schema, input) {\n  return !schema[\"~run\"]({ value: input }, { abortEarly: true }).issues;\n}\n\n// src/schemas/any/any.ts\n// @__NO_SIDE_EFFECTS__\nfunction any() {\n  return {\n    kind: \"schema\",\n    type: \"any\",\n    reference: any,\n    expects: \"any\",\n    async: false,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset) {\n      dataset.typed = true;\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/array/array.ts\n// @__NO_SIDE_EFFECTS__\nfunction array(item, message2) {\n  return {\n    kind: \"schema\",\n    type: \"array\",\n    reference: array,\n    expects: \"Array\",\n    async: false,\n    item,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        for (let key = 0; key < input.length; key++) {\n          const value2 = input[key];\n          const itemDataset = this.item[\"~run\"]({ value: value2 }, config2);\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/array/arrayAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction arrayAsync(item, message2) {\n  return {\n    kind: \"schema\",\n    type: \"array\",\n    reference: arrayAsync,\n    expects: \"Array\",\n    async: true,\n    item,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        const itemDatasets = await Promise.all(\n          input.map((value2) => this.item[\"~run\"]({ value: value2 }, config2))\n        );\n        for (let key = 0; key < itemDatasets.length; key++) {\n          const itemDataset = itemDatasets[key];\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: input[key]\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/bigint/bigint.ts\n// @__NO_SIDE_EFFECTS__\nfunction bigint(message2) {\n  return {\n    kind: \"schema\",\n    type: \"bigint\",\n    reference: bigint,\n    expects: \"bigint\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (typeof dataset.value === \"bigint\") {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/blob/blob.ts\n// @__NO_SIDE_EFFECTS__\nfunction blob(message2) {\n  return {\n    kind: \"schema\",\n    type: \"blob\",\n    reference: blob,\n    expects: \"Blob\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value instanceof Blob) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/boolean/boolean.ts\n// @__NO_SIDE_EFFECTS__\nfunction boolean(message2) {\n  return {\n    kind: \"schema\",\n    type: \"boolean\",\n    reference: boolean,\n    expects: \"boolean\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (typeof dataset.value === \"boolean\") {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/custom/custom.ts\n// @__NO_SIDE_EFFECTS__\nfunction custom(check2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"custom\",\n    reference: custom,\n    expects: \"unknown\",\n    async: false,\n    check: check2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (this.check(dataset.value)) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/custom/customAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction customAsync(check2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"custom\",\n    reference: customAsync,\n    expects: \"unknown\",\n    async: true,\n    check: check2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (await this.check(dataset.value)) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/date/date.ts\n// @__NO_SIDE_EFFECTS__\nfunction date(message2) {\n  return {\n    kind: \"schema\",\n    type: \"date\",\n    reference: date,\n    expects: \"Date\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value instanceof Date) {\n        if (!isNaN(dataset.value)) {\n          dataset.typed = true;\n        } else {\n          _addIssue(this, \"type\", dataset, config2, {\n            received: '\"Invalid Date\"'\n          });\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/enum/enum.ts\n// @__NO_SIDE_EFFECTS__\nfunction enum_(enum__, message2) {\n  const options = [];\n  for (const key in enum__) {\n    if (`${+key}` !== key || typeof enum__[key] !== \"string\" || !Object.is(enum__[enum__[key]], +key)) {\n      options.push(enum__[key]);\n    }\n  }\n  return {\n    kind: \"schema\",\n    type: \"enum\",\n    reference: enum_,\n    expects: _joinExpects(options.map(_stringify), \"|\"),\n    async: false,\n    enum: enum__,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (this.options.includes(dataset.value)) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/exactOptional/exactOptional.ts\n// @__NO_SIDE_EFFECTS__\nfunction exactOptional(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"exact_optional\",\n    reference: exactOptional,\n    expects: wrapped.expects,\n    async: false,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/exactOptional/exactOptionalAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction exactOptionalAsync(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"exact_optional\",\n    reference: exactOptionalAsync,\n    expects: wrapped.expects,\n    async: true,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/file/file.ts\n// @__NO_SIDE_EFFECTS__\nfunction file(message2) {\n  return {\n    kind: \"schema\",\n    type: \"file\",\n    reference: file,\n    expects: \"File\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value instanceof File) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/function/function.ts\n// @__NO_SIDE_EFFECTS__\nfunction function_(message2) {\n  return {\n    kind: \"schema\",\n    type: \"function\",\n    reference: function_,\n    expects: \"Function\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (typeof dataset.value === \"function\") {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/instance/instance.ts\n// @__NO_SIDE_EFFECTS__\nfunction instance(class_, message2) {\n  return {\n    kind: \"schema\",\n    type: \"instance\",\n    reference: instance,\n    expects: class_.name,\n    async: false,\n    class: class_,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value instanceof this.class) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/intersect/utils/_merge/_merge.ts\n// @__NO_SIDE_EFFECTS__\nfunction _merge(value1, value2) {\n  if (typeof value1 === typeof value2) {\n    if (value1 === value2 || value1 instanceof Date && value2 instanceof Date && +value1 === +value2) {\n      return { value: value1 };\n    }\n    if (value1 && value2 && value1.constructor === Object && value2.constructor === Object) {\n      for (const key in value2) {\n        if (key in value1) {\n          const dataset = /* @__PURE__ */ _merge(value1[key], value2[key]);\n          if (dataset.issue) {\n            return dataset;\n          }\n          value1[key] = dataset.value;\n        } else {\n          value1[key] = value2[key];\n        }\n      }\n      return { value: value1 };\n    }\n    if (Array.isArray(value1) && Array.isArray(value2)) {\n      if (value1.length === value2.length) {\n        for (let index = 0; index < value1.length; index++) {\n          const dataset = /* @__PURE__ */ _merge(value1[index], value2[index]);\n          if (dataset.issue) {\n            return dataset;\n          }\n          value1[index] = dataset.value;\n        }\n        return { value: value1 };\n      }\n    }\n  }\n  return { issue: true };\n}\n\n// src/schemas/intersect/intersect.ts\n// @__NO_SIDE_EFFECTS__\nfunction intersect(options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"intersect\",\n    reference: intersect,\n    expects: _joinExpects(\n      options.map((option) => option.expects),\n      \"&\"\n    ),\n    async: false,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (this.options.length) {\n        const input = dataset.value;\n        let outputs;\n        dataset.typed = true;\n        for (const schema of this.options) {\n          const optionDataset = schema[\"~run\"]({ value: input }, config2);\n          if (optionDataset.issues) {\n            if (dataset.issues) {\n              dataset.issues.push(...optionDataset.issues);\n            } else {\n              dataset.issues = optionDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!optionDataset.typed) {\n            dataset.typed = false;\n          }\n          if (dataset.typed) {\n            if (outputs) {\n              outputs.push(optionDataset.value);\n            } else {\n              outputs = [optionDataset.value];\n            }\n          }\n        }\n        if (dataset.typed) {\n          dataset.value = outputs[0];\n          for (let index = 1; index < outputs.length; index++) {\n            const mergeDataset = _merge(dataset.value, outputs[index]);\n            if (mergeDataset.issue) {\n              _addIssue(this, \"type\", dataset, config2, {\n                received: \"unknown\"\n              });\n              break;\n            }\n            dataset.value = mergeDataset.value;\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/intersect/intersectAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction intersectAsync(options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"intersect\",\n    reference: intersectAsync,\n    expects: _joinExpects(\n      options.map((option) => option.expects),\n      \"&\"\n    ),\n    async: true,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (this.options.length) {\n        const input = dataset.value;\n        let outputs;\n        dataset.typed = true;\n        const optionDatasets = await Promise.all(\n          this.options.map((schema) => schema[\"~run\"]({ value: input }, config2))\n        );\n        for (const optionDataset of optionDatasets) {\n          if (optionDataset.issues) {\n            if (dataset.issues) {\n              dataset.issues.push(...optionDataset.issues);\n            } else {\n              dataset.issues = optionDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!optionDataset.typed) {\n            dataset.typed = false;\n          }\n          if (dataset.typed) {\n            if (outputs) {\n              outputs.push(optionDataset.value);\n            } else {\n              outputs = [optionDataset.value];\n            }\n          }\n        }\n        if (dataset.typed) {\n          dataset.value = outputs[0];\n          for (let index = 1; index < outputs.length; index++) {\n            const mergeDataset = _merge(dataset.value, outputs[index]);\n            if (mergeDataset.issue) {\n              _addIssue(this, \"type\", dataset, config2, {\n                received: \"unknown\"\n              });\n              break;\n            }\n            dataset.value = mergeDataset.value;\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/lazy/lazy.ts\n// @__NO_SIDE_EFFECTS__\nfunction lazy(getter) {\n  return {\n    kind: \"schema\",\n    type: \"lazy\",\n    reference: lazy,\n    expects: \"unknown\",\n    async: false,\n    getter,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      return this.getter(dataset.value)[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/lazy/lazyAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction lazyAsync(getter) {\n  return {\n    kind: \"schema\",\n    type: \"lazy\",\n    reference: lazyAsync,\n    expects: \"unknown\",\n    async: true,\n    getter,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      return (await this.getter(dataset.value))[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/literal/literal.ts\n// @__NO_SIDE_EFFECTS__\nfunction literal(literal_, message2) {\n  return {\n    kind: \"schema\",\n    type: \"literal\",\n    reference: literal,\n    expects: _stringify(literal_),\n    async: false,\n    literal: literal_,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === this.literal) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/looseObject/looseObject.ts\n// @__NO_SIDE_EFFECTS__\nfunction looseObject(entries2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"loose_object\",\n    reference: looseObject,\n    expects: \"Object\",\n    async: false,\n    entries: entries2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        for (const key in this.entries) {\n          const valueSchema = this.entries[key];\n          if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n          valueSchema.default !== void 0) {\n            const value2 = key in input ? (\n              // @ts-expect-error\n              input[key]\n            ) : getDefault(valueSchema);\n            const valueDataset = valueSchema[\"~run\"]({ value: value2 }, config2);\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  // @ts-expect-error\n                  value: input[key]\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const key in input) {\n            if (_isValidObjectKey(input, key) && !(key in this.entries)) {\n              dataset.value[key] = input[key];\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/looseObject/looseObjectAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction looseObjectAsync(entries2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"loose_object\",\n    reference: looseObjectAsync,\n    expects: \"Object\",\n    async: true,\n    entries: entries2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        const valueDatasets = await Promise.all(\n          Object.entries(this.entries).map(async ([key, valueSchema]) => {\n            if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n            valueSchema.default !== void 0) {\n              const value2 = key in input ? (\n                // @ts-expect-error\n                input[key]\n              ) : await getDefault(valueSchema);\n              return [\n                key,\n                value2,\n                valueSchema,\n                await valueSchema[\"~run\"]({ value: value2 }, config2)\n              ];\n            }\n            return [\n              key,\n              // @ts-expect-error\n              input[key],\n              valueSchema,\n              null\n            ];\n          })\n        );\n        for (const [key, value2, valueSchema, valueDataset] of valueDatasets) {\n          if (valueDataset) {\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = await getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  value: value2\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const key in input) {\n            if (_isValidObjectKey(input, key) && !(key in this.entries)) {\n              dataset.value[key] = input[key];\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/looseTuple/looseTuple.ts\n// @__NO_SIDE_EFFECTS__\nfunction looseTuple(items, message2) {\n  return {\n    kind: \"schema\",\n    type: \"loose_tuple\",\n    reference: looseTuple,\n    expects: \"Array\",\n    async: false,\n    items,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        for (let key = 0; key < this.items.length; key++) {\n          const value2 = input[key];\n          const itemDataset = this.items[key][\"~run\"]({ value: value2 }, config2);\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (let key = this.items.length; key < input.length; key++) {\n            dataset.value.push(input[key]);\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/looseTuple/looseTupleAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction looseTupleAsync(items, message2) {\n  return {\n    kind: \"schema\",\n    type: \"loose_tuple\",\n    reference: looseTupleAsync,\n    expects: \"Array\",\n    async: true,\n    items,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        const itemDatasets = await Promise.all(\n          this.items.map(async (item, key) => {\n            const value2 = input[key];\n            return [key, value2, await item[\"~run\"]({ value: value2 }, config2)];\n          })\n        );\n        for (const [key, value2, itemDataset] of itemDatasets) {\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (let key = this.items.length; key < input.length; key++) {\n            dataset.value.push(input[key]);\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/map/map.ts\n// @__NO_SIDE_EFFECTS__\nfunction map(key, value2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"map\",\n    reference: map,\n    expects: \"Map\",\n    async: false,\n    key,\n    value: value2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input instanceof Map) {\n        dataset.typed = true;\n        dataset.value = /* @__PURE__ */ new Map();\n        for (const [inputKey, inputValue] of input) {\n          const keyDataset = this.key[\"~run\"]({ value: inputKey }, config2);\n          if (keyDataset.issues) {\n            const pathItem = {\n              type: \"map\",\n              origin: \"key\",\n              input,\n              key: inputKey,\n              value: inputValue\n            };\n            for (const issue of keyDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = keyDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          const valueDataset = this.value[\"~run\"](\n            { value: inputValue },\n            config2\n          );\n          if (valueDataset.issues) {\n            const pathItem = {\n              type: \"map\",\n              origin: \"value\",\n              input,\n              key: inputKey,\n              value: inputValue\n            };\n            for (const issue of valueDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = valueDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!keyDataset.typed || !valueDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.set(keyDataset.value, valueDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/map/mapAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction mapAsync(key, value2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"map\",\n    reference: mapAsync,\n    expects: \"Map\",\n    async: true,\n    key,\n    value: value2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input instanceof Map) {\n        dataset.typed = true;\n        dataset.value = /* @__PURE__ */ new Map();\n        const datasets = await Promise.all(\n          [...input].map(\n            ([inputKey, inputValue]) => Promise.all([\n              inputKey,\n              inputValue,\n              this.key[\"~run\"]({ value: inputKey }, config2),\n              this.value[\"~run\"]({ value: inputValue }, config2)\n            ])\n          )\n        );\n        for (const [\n          inputKey,\n          inputValue,\n          keyDataset,\n          valueDataset\n        ] of datasets) {\n          if (keyDataset.issues) {\n            const pathItem = {\n              type: \"map\",\n              origin: \"key\",\n              input,\n              key: inputKey,\n              value: inputValue\n            };\n            for (const issue of keyDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = keyDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (valueDataset.issues) {\n            const pathItem = {\n              type: \"map\",\n              origin: \"value\",\n              input,\n              key: inputKey,\n              value: inputValue\n            };\n            for (const issue of valueDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = valueDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!keyDataset.typed || !valueDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.set(keyDataset.value, valueDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nan/nan.ts\n// @__NO_SIDE_EFFECTS__\nfunction nan(message2) {\n  return {\n    kind: \"schema\",\n    type: \"nan\",\n    reference: nan,\n    expects: \"NaN\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (Number.isNaN(dataset.value)) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/never/never.ts\n// @__NO_SIDE_EFFECTS__\nfunction never(message2) {\n  return {\n    kind: \"schema\",\n    type: \"never\",\n    reference: never,\n    expects: \"never\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      _addIssue(this, \"type\", dataset, config2);\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nonNullable/nonNullable.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonNullable(wrapped, message2) {\n  return {\n    kind: \"schema\",\n    type: \"non_nullable\",\n    reference: nonNullable,\n    expects: \"!null\",\n    async: false,\n    wrapped,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value !== null) {\n        dataset = this.wrapped[\"~run\"](dataset, config2);\n      }\n      if (dataset.value === null) {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nonNullable/nonNullableAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonNullableAsync(wrapped, message2) {\n  return {\n    kind: \"schema\",\n    type: \"non_nullable\",\n    reference: nonNullableAsync,\n    expects: \"!null\",\n    async: true,\n    wrapped,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (dataset.value !== null) {\n        dataset = await this.wrapped[\"~run\"](dataset, config2);\n      }\n      if (dataset.value === null) {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nonNullish/nonNullish.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonNullish(wrapped, message2) {\n  return {\n    kind: \"schema\",\n    type: \"non_nullish\",\n    reference: nonNullish,\n    expects: \"(!null & !undefined)\",\n    async: false,\n    wrapped,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (!(dataset.value === null || dataset.value === void 0)) {\n        dataset = this.wrapped[\"~run\"](dataset, config2);\n      }\n      if (dataset.value === null || dataset.value === void 0) {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nonNullish/nonNullishAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonNullishAsync(wrapped, message2) {\n  return {\n    kind: \"schema\",\n    type: \"non_nullish\",\n    reference: nonNullishAsync,\n    expects: \"(!null & !undefined)\",\n    async: true,\n    wrapped,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (!(dataset.value === null || dataset.value === void 0)) {\n        dataset = await this.wrapped[\"~run\"](dataset, config2);\n      }\n      if (dataset.value === null || dataset.value === void 0) {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nonOptional/nonOptional.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonOptional(wrapped, message2) {\n  return {\n    kind: \"schema\",\n    type: \"non_optional\",\n    reference: nonOptional,\n    expects: \"!undefined\",\n    async: false,\n    wrapped,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value !== void 0) {\n        dataset = this.wrapped[\"~run\"](dataset, config2);\n      }\n      if (dataset.value === void 0) {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nonOptional/nonOptionalAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonOptionalAsync(wrapped, message2) {\n  return {\n    kind: \"schema\",\n    type: \"non_optional\",\n    reference: nonOptionalAsync,\n    expects: \"!undefined\",\n    async: true,\n    wrapped,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (dataset.value !== void 0) {\n        dataset = await this.wrapped[\"~run\"](dataset, config2);\n      }\n      if (dataset.value === void 0) {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/null/null.ts\n// @__NO_SIDE_EFFECTS__\nfunction null_(message2) {\n  return {\n    kind: \"schema\",\n    type: \"null\",\n    reference: null_,\n    expects: \"null\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === null) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nullable/nullable.ts\n// @__NO_SIDE_EFFECTS__\nfunction nullable(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"nullable\",\n    reference: nullable,\n    expects: `(${wrapped.expects} | null)`,\n    async: false,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === null) {\n        if (this.default !== void 0) {\n          dataset.value = getDefault(this, dataset, config2);\n        }\n        if (dataset.value === null) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/nullable/nullableAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction nullableAsync(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"nullable\",\n    reference: nullableAsync,\n    expects: `(${wrapped.expects} | null)`,\n    async: true,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (dataset.value === null) {\n        if (this.default !== void 0) {\n          dataset.value = await getDefault(this, dataset, config2);\n        }\n        if (dataset.value === null) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/nullish/nullish.ts\n// @__NO_SIDE_EFFECTS__\nfunction nullish(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"nullish\",\n    reference: nullish,\n    expects: `(${wrapped.expects} | null | undefined)`,\n    async: false,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === null || dataset.value === void 0) {\n        if (this.default !== void 0) {\n          dataset.value = getDefault(this, dataset, config2);\n        }\n        if (dataset.value === null || dataset.value === void 0) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/nullish/nullishAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction nullishAsync(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"nullish\",\n    reference: nullishAsync,\n    expects: `(${wrapped.expects} | null | undefined)`,\n    async: true,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (dataset.value === null || dataset.value === void 0) {\n        if (this.default !== void 0) {\n          dataset.value = await getDefault(this, dataset, config2);\n        }\n        if (dataset.value === null || dataset.value === void 0) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/number/number.ts\n// @__NO_SIDE_EFFECTS__\nfunction number(message2) {\n  return {\n    kind: \"schema\",\n    type: \"number\",\n    reference: number,\n    expects: \"number\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (typeof dataset.value === \"number\" && !isNaN(dataset.value)) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/object/object.ts\n// @__NO_SIDE_EFFECTS__\nfunction object(entries2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"object\",\n    reference: object,\n    expects: \"Object\",\n    async: false,\n    entries: entries2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        for (const key in this.entries) {\n          const valueSchema = this.entries[key];\n          if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n          valueSchema.default !== void 0) {\n            const value2 = key in input ? (\n              // @ts-expect-error\n              input[key]\n            ) : getDefault(valueSchema);\n            const valueDataset = valueSchema[\"~run\"]({ value: value2 }, config2);\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  // @ts-expect-error\n                  value: input[key]\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/object/objectAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction objectAsync(entries2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"object\",\n    reference: objectAsync,\n    expects: \"Object\",\n    async: true,\n    entries: entries2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        const valueDatasets = await Promise.all(\n          Object.entries(this.entries).map(async ([key, valueSchema]) => {\n            if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n            valueSchema.default !== void 0) {\n              const value2 = key in input ? (\n                // @ts-expect-error\n                input[key]\n              ) : await getDefault(valueSchema);\n              return [\n                key,\n                value2,\n                valueSchema,\n                await valueSchema[\"~run\"]({ value: value2 }, config2)\n              ];\n            }\n            return [\n              key,\n              // @ts-expect-error\n              input[key],\n              valueSchema,\n              null\n            ];\n          })\n        );\n        for (const [key, value2, valueSchema, valueDataset] of valueDatasets) {\n          if (valueDataset) {\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = await getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  value: value2\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/objectWithRest/objectWithRest.ts\n// @__NO_SIDE_EFFECTS__\nfunction objectWithRest(entries2, rest, message2) {\n  return {\n    kind: \"schema\",\n    type: \"object_with_rest\",\n    reference: objectWithRest,\n    expects: \"Object\",\n    async: false,\n    entries: entries2,\n    rest,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        for (const key in this.entries) {\n          const valueSchema = this.entries[key];\n          if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n          valueSchema.default !== void 0) {\n            const value2 = key in input ? (\n              // @ts-expect-error\n              input[key]\n            ) : getDefault(valueSchema);\n            const valueDataset = valueSchema[\"~run\"]({ value: value2 }, config2);\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  // @ts-expect-error\n                  value: input[key]\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const key in input) {\n            if (_isValidObjectKey(input, key) && !(key in this.entries)) {\n              const valueDataset = this.rest[\"~run\"](\n                // @ts-expect-error\n                { value: input[key] },\n                config2\n              );\n              if (valueDataset.issues) {\n                const pathItem = {\n                  type: \"object\",\n                  origin: \"value\",\n                  input,\n                  key,\n                  // @ts-expect-error\n                  value: input[key]\n                };\n                for (const issue of valueDataset.issues) {\n                  if (issue.path) {\n                    issue.path.unshift(pathItem);\n                  } else {\n                    issue.path = [pathItem];\n                  }\n                  dataset.issues?.push(issue);\n                }\n                if (!dataset.issues) {\n                  dataset.issues = valueDataset.issues;\n                }\n                if (config2.abortEarly) {\n                  dataset.typed = false;\n                  break;\n                }\n              }\n              if (!valueDataset.typed) {\n                dataset.typed = false;\n              }\n              dataset.value[key] = valueDataset.value;\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/objectWithRest/objectWithRestAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction objectWithRestAsync(entries2, rest, message2) {\n  return {\n    kind: \"schema\",\n    type: \"object_with_rest\",\n    reference: objectWithRestAsync,\n    expects: \"Object\",\n    async: true,\n    entries: entries2,\n    rest,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        const [normalDatasets, restDatasets] = await Promise.all([\n          // If key is present or its an optional schema with a default value,\n          // parse input of key or default value asynchronously\n          Promise.all(\n            Object.entries(this.entries).map(async ([key, valueSchema]) => {\n              if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n              valueSchema.default !== void 0) {\n                const value2 = key in input ? (\n                  // @ts-expect-error\n                  input[key]\n                ) : await getDefault(valueSchema);\n                return [\n                  key,\n                  value2,\n                  valueSchema,\n                  await valueSchema[\"~run\"]({ value: value2 }, config2)\n                ];\n              }\n              return [\n                key,\n                // @ts-expect-error\n                input[key],\n                valueSchema,\n                null\n              ];\n            })\n          ),\n          // Parse other entries with rest schema asynchronously\n          // Hint: We exclude specific keys for security reasons\n          Promise.all(\n            Object.entries(input).filter(\n              ([key]) => _isValidObjectKey(input, key) && !(key in this.entries)\n            ).map(\n              async ([key, value2]) => [\n                key,\n                value2,\n                await this.rest[\"~run\"]({ value: value2 }, config2)\n              ]\n            )\n          )\n        ]);\n        for (const [key, value2, valueSchema, valueDataset] of normalDatasets) {\n          if (valueDataset) {\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = await getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  value: value2\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const [key, value2, valueDataset] of restDatasets) {\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/optional/optional.ts\n// @__NO_SIDE_EFFECTS__\nfunction optional(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"optional\",\n    reference: optional,\n    expects: `(${wrapped.expects} | undefined)`,\n    async: false,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === void 0) {\n        if (this.default !== void 0) {\n          dataset.value = getDefault(this, dataset, config2);\n        }\n        if (dataset.value === void 0) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/optional/optionalAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction optionalAsync(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"optional\",\n    reference: optionalAsync,\n    expects: `(${wrapped.expects} | undefined)`,\n    async: true,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (dataset.value === void 0) {\n        if (this.default !== void 0) {\n          dataset.value = await getDefault(this, dataset, config2);\n        }\n        if (dataset.value === void 0) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/picklist/picklist.ts\n// @__NO_SIDE_EFFECTS__\nfunction picklist(options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"picklist\",\n    reference: picklist,\n    expects: _joinExpects(options.map(_stringify), \"|\"),\n    async: false,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (this.options.includes(dataset.value)) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/promise/promise.ts\n// @__NO_SIDE_EFFECTS__\nfunction promise(message2) {\n  return {\n    kind: \"schema\",\n    type: \"promise\",\n    reference: promise,\n    expects: \"Promise\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value instanceof Promise) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/record/record.ts\n// @__NO_SIDE_EFFECTS__\nfunction record(key, value2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"record\",\n    reference: record,\n    expects: \"Object\",\n    async: false,\n    key,\n    value: value2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        for (const entryKey in input) {\n          if (_isValidObjectKey(input, entryKey)) {\n            const entryValue = input[entryKey];\n            const keyDataset = this.key[\"~run\"]({ value: entryKey }, config2);\n            if (keyDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"key\",\n                input,\n                key: entryKey,\n                value: entryValue\n              };\n              for (const issue of keyDataset.issues) {\n                issue.path = [pathItem];\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = keyDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            const valueDataset = this.value[\"~run\"](\n              { value: entryValue },\n              config2\n            );\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key: entryKey,\n                value: entryValue\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!keyDataset.typed || !valueDataset.typed) {\n              dataset.typed = false;\n            }\n            if (keyDataset.typed) {\n              dataset.value[keyDataset.value] = valueDataset.value;\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/record/recordAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction recordAsync(key, value2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"record\",\n    reference: recordAsync,\n    expects: \"Object\",\n    async: true,\n    key,\n    value: value2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        const datasets = await Promise.all(\n          Object.entries(input).filter(([key2]) => _isValidObjectKey(input, key2)).map(\n            ([entryKey, entryValue]) => Promise.all([\n              entryKey,\n              entryValue,\n              this.key[\"~run\"]({ value: entryKey }, config2),\n              this.value[\"~run\"]({ value: entryValue }, config2)\n            ])\n          )\n        );\n        for (const [\n          entryKey,\n          entryValue,\n          keyDataset,\n          valueDataset\n        ] of datasets) {\n          if (keyDataset.issues) {\n            const pathItem = {\n              type: \"object\",\n              origin: \"key\",\n              input,\n              key: entryKey,\n              value: entryValue\n            };\n            for (const issue of keyDataset.issues) {\n              issue.path = [pathItem];\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = keyDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (valueDataset.issues) {\n            const pathItem = {\n              type: \"object\",\n              origin: \"value\",\n              input,\n              key: entryKey,\n              value: entryValue\n            };\n            for (const issue of valueDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = valueDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!keyDataset.typed || !valueDataset.typed) {\n            dataset.typed = false;\n          }\n          if (keyDataset.typed) {\n            dataset.value[keyDataset.value] = valueDataset.value;\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/set/set.ts\n// @__NO_SIDE_EFFECTS__\nfunction set(value2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"set\",\n    reference: set,\n    expects: \"Set\",\n    async: false,\n    value: value2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input instanceof Set) {\n        dataset.typed = true;\n        dataset.value = /* @__PURE__ */ new Set();\n        for (const inputValue of input) {\n          const valueDataset = this.value[\"~run\"](\n            { value: inputValue },\n            config2\n          );\n          if (valueDataset.issues) {\n            const pathItem = {\n              type: \"set\",\n              origin: \"value\",\n              input,\n              key: null,\n              value: inputValue\n            };\n            for (const issue of valueDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = valueDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!valueDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.add(valueDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/set/setAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction setAsync(value2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"set\",\n    reference: setAsync,\n    expects: \"Set\",\n    async: true,\n    value: value2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input instanceof Set) {\n        dataset.typed = true;\n        dataset.value = /* @__PURE__ */ new Set();\n        const valueDatasets = await Promise.all(\n          [...input].map(\n            async (inputValue) => [\n              inputValue,\n              await this.value[\"~run\"]({ value: inputValue }, config2)\n            ]\n          )\n        );\n        for (const [inputValue, valueDataset] of valueDatasets) {\n          if (valueDataset.issues) {\n            const pathItem = {\n              type: \"set\",\n              origin: \"value\",\n              input,\n              key: null,\n              value: inputValue\n            };\n            for (const issue of valueDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = valueDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!valueDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.add(valueDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/strictObject/strictObject.ts\n// @__NO_SIDE_EFFECTS__\nfunction strictObject(entries2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"strict_object\",\n    reference: strictObject,\n    expects: \"Object\",\n    async: false,\n    entries: entries2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        for (const key in this.entries) {\n          const valueSchema = this.entries[key];\n          if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n          valueSchema.default !== void 0) {\n            const value2 = key in input ? (\n              // @ts-expect-error\n              input[key]\n            ) : getDefault(valueSchema);\n            const valueDataset = valueSchema[\"~run\"]({ value: value2 }, config2);\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  // @ts-expect-error\n                  value: input[key]\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const key in input) {\n            if (!(key in this.entries)) {\n              _addIssue(this, \"key\", dataset, config2, {\n                input: key,\n                expected: \"never\",\n                path: [\n                  {\n                    type: \"object\",\n                    origin: \"key\",\n                    input,\n                    key,\n                    // @ts-expect-error\n                    value: input[key]\n                  }\n                ]\n              });\n              break;\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/strictObject/strictObjectAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction strictObjectAsync(entries2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"strict_object\",\n    reference: strictObjectAsync,\n    expects: \"Object\",\n    async: true,\n    entries: entries2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        const valueDatasets = await Promise.all(\n          Object.entries(this.entries).map(async ([key, valueSchema]) => {\n            if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n            valueSchema.default !== void 0) {\n              const value2 = key in input ? (\n                // @ts-expect-error\n                input[key]\n              ) : await getDefault(valueSchema);\n              return [\n                key,\n                value2,\n                valueSchema,\n                await valueSchema[\"~run\"]({ value: value2 }, config2)\n              ];\n            }\n            return [\n              key,\n              // @ts-expect-error\n              input[key],\n              valueSchema,\n              null\n            ];\n          })\n        );\n        for (const [key, value2, valueSchema, valueDataset] of valueDatasets) {\n          if (valueDataset) {\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = await getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  value: value2\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const key in input) {\n            if (!(key in this.entries)) {\n              _addIssue(this, \"key\", dataset, config2, {\n                input: key,\n                expected: \"never\",\n                path: [\n                  {\n                    type: \"object\",\n                    origin: \"key\",\n                    input,\n                    key,\n                    // @ts-expect-error\n                    value: input[key]\n                  }\n                ]\n              });\n              break;\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/strictTuple/strictTuple.ts\n// @__NO_SIDE_EFFECTS__\nfunction strictTuple(items, message2) {\n  return {\n    kind: \"schema\",\n    type: \"strict_tuple\",\n    reference: strictTuple,\n    expects: \"Array\",\n    async: false,\n    items,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        for (let key = 0; key < this.items.length; key++) {\n          const value2 = input[key];\n          const itemDataset = this.items[key][\"~run\"]({ value: value2 }, config2);\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n        if (!(dataset.issues && config2.abortEarly) && this.items.length < input.length) {\n          _addIssue(this, \"type\", dataset, config2, {\n            input: input[this.items.length],\n            expected: \"never\",\n            path: [\n              {\n                type: \"array\",\n                origin: \"value\",\n                input,\n                key: this.items.length,\n                value: input[this.items.length]\n              }\n            ]\n          });\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/strictTuple/strictTupleAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction strictTupleAsync(items, message2) {\n  return {\n    kind: \"schema\",\n    type: \"strict_tuple\",\n    reference: strictTupleAsync,\n    expects: \"Array\",\n    async: true,\n    items,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        const itemDatasets = await Promise.all(\n          this.items.map(async (item, key) => {\n            const value2 = input[key];\n            return [key, value2, await item[\"~run\"]({ value: value2 }, config2)];\n          })\n        );\n        for (const [key, value2, itemDataset] of itemDatasets) {\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n        if (!(dataset.issues && config2.abortEarly) && this.items.length < input.length) {\n          _addIssue(this, \"type\", dataset, config2, {\n            input: input[this.items.length],\n            expected: \"never\",\n            path: [\n              {\n                type: \"array\",\n                origin: \"value\",\n                input,\n                key: this.items.length,\n                value: input[this.items.length]\n              }\n            ]\n          });\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/string/string.ts\n// @__NO_SIDE_EFFECTS__\nfunction string(message2) {\n  return {\n    kind: \"schema\",\n    type: \"string\",\n    reference: string,\n    expects: \"string\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (typeof dataset.value === \"string\") {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/symbol/symbol.ts\n// @__NO_SIDE_EFFECTS__\nfunction symbol(message2) {\n  return {\n    kind: \"schema\",\n    type: \"symbol\",\n    reference: symbol,\n    expects: \"symbol\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (typeof dataset.value === \"symbol\") {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/tuple/tuple.ts\n// @__NO_SIDE_EFFECTS__\nfunction tuple(items, message2) {\n  return {\n    kind: \"schema\",\n    type: \"tuple\",\n    reference: tuple,\n    expects: \"Array\",\n    async: false,\n    items,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        for (let key = 0; key < this.items.length; key++) {\n          const value2 = input[key];\n          const itemDataset = this.items[key][\"~run\"]({ value: value2 }, config2);\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/tuple/tupleAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction tupleAsync(items, message2) {\n  return {\n    kind: \"schema\",\n    type: \"tuple\",\n    reference: tupleAsync,\n    expects: \"Array\",\n    async: true,\n    items,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        const itemDatasets = await Promise.all(\n          this.items.map(async (item, key) => {\n            const value2 = input[key];\n            return [key, value2, await item[\"~run\"]({ value: value2 }, config2)];\n          })\n        );\n        for (const [key, value2, itemDataset] of itemDatasets) {\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/tupleWithRest/tupleWithRest.ts\n// @__NO_SIDE_EFFECTS__\nfunction tupleWithRest(items, rest, message2) {\n  return {\n    kind: \"schema\",\n    type: \"tuple_with_rest\",\n    reference: tupleWithRest,\n    expects: \"Array\",\n    async: false,\n    items,\n    rest,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        for (let key = 0; key < this.items.length; key++) {\n          const value2 = input[key];\n          const itemDataset = this.items[key][\"~run\"]({ value: value2 }, config2);\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (let key = this.items.length; key < input.length; key++) {\n            const value2 = input[key];\n            const itemDataset = this.rest[\"~run\"]({ value: value2 }, config2);\n            if (itemDataset.issues) {\n              const pathItem = {\n                type: \"array\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of itemDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = itemDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!itemDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value.push(itemDataset.value);\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/tupleWithRest/tupleWithRestAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction tupleWithRestAsync(items, rest, message2) {\n  return {\n    kind: \"schema\",\n    type: \"tuple_with_rest\",\n    reference: tupleWithRestAsync,\n    expects: \"Array\",\n    async: true,\n    items,\n    rest,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        const [normalDatasets, restDatasets] = await Promise.all([\n          // Parse schema of each normal item\n          Promise.all(\n            this.items.map(async (item, key) => {\n              const value2 = input[key];\n              return [\n                key,\n                value2,\n                await item[\"~run\"]({ value: value2 }, config2)\n              ];\n            })\n          ),\n          // Parse other items with rest schema\n          Promise.all(\n            input.slice(this.items.length).map(async (value2, key) => {\n              return [\n                key + this.items.length,\n                value2,\n                await this.rest[\"~run\"]({ value: value2 }, config2)\n              ];\n            })\n          )\n        ]);\n        for (const [key, value2, itemDataset] of normalDatasets) {\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const [key, value2, itemDataset] of restDatasets) {\n            if (itemDataset.issues) {\n              const pathItem = {\n                type: \"array\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of itemDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = itemDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!itemDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value.push(itemDataset.value);\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/undefined/undefined.ts\n// @__NO_SIDE_EFFECTS__\nfunction undefined_(message2) {\n  return {\n    kind: \"schema\",\n    type: \"undefined\",\n    reference: undefined_,\n    expects: \"undefined\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === void 0) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/undefinedable/undefinedable.ts\n// @__NO_SIDE_EFFECTS__\nfunction undefinedable(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"undefinedable\",\n    reference: undefinedable,\n    expects: `(${wrapped.expects} | undefined)`,\n    async: false,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === void 0) {\n        if (this.default !== void 0) {\n          dataset.value = getDefault(this, dataset, config2);\n        }\n        if (dataset.value === void 0) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/undefinedable/undefinedableAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction undefinedableAsync(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"undefinedable\",\n    reference: undefinedableAsync,\n    expects: `(${wrapped.expects} | undefined)`,\n    async: true,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (dataset.value === void 0) {\n        if (this.default !== void 0) {\n          dataset.value = await getDefault(this, dataset, config2);\n        }\n        if (dataset.value === void 0) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/union/utils/_subIssues/_subIssues.ts\n// @__NO_SIDE_EFFECTS__\nfunction _subIssues(datasets) {\n  let issues;\n  if (datasets) {\n    for (const dataset of datasets) {\n      if (issues) {\n        issues.push(...dataset.issues);\n      } else {\n        issues = dataset.issues;\n      }\n    }\n  }\n  return issues;\n}\n\n// src/schemas/union/union.ts\n// @__NO_SIDE_EFFECTS__\nfunction union(options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"union\",\n    reference: union,\n    expects: _joinExpects(\n      options.map((option) => option.expects),\n      \"|\"\n    ),\n    async: false,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      let validDataset;\n      let typedDatasets;\n      let untypedDatasets;\n      for (const schema of this.options) {\n        const optionDataset = schema[\"~run\"]({ value: dataset.value }, config2);\n        if (optionDataset.typed) {\n          if (optionDataset.issues) {\n            if (typedDatasets) {\n              typedDatasets.push(optionDataset);\n            } else {\n              typedDatasets = [optionDataset];\n            }\n          } else {\n            validDataset = optionDataset;\n            break;\n          }\n        } else {\n          if (untypedDatasets) {\n            untypedDatasets.push(optionDataset);\n          } else {\n            untypedDatasets = [optionDataset];\n          }\n        }\n      }\n      if (validDataset) {\n        return validDataset;\n      }\n      if (typedDatasets) {\n        if (typedDatasets.length === 1) {\n          return typedDatasets[0];\n        }\n        _addIssue(this, \"type\", dataset, config2, {\n          issues: _subIssues(typedDatasets)\n        });\n        dataset.typed = true;\n      } else if (untypedDatasets?.length === 1) {\n        return untypedDatasets[0];\n      } else {\n        _addIssue(this, \"type\", dataset, config2, {\n          issues: _subIssues(untypedDatasets)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/union/unionAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction unionAsync(options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"union\",\n    reference: unionAsync,\n    expects: _joinExpects(\n      options.map((option) => option.expects),\n      \"|\"\n    ),\n    async: true,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      let validDataset;\n      let typedDatasets;\n      let untypedDatasets;\n      for (const schema of this.options) {\n        const optionDataset = await schema[\"~run\"](\n          { value: dataset.value },\n          config2\n        );\n        if (optionDataset.typed) {\n          if (optionDataset.issues) {\n            if (typedDatasets) {\n              typedDatasets.push(optionDataset);\n            } else {\n              typedDatasets = [optionDataset];\n            }\n          } else {\n            validDataset = optionDataset;\n            break;\n          }\n        } else {\n          if (untypedDatasets) {\n            untypedDatasets.push(optionDataset);\n          } else {\n            untypedDatasets = [optionDataset];\n          }\n        }\n      }\n      if (validDataset) {\n        return validDataset;\n      }\n      if (typedDatasets) {\n        if (typedDatasets.length === 1) {\n          return typedDatasets[0];\n        }\n        _addIssue(this, \"type\", dataset, config2, {\n          issues: _subIssues(typedDatasets)\n        });\n        dataset.typed = true;\n      } else if (untypedDatasets?.length === 1) {\n        return untypedDatasets[0];\n      } else {\n        _addIssue(this, \"type\", dataset, config2, {\n          issues: _subIssues(untypedDatasets)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/unknown/unknown.ts\n// @__NO_SIDE_EFFECTS__\nfunction unknown() {\n  return {\n    kind: \"schema\",\n    type: \"unknown\",\n    reference: unknown,\n    expects: \"unknown\",\n    async: false,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset) {\n      dataset.typed = true;\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/variant/variant.ts\n// @__NO_SIDE_EFFECTS__\nfunction variant(key, options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"variant\",\n    reference: variant,\n    expects: \"Object\",\n    async: false,\n    key,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        let outputDataset;\n        let maxDiscriminatorPriority = 0;\n        let invalidDiscriminatorKey = this.key;\n        let expectedDiscriminators = [];\n        const parseOptions = (variant2, allKeys) => {\n          for (const schema of variant2.options) {\n            if (schema.type === \"variant\") {\n              parseOptions(schema, new Set(allKeys).add(schema.key));\n            } else {\n              let keysAreValid = true;\n              let currentPriority = 0;\n              for (const currentKey of allKeys) {\n                const discriminatorSchema = schema.entries[currentKey];\n                if (currentKey in input ? discriminatorSchema[\"~run\"](\n                  // @ts-expect-error\n                  { typed: false, value: input[currentKey] },\n                  { abortEarly: true }\n                ).issues : discriminatorSchema.type !== \"exact_optional\" && discriminatorSchema.type !== \"optional\" && discriminatorSchema.type !== \"nullish\") {\n                  keysAreValid = false;\n                  if (invalidDiscriminatorKey !== currentKey && (maxDiscriminatorPriority < currentPriority || maxDiscriminatorPriority === currentPriority && currentKey in input && !(invalidDiscriminatorKey in input))) {\n                    maxDiscriminatorPriority = currentPriority;\n                    invalidDiscriminatorKey = currentKey;\n                    expectedDiscriminators = [];\n                  }\n                  if (invalidDiscriminatorKey === currentKey) {\n                    expectedDiscriminators.push(\n                      schema.entries[currentKey].expects\n                    );\n                  }\n                  break;\n                }\n                currentPriority++;\n              }\n              if (keysAreValid) {\n                const optionDataset = schema[\"~run\"]({ value: input }, config2);\n                if (!outputDataset || !outputDataset.typed && optionDataset.typed) {\n                  outputDataset = optionDataset;\n                }\n              }\n            }\n            if (outputDataset && !outputDataset.issues) {\n              break;\n            }\n          }\n        };\n        parseOptions(this, /* @__PURE__ */ new Set([this.key]));\n        if (outputDataset) {\n          return outputDataset;\n        }\n        _addIssue(this, \"type\", dataset, config2, {\n          // @ts-expect-error\n          input: input[invalidDiscriminatorKey],\n          expected: _joinExpects(expectedDiscriminators, \"|\"),\n          path: [\n            {\n              type: \"object\",\n              origin: \"value\",\n              input,\n              key: invalidDiscriminatorKey,\n              // @ts-expect-error\n              value: input[invalidDiscriminatorKey]\n            }\n          ]\n        });\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/variant/variantAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction variantAsync(key, options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"variant\",\n    reference: variantAsync,\n    expects: \"Object\",\n    async: true,\n    key,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        let outputDataset;\n        let maxDiscriminatorPriority = 0;\n        let invalidDiscriminatorKey = this.key;\n        let expectedDiscriminators = [];\n        const parseOptions = async (variant2, allKeys) => {\n          for (const schema of variant2.options) {\n            if (schema.type === \"variant\") {\n              await parseOptions(schema, new Set(allKeys).add(schema.key));\n            } else {\n              let keysAreValid = true;\n              let currentPriority = 0;\n              for (const currentKey of allKeys) {\n                const discriminatorSchema = schema.entries[currentKey];\n                if (currentKey in input ? (await discriminatorSchema[\"~run\"](\n                  // @ts-expect-error\n                  { typed: false, value: input[currentKey] },\n                  { abortEarly: true }\n                )).issues : discriminatorSchema.type !== \"exact_optional\" && discriminatorSchema.type !== \"optional\" && discriminatorSchema.type !== \"nullish\") {\n                  keysAreValid = false;\n                  if (invalidDiscriminatorKey !== currentKey && (maxDiscriminatorPriority < currentPriority || maxDiscriminatorPriority === currentPriority && currentKey in input && !(invalidDiscriminatorKey in input))) {\n                    maxDiscriminatorPriority = currentPriority;\n                    invalidDiscriminatorKey = currentKey;\n                    expectedDiscriminators = [];\n                  }\n                  if (invalidDiscriminatorKey === currentKey) {\n                    expectedDiscriminators.push(\n                      schema.entries[currentKey].expects\n                    );\n                  }\n                  break;\n                }\n                currentPriority++;\n              }\n              if (keysAreValid) {\n                const optionDataset = await schema[\"~run\"](\n                  { value: input },\n                  config2\n                );\n                if (!outputDataset || !outputDataset.typed && optionDataset.typed) {\n                  outputDataset = optionDataset;\n                }\n              }\n            }\n            if (outputDataset && !outputDataset.issues) {\n              break;\n            }\n          }\n        };\n        await parseOptions(this, /* @__PURE__ */ new Set([this.key]));\n        if (outputDataset) {\n          return outputDataset;\n        }\n        _addIssue(this, \"type\", dataset, config2, {\n          // @ts-expect-error\n          input: input[invalidDiscriminatorKey],\n          expected: _joinExpects(expectedDiscriminators, \"|\"),\n          path: [\n            {\n              type: \"object\",\n              origin: \"value\",\n              input,\n              key: invalidDiscriminatorKey,\n              // @ts-expect-error\n              value: input[invalidDiscriminatorKey]\n            }\n          ]\n        });\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/void/void.ts\n// @__NO_SIDE_EFFECTS__\nfunction void_(message2) {\n  return {\n    kind: \"schema\",\n    type: \"void\",\n    reference: void_,\n    expects: \"void\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === void 0) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/methods/keyof/keyof.ts\n// @__NO_SIDE_EFFECTS__\nfunction keyof(schema, message2) {\n  return picklist(Object.keys(schema.entries), message2);\n}\n\n// src/methods/message/message.ts\n// @__NO_SIDE_EFFECTS__\nfunction message(schema, message_) {\n  return {\n    ...schema,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      return schema[\"~run\"](dataset, { ...config2, message: message_ });\n    }\n  };\n}\n\n// src/methods/omit/omit.ts\n// @__NO_SIDE_EFFECTS__\nfunction omit(schema, keys) {\n  const entries2 = {\n    ...schema.entries\n  };\n  for (const key of keys) {\n    delete entries2[key];\n  }\n  return {\n    ...schema,\n    entries: entries2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    }\n  };\n}\n\n// src/methods/parse/parse.ts\nfunction parse(schema, input, config2) {\n  const dataset = schema[\"~run\"]({ value: input }, getGlobalConfig(config2));\n  if (dataset.issues) {\n    throw new ValiError(dataset.issues);\n  }\n  return dataset.value;\n}\n\n// src/methods/parse/parseAsync.ts\nasync function parseAsync(schema, input, config2) {\n  const dataset = await schema[\"~run\"](\n    { value: input },\n    getGlobalConfig(config2)\n  );\n  if (dataset.issues) {\n    throw new ValiError(dataset.issues);\n  }\n  return dataset.value;\n}\n\n// src/methods/parser/parser.ts\n// @__NO_SIDE_EFFECTS__\nfunction parser(schema, config2) {\n  const func = (input) => parse(schema, input, config2);\n  func.schema = schema;\n  func.config = config2;\n  return func;\n}\n\n// src/methods/parser/parserAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction parserAsync(schema, config2) {\n  const func = (input) => parseAsync(schema, input, config2);\n  func.schema = schema;\n  func.config = config2;\n  return func;\n}\n\n// src/methods/partial/partial.ts\n// @__NO_SIDE_EFFECTS__\nfunction partial(schema, keys) {\n  const entries2 = {};\n  for (const key in schema.entries) {\n    entries2[key] = !keys || keys.includes(key) ? optional(schema.entries[key]) : schema.entries[key];\n  }\n  return {\n    ...schema,\n    entries: entries2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    }\n  };\n}\n\n// src/methods/partial/partialAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction partialAsync(schema, keys) {\n  const entries2 = {};\n  for (const key in schema.entries) {\n    entries2[key] = !keys || keys.includes(key) ? optionalAsync(schema.entries[key]) : schema.entries[key];\n  }\n  return {\n    ...schema,\n    entries: entries2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    }\n  };\n}\n\n// src/methods/pick/pick.ts\n// @__NO_SIDE_EFFECTS__\nfunction pick(schema, keys) {\n  const entries2 = {};\n  for (const key of keys) {\n    entries2[key] = schema.entries[key];\n  }\n  return {\n    ...schema,\n    entries: entries2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    }\n  };\n}\n\n// src/methods/pipe/pipe.ts\n// @__NO_SIDE_EFFECTS__\nfunction pipe(...pipe2) {\n  return {\n    ...pipe2[0],\n    pipe: pipe2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      for (const item of pipe2) {\n        if (item.kind !== \"metadata\") {\n          if (dataset.issues && (item.kind === \"schema\" || item.kind === \"transformation\")) {\n            dataset.typed = false;\n            break;\n          }\n          if (!dataset.issues || !config2.abortEarly && !config2.abortPipeEarly) {\n            dataset = item[\"~run\"](dataset, config2);\n          }\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/methods/pipe/pipeAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction pipeAsync(...pipe2) {\n  return {\n    ...pipe2[0],\n    pipe: pipe2,\n    async: true,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      for (const item of pipe2) {\n        if (item.kind !== \"metadata\") {\n          if (dataset.issues && (item.kind === \"schema\" || item.kind === \"transformation\")) {\n            dataset.typed = false;\n            break;\n          }\n          if (!dataset.issues || !config2.abortEarly && !config2.abortPipeEarly) {\n            dataset = await item[\"~run\"](dataset, config2);\n          }\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/methods/required/required.ts\n// @__NO_SIDE_EFFECTS__\nfunction required(schema, arg2, arg3) {\n  const keys = Array.isArray(arg2) ? arg2 : void 0;\n  const message2 = Array.isArray(arg2) ? arg3 : arg2;\n  const entries2 = {};\n  for (const key in schema.entries) {\n    entries2[key] = !keys || keys.includes(key) ? nonOptional(schema.entries[key], message2) : schema.entries[key];\n  }\n  return {\n    ...schema,\n    entries: entries2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    }\n  };\n}\n\n// src/methods/required/requiredAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction requiredAsync(schema, arg2, arg3) {\n  const keys = Array.isArray(arg2) ? arg2 : void 0;\n  const message2 = Array.isArray(arg2) ? arg3 : arg2;\n  const entries2 = {};\n  for (const key in schema.entries) {\n    entries2[key] = !keys || keys.includes(key) ? nonOptionalAsync(schema.entries[key], message2) : schema.entries[key];\n  }\n  return {\n    ...schema,\n    entries: entries2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    }\n  };\n}\n\n// src/methods/safeParse/safeParse.ts\n// @__NO_SIDE_EFFECTS__\nfunction safeParse(schema, input, config2) {\n  const dataset = schema[\"~run\"]({ value: input }, getGlobalConfig(config2));\n  return {\n    typed: dataset.typed,\n    success: !dataset.issues,\n    output: dataset.value,\n    issues: dataset.issues\n  };\n}\n\n// src/methods/safeParse/safeParseAsync.ts\n// @__NO_SIDE_EFFECTS__\nasync function safeParseAsync(schema, input, config2) {\n  const dataset = await schema[\"~run\"](\n    { value: input },\n    getGlobalConfig(config2)\n  );\n  return {\n    typed: dataset.typed,\n    success: !dataset.issues,\n    output: dataset.value,\n    issues: dataset.issues\n  };\n}\n\n// src/methods/safeParser/safeParser.ts\n// @__NO_SIDE_EFFECTS__\nfunction safeParser(schema, config2) {\n  const func = (input) => safeParse(schema, input, config2);\n  func.schema = schema;\n  func.config = config2;\n  return func;\n}\n\n// src/methods/safeParser/safeParserAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction safeParserAsync(schema, config2) {\n  const func = (input) => safeParseAsync(schema, input, config2);\n  func.schema = schema;\n  func.config = config2;\n  return func;\n}\n\n// src/methods/summarize/summarize.ts\n// @__NO_SIDE_EFFECTS__\nfunction summarize(issues) {\n  let summary = \"\";\n  for (const issue of issues) {\n    if (summary) {\n      summary += \"\\n\";\n    }\n    summary += `\\xD7 ${issue.message}`;\n    const dotPath = getDotPath(issue);\n    if (dotPath) {\n      summary += `\n  \\u2192 at ${dotPath}`;\n    }\n  }\n  return summary;\n}\n\n// src/methods/unwrap/unwrap.ts\n// @__NO_SIDE_EFFECTS__\nfunction unwrap(schema) {\n  return schema.wrapped;\n}\nexport {\n  BASE64_REGEX,\n  BIC_REGEX,\n  CUID2_REGEX,\n  DECIMAL_REGEX,\n  DIGITS_REGEX,\n  EMAIL_REGEX,\n  EMOJI_REGEX,\n  HEXADECIMAL_REGEX,\n  HEX_COLOR_REGEX,\n  IMEI_REGEX,\n  IPV4_REGEX,\n  IPV6_REGEX,\n  IP_REGEX,\n  ISO_DATE_REGEX,\n  ISO_DATE_TIME_REGEX,\n  ISO_TIMESTAMP_REGEX,\n  ISO_TIME_REGEX,\n  ISO_TIME_SECOND_REGEX,\n  ISO_WEEK_REGEX,\n  MAC48_REGEX,\n  MAC64_REGEX,\n  MAC_REGEX,\n  NANO_ID_REGEX,\n  OCTAL_REGEX,\n  RFC_EMAIL_REGEX,\n  SLUG_REGEX,\n  ULID_REGEX,\n  UUID_REGEX,\n  ValiError,\n  _addIssue,\n  _getByteCount,\n  _getGraphemeCount,\n  _getLastMetadata,\n  _getStandardProps,\n  _getWordCount,\n  _isLuhnAlgo,\n  _isValidObjectKey,\n  _joinExpects,\n  _stringify,\n  any,\n  args,\n  argsAsync,\n  array,\n  arrayAsync,\n  assert,\n  awaitAsync,\n  base64,\n  bic,\n  bigint,\n  blob,\n  boolean,\n  brand,\n  bytes,\n  check,\n  checkAsync,\n  checkItems,\n  checkItemsAsync,\n  config,\n  creditCard,\n  cuid2,\n  custom,\n  customAsync,\n  date,\n  decimal,\n  deleteGlobalConfig,\n  deleteGlobalMessage,\n  deleteSchemaMessage,\n  deleteSpecificMessage,\n  description,\n  digits,\n  email,\n  emoji,\n  empty,\n  endsWith,\n  entries,\n  entriesFromList,\n  entriesFromObjects,\n  enum_ as enum,\n  enum_,\n  everyItem,\n  exactOptional,\n  exactOptionalAsync,\n  excludes,\n  fallback,\n  fallbackAsync,\n  file,\n  filterItems,\n  findItem,\n  finite,\n  flatten,\n  flavor,\n  forward,\n  forwardAsync,\n  function_ as function,\n  function_,\n  getDefault,\n  getDefaults,\n  getDefaultsAsync,\n  getDescription,\n  getDotPath,\n  getFallback,\n  getFallbacks,\n  getFallbacksAsync,\n  getGlobalConfig,\n  getGlobalMessage,\n  getMetadata,\n  getSchemaMessage,\n  getSpecificMessage,\n  getTitle,\n  graphemes,\n  gtValue,\n  hash,\n  hexColor,\n  hexadecimal,\n  imei,\n  includes,\n  instance,\n  integer,\n  intersect,\n  intersectAsync,\n  ip,\n  ipv4,\n  ipv6,\n  is,\n  isOfKind,\n  isOfType,\n  isValiError,\n  isoDate,\n  isoDateTime,\n  isoTime,\n  isoTimeSecond,\n  isoTimestamp,\n  isoWeek,\n  keyof,\n  lazy,\n  lazyAsync,\n  length,\n  literal,\n  looseObject,\n  looseObjectAsync,\n  looseTuple,\n  looseTupleAsync,\n  ltValue,\n  mac,\n  mac48,\n  mac64,\n  map,\n  mapAsync,\n  mapItems,\n  maxBytes,\n  maxEntries,\n  maxGraphemes,\n  maxLength,\n  maxSize,\n  maxValue,\n  maxWords,\n  message,\n  metadata,\n  mimeType,\n  minBytes,\n  minEntries,\n  minGraphemes,\n  minLength,\n  minSize,\n  minValue,\n  minWords,\n  multipleOf,\n  nan,\n  nanoid,\n  never,\n  nonEmpty,\n  nonNullable,\n  nonNullableAsync,\n  nonNullish,\n  nonNullishAsync,\n  nonOptional,\n  nonOptionalAsync,\n  normalize,\n  notBytes,\n  notEntries,\n  notGraphemes,\n  notLength,\n  notSize,\n  notValue,\n  notValues,\n  notWords,\n  null_ as null,\n  null_,\n  nullable,\n  nullableAsync,\n  nullish,\n  nullishAsync,\n  number,\n  object,\n  objectAsync,\n  objectWithRest,\n  objectWithRestAsync,\n  octal,\n  omit,\n  optional,\n  optionalAsync,\n  parse,\n  parseAsync,\n  parseJson,\n  parser,\n  parserAsync,\n  partial,\n  partialAsync,\n  partialCheck,\n  partialCheckAsync,\n  pick,\n  picklist,\n  pipe,\n  pipeAsync,\n  promise,\n  rawCheck,\n  rawCheckAsync,\n  rawTransform,\n  rawTransformAsync,\n  readonly,\n  record,\n  recordAsync,\n  reduceItems,\n  regex,\n  required,\n  requiredAsync,\n  returns,\n  returnsAsync,\n  rfcEmail,\n  safeInteger,\n  safeParse,\n  safeParseAsync,\n  safeParser,\n  safeParserAsync,\n  set,\n  setAsync,\n  setGlobalConfig,\n  setGlobalMessage,\n  setSchemaMessage,\n  setSpecificMessage,\n  size,\n  slug,\n  someItem,\n  sortItems,\n  startsWith,\n  strictObject,\n  strictObjectAsync,\n  strictTuple,\n  strictTupleAsync,\n  string,\n  stringifyJson,\n  summarize,\n  symbol,\n  title,\n  toLowerCase,\n  toMaxValue,\n  toMinValue,\n  toUpperCase,\n  transform,\n  transformAsync,\n  trim,\n  trimEnd,\n  trimStart,\n  tuple,\n  tupleAsync,\n  tupleWithRest,\n  tupleWithRestAsync,\n  ulid,\n  undefined_ as undefined,\n  undefined_,\n  undefinedable,\n  undefinedableAsync,\n  union,\n  unionAsync,\n  unknown,\n  unwrap,\n  url,\n  uuid,\n  value,\n  values,\n  variant,\n  variantAsync,\n  void_ as void,\n  void_,\n  words\n};\n", "/*\n * Defines Zod schemas that we use to convert Tribble objects into something\n * with actual type-safety\n */\n\nimport {\n  any,\n  array,\n  object,\n  optional,\n  pipe,\n  string,\n  union,\n  url,\n} from \"valibot\";\n\nconst v = {\n  string,\n  array,\n  object,\n  optional,\n  union,\n  any,\n  pipe,\n  url,\n};\n\nexport const AlbumSchema = v.object({\n  name: v.string(),\n  minDate: v.string(),\n  maxDate: v.string(),\n  thumbnailUrl: v.string(),\n  mosaic: v.any(),\n  id: v.string(),\n  photosCount: v.string(),\n  videosCount: v.string(),\n  flags: v.any(),\n  description: v.optional(v.string()),\n});\n\nexport const CountrySchema = v.object({\n  id: v.string(),\n  flag: v.optional(v.string()),\n  name: v.string(),\n  contains: v.optional(v.union([v.string(), v.array(v.string())])),\n});\n\nexport const UnescoSchema = v.object({\n  id: v.string(),\n  name: v.optional(v.string()),\n  longitude: v.optional(v.string()),\n  latitude: v.optional(v.string()),\n});\n\nexport const PlaceSchema = v.object({\n  id: v.string(),\n  name: v.string(),\n  feature: v.optional(v.union([v.string(), v.array(v.string())])),\n  in: v.optional(v.union([v.string(), v.array(v.string())])),\n  shortName: v.optional(v.string()),\n  wikipedia: v.optional(v.string()),\n  unescoId: v.optional(v.string()),\n});\n\nexport const PhotoSchema = v.object({\n  albumId: v.string(),\n  country: v.optional(v.union([v.string(), v.array(v.string())])),\n  createdAt: v.string(),\n  subject: v.optional(v.union([v.string(), v.array(v.string())])),\n  exposureTime: v.optional(v.string()),\n  fStop: v.optional(v.string()),\n  focalLength: v.optional(v.string()),\n  fullImage: v.string(),\n  height: v.optional(v.string()),\n  id: v.string(),\n  iso: v.optional(v.string()),\n  location: v.optional(v.union([v.string(), v.array(v.string())])),\n  midImageLossyUrl: v.string(),\n  model: v.optional(v.string()),\n  mosaicColours: v.string(),\n  pngUrl: v.string(),\n  rating: v.optional(v.string()),\n  style: v.optional(v.string()),\n  thumbnailUrl: v.string(),\n  width: v.optional(v.string()),\n  description: v.optional(v.string()),\n  summary: v.optional(v.string()),\n});\n\nexport const MammalSchema = v.object({\n  id: v.string(),\n  name: v.string(),\n  wikipedia: v.optional(v.string()),\n});\n\nexport const ReptileSchema = v.object({\n  id: v.string(),\n  name: v.optional(v.string()),\n  wikipedia: v.optional(v.string()),\n});\n\nexport const AmphibianSchema = v.object({\n  id: v.string(),\n  name: v.optional(v.string()),\n  wikipedia: v.optional(v.string()),\n});\n\nexport const InsectSchema = v.object({\n  id: v.string(),\n  name: v.optional(v.string()),\n  wikipedia: v.optional(v.string()),\n});\n\nexport const SubjectSchema = v.object({\n  id: v.string(),\n  name: v.optional(v.string()),\n  wikipedia: v.optional(v.string()),\n});\n\nexport const BirdSchema = v.object({\n  id: v.string(),\n  name: v.optional(v.string()),\n  wikipedia: v.optional(v.string()),\n  birdwatchUrl: v.optional(v.union([v.string(), v.array(v.string())])),\n});\n\nexport const VideoSchema = v.object({\n  id: v.string(),\n  albumId: v.string(),\n  description: v.string(),\n  posterUrl: v.pipe(v.string(), v.url()),\n  videoUrl1080p: v.pipe(v.string(), v.url()),\n  videoUrl480p: v.pipe(v.string(), v.url()),\n  videoUrl720p: v.pipe(v.string(), v.url()),\n  videoUrlUnscaled: v.pipe(v.string(), v.url()),\n});\n\nexport const FeatureSchema = v.object({\n  id: v.string(),\n  name: v.optional(v.string()),\n});\n", "// TODO dd typing\n\nexport function logParseWarning(issues: any): void {\n  const message: string[] = [];\n\n  for (const issue of issues) {\n    message.push(`Parse warning [${issue.path.join(\".\")}]: ${issue.message}`);\n  }\n\n  console.warn(message.join(\"\\n\"));\n}\n", "\nimport type { TripleObject } from \"@rgrannell1/tribbledb\";\nimport { logParseWarning } from \"../commons/logger.ts\";\nimport { safeParse } from \"valibot\";\n\nexport function parseObject<T>(\n  schema: any, // TODO\n  type: string,\n  object: TripleObject,\n): T | undefined {\n  const result = safeParse(schema, object);\n  if (!result.success) {\n    logParseWarning(result.issues);\n    return;\n  }\n\n  return { ...result.output, type } satisfies T;\n}\n", "import { asUrn, TribbleDB } from \"@rgrannell1/tribbledb\";\nimport type { TripleObject } from \"@rgrannell1/tribbledb\";\nimport { KnownTypes } from \"../constants.ts\";\nimport type { Country, Place, Unesco } from \"../types.ts\";\nimport { readThing } from \"../services/things.ts\";\nimport { arrayify } from \"../commons/arrays.ts\";\nimport { CountrySchema, PlaceSchema, UnescoSchema } from \"./schemas.ts\";\nimport { parseObject } from \"./parser.ts\";\nimport { logParseWarning } from \"../commons/logger.ts\";\nimport { safeParse } from \"valibot\";\n\n/* */\nexport function parsePlace(\n  tdb: TribbleDB,\n  place: TripleObject,\n): Place | undefined {\n  const result = safeParse(PlaceSchema, place);\n  if (!result.success) {\n    logParseWarning(result.issues);\n    return;\n  }\n\n  const refs = arrayify(result.output.in);\n\n  const lookedUpRefs = refs.flatMap((ref) => {\n    const obj = readThing(tdb, ref);\n    if (!obj) {\n      return [];\n    }\n\n    const parsed = parseLocation(tdb, obj);\n    if (!parsed) {\n      return [];\n    }\n\n    return [parsed];\n  });\n\n  return {\n    ...result.output,\n    type: \"place\",\n    in: lookedUpRefs,\n  };\n}\n\nexport function parseCountry(\n  _: TribbleDB,\n  country: TripleObject,\n): Country | undefined {\n  return parseObject(CountrySchema, \"country\", country);\n}\n\nexport function parseUnesco(\n  _: TribbleDB,\n  unesco: TripleObject,\n): Unesco | undefined {\n  return parseObject(UnescoSchema, \"unesco\", unesco);\n}\n\n/*\n * Parse on object identified by a location relation. At the moment, that'\n * countries and places\n */\nexport function parseLocation(\n  tdb: TribbleDB,\n  location: TripleObject,\n): Country | Place | undefined {\n  if (!location.id) {\n    return undefined;\n  }\n\n  const id = asUrn(location.id as string);\n\n  if (id.type === KnownTypes.PLACE) {\n    return parsePlace(tdb, location);\n  } else if (id.type === KnownTypes.COUNTRY) {\n    return parseCountry(tdb, location);\n  }\n\n  return undefined;\n}\n", "import { TribbleDB } from \"@rgrannell1/tribbledb\";\nimport {\n  parseCountry,\n  parseLocation,\n  parsePlace,\n  parseUnesco,\n} from \"../parsers/location.ts\";\nimport { readParsedThing, readParsedThings, readThing } from \"./things.ts\";\n\nexport const readCountry = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(\n    parseCountry,\n    tdb,\n    id,\n  );\n};\n\nexport const readPlace = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(\n    parsePlace,\n    tdb,\n    id,\n  );\n};\n\nexport const readLocation = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(\n    parseLocation,\n    tdb,\n    id,\n  );\n};\n\nexport const readUnesco = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(\n    parseUnesco,\n    tdb,\n    id,\n  );\n};\n\nexport const readCountries = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(\n    parseCountry,\n    tdb,\n    urns,\n  );\n};\n\nexport const readPlaces = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(\n    parsePlace,\n    tdb,\n    urns,\n  );\n};\n\nexport const readLocations = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(\n    parseLocation,\n    tdb,\n    urns,\n  );\n};\n\nexport const readUnescos = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(\n    parseUnesco,\n    tdb,\n    urns,\n  );\n};\n", "import { asInt } from \"../commons/numbers.ts\";\nimport { namesToUrns } from \"../semantic/names.ts\";\nimport { TribbleDB } from \"@rgrannell1/tribbledb\";\nimport type { TripleObject } from \"@rgrannell1/tribbledb\";\nimport type { Album } from \"../types.ts\";\nimport { arrayify } from \"../commons/arrays.ts\";\nimport { readCountries } from \"../services/location.ts\";\nimport { AlbumSchema } from \"./schemas.ts\";\nimport { safeParse } from \"valibot\";\n\n/*\n * Read album-data\n *\n * @param tdb The TribbleDB instance to read from.\n * @param album The raw album object from the TribbleDB.\n * @returns The parsed album.\n */\nexport function parseAlbum(tdb: TribbleDB, album: TripleObject): Album {\n  const result = safeParse(AlbumSchema, album);\n  if (!result.success) {\n    // todo: better error handling\n    throw new Error(\n      `Invalid album object: ${JSON.stringify(result.issues)}`,\n    );\n  }\n\n  const data = result.output;\n  const countryNames = new Set(arrayify(data.flags));\n  const countries = readCountries(tdb, namesToUrns(tdb, countryNames));\n\n  return {\n    name: data.name,\n    minDate: asInt(data.minDate),\n    maxDate: asInt(data.maxDate),\n    thumbnailUrl: data.thumbnailUrl,\n    mosaicColours: data.mosaic,\n    id: data.id,\n    photosCount: asInt(data.photosCount),\n    videosCount: asInt(data.videosCount),\n    description: data.description ?? \"\",\n    countries,\n  };\n}\n", "import { TribbleDB } from \"@rgrannell1/tribbledb\";\nimport type { TripleObject } from \"@rgrannell1/tribbledb\";\nimport type { Photo } from \"../types.ts\";\nimport { PhotoSchema } from \"./schemas.ts\";\nimport { parseObject } from \"./parser.ts\";\n\n/*\n * Parse photo from a triple object\n *\n * @param tdb - The TribbleDB instance\n * @param photo - The triple object representing the photo\n * @returns The parsed Photo or undefined if parsing fails\n */\nexport function parsePhoto(\n  _: TribbleDB,\n  photo: TripleObject,\n): Photo | undefined {\n  return parseObject(PhotoSchema, \"photo\", photo);\n}\n", "import { asUrn, TribbleDB } from \"@rgrannell1/tribbledb\";\nimport type { TripleObject } from \"@rgrannell1/tribbledb\";\nimport type {\n  Amphibian,\n  Bird,\n  Insect,\n  Mammal,\n  Reptile,\n  Subject,\n} from \"../types.ts\";\nimport { KnownTypes } from \"../constants.ts\";\nimport {\n  AmphibianSchema,\n  BirdSchema,\n  InsectSchema,\n  MammalSchema,\n  ReptileSchema,\n  SubjectSchema,\n} from \"./schemas.ts\";\nimport { parseObject } from \"./parser.ts\";\nimport { logParseWarning } from \"../commons/logger.ts\";\nimport { safeParse } from \"valibot\";\n\n/*\n * Parse a bird subject\n */\nexport function parseBird(\n  _: TribbleDB,\n  subject: TripleObject,\n): Bird | undefined {\n  return parseObject(BirdSchema, \"bird\", subject);\n}\n\n/*\n * Parse a mammal\n */\nexport function parseMammal(\n  _: TribbleDB,\n  subject: TripleObject,\n): Mammal | undefined {\n  return parseObject(MammalSchema, \"mammal\", subject);\n}\n\n/* */\nexport function parseReptile(\n  _: TribbleDB,\n  subject: TripleObject,\n): Reptile | undefined {\n  return parseObject(ReptileSchema, \"reptile\", subject);\n}\n\n/* */\nexport function parseAmphibian(\n  _: TribbleDB,\n  subject: TripleObject,\n): Amphibian | undefined {\n  return parseObject(AmphibianSchema, \"amphibian\", subject);\n}\n\n/* */\nexport function parseInsect(\n  _: TribbleDB,\n  subject: TripleObject,\n): Insect | undefined {\n  return parseObject(InsectSchema, \"insect\", subject);\n}\n\n/* */\nexport function parseSubject(\n  _: TribbleDB,\n  subject: TripleObject,\n): Subject | undefined {\n  const parsed = asUrn(subject.id as string);\n\n  if (parsed.type === KnownTypes.BIRD) {\n    return parseBird(_, subject);\n  } else if (parsed.type === KnownTypes.MAMMAL) {\n    return parseMammal(_, subject);\n  } else if (parsed.type === KnownTypes.REPTILE) {\n    return parseReptile(_, subject);\n  } else if (parsed.type === KnownTypes.AMPHIBIAN) {\n    return parseAmphibian(_, subject);\n  } else if (parsed.type === KnownTypes.INSECT) {\n    return parseInsect(_, subject);\n  }\n\n  // for other subjects\n  const result = safeParse(SubjectSchema, subject);\n  if (!result.success) {\n    logParseWarning(result.issues);\n    return;\n  }\n\n  return result.output satisfies Subject;\n}\n", "import { TribbleDB } from \"@rgrannell1/tribbledb\";\nimport {\n  parseAmphibian,\n  parseInsect,\n  parseMammal,\n  parseReptile,\n  parseSubject,\n} from \"../parsers/subject.ts\";\nimport { readParsedThing, readParsedThings } from \"./things.ts\";\n\nexport const readMammal = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(parseMammal, tdb, id);\n};\n\nexport const readReptile = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(parseReptile, tdb, id);\n};\n\nexport const readAmphibian = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(parseMammal, tdb, id);\n};\n\nexport const readInsect = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(parseInsect, tdb, id);\n};\n\nexport const readSubject = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(parseSubject, tdb, id);\n};\n\nexport const readSubjects = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(parseSubject, tdb, urns);\n};\n\nexport const readMammals = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(parseMammal, tdb, urns);\n};\n\nexport const readReptiles = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(parseReptile, tdb, urns);\n};\n\nexport const readAmphibians = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(parseAmphibian, tdb, urns);\n};\n\nexport const readInsects = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(parseInsect, tdb, urns);\n};\n", "import { KnownRelations, PHOTO_WIDTH } from \"../constants.ts\";\nimport { asUrn, TribbleDB } from \"@rgrannell1/tribbledb\";\nimport type { Country, Photo, Place, Subject } from \"../types.ts\";\nimport { parsePhoto } from \"../parsers/photo.ts\";\nimport { readParsedThing, readParsedThings } from \"./things.ts\";\nimport { readSubjects } from \"./subjects.ts\";\nimport { readLocations } from \"./location.ts\";\n\nconst coloursCache: Map<string, string> = new Map();\n\nexport class Photos {\n  /*\n   * Determine whether a photo should be eagerly or lazily loaded\n   * depending on page position\n   */\n  static loadingMode(idx: number): \"eager\" | \"lazy\" {\n    const viewportWidth = globalThis.innerWidth;\n    const viewportHeight = globalThis.innerHeight;\n\n    const imageDimension = PHOTO_WIDTH;\n    const maxImagesPerRow = Math.floor(viewportWidth / imageDimension);\n    const maxRowsInFold = Math.floor(viewportHeight / imageDimension);\n\n    return idx > (maxImagesPerRow * maxRowsInFold) + 1 ? \"lazy\" : \"eager\";\n  }\n\n  /*\n   * Convert a mosaic colour string into a bitmap data URL\n   */\n  static encodeBitmapDataURL(colours: string): string {\n    if (coloursCache.has(colours)) {\n      return coloursCache.get(colours) as string;\n    }\n\n    const coloursList = colours.split(\"#\").map((colour: string) =>\n      `#${colour}`\n    );\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = 2;\n    canvas.height = 2;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) {\n      throw new Error(\"context missing\");\n    }\n    ctx.fillStyle = coloursList[1];\n    ctx.fillRect(0, 0, 1, 1);\n    ctx.fillStyle = coloursList[2];\n    ctx.fillRect(1, 0, 1, 1);\n    ctx.fillStyle = coloursList[3];\n    ctx.fillRect(0, 1, 1, 1);\n    ctx.fillStyle = coloursList[4];\n    ctx.fillRect(1, 1, 1, 1);\n\n    coloursCache.set(colours, canvas.toDataURL(\"image/png\"));\n    return coloursCache.get(colours) as string;\n  }\n}\n\n/* */\nexport function readAllPhotos(tdb: TribbleDB): Photo[] {\n  return tdb.search({\n    source: { type: \"photo\" },\n  }).objects().flatMap((obj) => {\n    const photo = parsePhoto(tdb, obj);\n    return photo ? [photo] : [];\n  });\n}\n\n/*\n * Read the locations and subjects associated with a set of photo ids\n */\nexport function readThingsByPhotoIds(tdb: TribbleDB, photoIds: Set<string>): {\n  locations: (Country | Place)[];\n  subjects: Subject[];\n} {\n  const locations = new Set<string>();\n  const subjects = new Set<string>();\n\n  for (const photoId of photoIds) {\n    const pid = asUrn(photoId);\n\n    const obj = tdb.search({\n      source: { type: pid.type, id: pid.id },\n      relation: [KnownRelations.LOCATION, KnownRelations.SUBJECT],\n    }).firstObject(true);\n\n    if (!obj) {\n      continue;\n    }\n\n    const location = obj?.location ?? [];\n    const subject = obj?.subject ?? [];\n\n    for (const loc of location) {\n      locations.add(loc);\n    }\n    for (const subj of subject) {\n      subjects.add(subj);\n    }\n  }\n\n  return {\n    subjects: readSubjects(tdb, subjects),\n    locations: readLocations(tdb, locations),\n  };\n}\n\nexport function readPhotosByThingIds(\n  tdb: TribbleDB,\n  thingsUrns: Set<string>,\n): Photo[] {\n  const photoIds = new Set<string>();\n\n  for (const thingUrn of thingsUrns) {\n    const { type, id } = asUrn(thingUrn);\n\n    const results = tdb.search({\n      //relation: KnownRelations.SUBJECT,\n      target: { type, id },\n    }).sources();\n\n    for (const result of results) {\n      photoIds.add(result);\n    }\n  }\n\n  return readPhotos(tdb, photoIds);\n}\n\nexport const readPhoto = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(parsePhoto, tdb, id);\n};\n\nexport const readPhotos = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(parsePhoto, tdb, urns);\n};\n", "import { TribbleDB } from \"@rgrannell1/tribbledb\";\nimport type { TripleObject } from \"@rgrannell1/tribbledb\";\nimport type { Video } from \"../types.ts\";\nimport { VideoSchema } from \"./schemas.ts\";\nimport { parseObject } from \"./parser.ts\";\n\n/* */\nexport function parseVideo(\n  _: TribbleDB,\n  video: TripleObject,\n): Video | undefined {\n  return parseObject(VideoSchema, \"video\", video);\n}\n", "import { TribbleDB } from \"@rgrannell1/tribbledb\";\nimport type { Video } from \"../types.ts\";\nimport { readParsedThing, readParsedThings } from \"./things.ts\";\nimport { parseVideo } from \"../parsers/video.ts\";\n\nexport const readVideo = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(parseVideo, tdb, id);\n};\n\nexport const readVideos = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(parseVideo, tdb, urns);\n};\n\n/*\n * Read and parse a video by URNs\n *\n * @param tdb The TribbleDB instance\n *\n * @return The parsed videos\n */\nexport function readAllVideos(tdb: TribbleDB): Video[] {\n  const videos = tdb.search({\n    source: { type: \"video\" },\n  }).sources();\n\n  return readVideos(tdb, videos) as Video[]; // TODO\n}\n", "import { asUrn, TribbleDB } from \"@rgrannell1/tribbledb\";\nimport type { Album } from \"../types.ts\";\nimport type { Photo, Video } from \"../types.ts\";\nimport { parseAlbum } from \"../parsers/album.ts\";\nimport { readPhotos, readThingsByPhotoIds } from \"./photos.ts\";\nimport { readParsedThing, readParsedThings } from \"./things.ts\";\nimport { readVideos } from \"./videos.ts\";\nimport { KnownRelations, KnownTypes } from \"../constants.ts\";\n\n/*\n * Get the album date\n */\nexport function albumYear(album: Album): number {\n  return new Date(album.minDate).getFullYear();\n}\n\n/*\n * Read albums from the TribbleDB\n */\nexport function readAllAlbums(tdb: TribbleDB): Album[] {\n  const ids = tdb.search({\n    source: { type: KnownTypes.ALBUM },\n  }).sources();\n\n  return (readAlbums(tdb, ids) as Album[])\n    .sort((album0: Album, album1: Album) => {\n      return album1.minDate - album0.minDate;\n    });\n}\n\n/*\n * Get the photo IDs associated with an album ID\n *\n * @param tdb TribbleDB instance\n * @param id Album URN\n */\nexport function readAlbumPhotoIds(tdb: TribbleDB, id: string): Set<string> {\n  return tdb.search({\n    source: { type: KnownTypes.PHOTO },\n    relation: KnownRelations.ALBUM_ID,\n    target: { id: asUrn(id).id },\n  }).sources();\n}\n\n/*\n * Read photos associated with an album\n *\n * @param tdb TribbleDB instance\n * @param id Album URN\n */\nexport function readAlbumPhotosByAlbumId(tdb: TribbleDB, id: string): Photo[] {\n  return readPhotos(tdb, readAlbumPhotoIds(tdb, id));\n}\n\n/*\n * Read videos associated with an album\n *\n * @param tdb TribbleDB instance\n * @param id Album URN\n */\nexport function readAlbumVideoIds(tdb: TribbleDB, id: string): Set<string> {\n  return tdb.search({\n    source: { type: KnownTypes.VIDEO },\n    relation: KnownRelations.ALBUM_ID,\n    target: { id: asUrn(id).id },\n  }).sources();\n}\n\n/*\n * Read videos associated with an album\n *\n * @param tdb TribbleDB instance\n * @param id Album URN\n */\nexport function readAlbumVideosByAlbumId(tdb: TribbleDB, id: string): Video[] {\n  return readVideos(tdb, readAlbumVideoIds(tdb, id));\n}\n\n/*\n * Photos in an album are associated with places (`location` relation) and\n * with subjects (`subject` relation). This function enumerates information on all of the\n * things in an album via the relation\n *\n * (x) -> [:subject|:location] -> (:photo) - [:albumId] -> (id:album)\n */\nexport function readThingsByAlbumId(tdb: TribbleDB, id: string) {\n  return readThingsByPhotoIds(tdb, readAlbumPhotoIds(tdb, id));\n}\n\nexport function readAlbumsByThingIds(\n  tdb: TribbleDB,\n  thingsUrns: Set<string>,\n) {\n  const photoIds = new Set<string>();\n\n  // first, collect photo-ids associated with the things\n  for (const thingUrn of thingsUrns) {\n    const { type, id } = asUrn(thingUrn);\n\n    const results = tdb.search({\n      //relation: KnownRelations.SUBJECT,\n      target: { type, id },\n    }).sources();\n\n    for (const result of results) {\n      photoIds.add(result);\n    }\n  }\n\n  const albumIds = new Set<string>();\n\n  // next, collect album-ids associated with the photos\n  for (const photoId of photoIds) {\n    const pid = asUrn(photoId);\n\n    const results = tdb.search({\n      source: { type: pid.type, id: pid.id },\n      relation: KnownRelations.ALBUM_ID,\n    }).targets();\n\n    for (const result of results) {\n      albumIds.add(result);\n    }\n  }\n\n  return readAlbums(tdb, albumIds);\n}\n\nexport const readAlbum = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(\n    parseAlbum,\n    tdb,\n    id,\n  );\n};\n\nexport const readAlbums = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(parseAlbum, tdb, urns);\n};\n", "import { TribbleDB } from \"@rgrannell1/tribbledb\";\nimport type { TripleObject } from \"@rgrannell1/tribbledb\";\nimport type { Feature } from \"../types.ts\";\nimport { FeatureSchema } from \"./schemas.ts\";\nimport { parseObject } from \"./parser.ts\";\n\n/* */\nexport function parseFeature(\n  _: TribbleDB,\n  feature: TripleObject,\n): Feature | undefined {\n  return parseObject(FeatureSchema, \"feature\", feature);\n}\n", "import { TribbleDB } from \"@rgrannell1/tribbledb\";\nimport { readParsedThing, readParsedThings, readThing, readThings } from \"./things.ts\";\nimport { parseFeature } from \"../parsers/feature.ts\";\n\nexport const readFeature = (\n  tdb: TribbleDB,\n  id: string,\n) => {\n  return readParsedThing(\n    parseFeature,\n    tdb,\n    id,\n  );\n};\n\nexport const readFeatures = (\n  tdb: TribbleDB,\n  urns: Set<string>,\n) => {\n  return readParsedThings(\n    parseFeature,\n    tdb,\n    urns,\n  );\n};\n", "import { State } from \"./types.ts\";\nimport { DarkModes } from \"./services/dark-mode.ts\";\nimport { loadTriples } from \"./semantic/data.ts\";\nimport { deriveTriples, HARD_CODED_TRIPLES } from \"./semantic/derive.ts\";\nimport { TribbleDB } from \"@rgrannell1/tribbledb\";\n\nimport { readAlbum, readAlbumsByThingIds } from \"./services/albums.ts\";\nimport {\n  readAmphibian,\n  readInsect,\n  readMammal,\n  readReptile,\n} from \"./services/subjects.ts\";\nimport {\n  readPhotos,\n  readPhoto,\n  readPhotosByThingIds,\n} from \"./services/photos.ts\";\nimport { readThing, readThings, toThingLinks } from \"./services/things.ts\";\nimport {\n  readCountry,\n  readLocation,\n  readLocations,\n  readUnescos,\n  readPlace,\n  readUnesco,\n} from \"./services/location.ts\";\nimport { readVideo } from \"./services/videos.ts\";\nimport { readFeatures } from \"./services/features.ts\";\n\n/*\n * Load data from the tribbles file.\n */\nasync function loadData() {\n  const schema = {};\n  const db = await loadTriples(\n    `/manifest/tribbles.${window.envConfig.publication_id}.txt`,\n    schema,\n    deriveTriples,\n  );\n\n  db.add(HARD_CODED_TRIPLES);\n\n  return db;\n}\n\n/*\n * Commonly used services that depend on state\n *\n * TODO come on, this is silly.\n */\nexport function loadServices(tdb: TribbleDB) {\n  return {\n    readThing: readThing.bind(null, tdb),\n    readAlbum: readAlbum.bind(null, tdb),\n    readCountry: readCountry.bind(null, tdb),\n    readPlace: readPlace.bind(null, tdb),\n    readPhoto: readPhoto.bind(null, tdb),\n    readMammal: readMammal.bind(null, tdb),\n    readReptile: readReptile.bind(null, tdb),\n    readAmphibian: readAmphibian.bind(null, tdb),\n    readInsect: readInsect.bind(null, tdb),\n    readVideo: readVideo.bind(null, tdb),\n    readLocation: readLocation.bind(null, tdb),\n    readUnesco: readUnesco.bind(null, tdb),\n    readLocations: readLocations.bind(null, tdb),\n    readFeatures: readFeatures.bind(null, tdb),\n    readPhotos: readPhotos.bind(null, tdb),\n    readUnescos: readUnescos.bind(null, tdb),\n    readThings: readThings.bind(null, tdb),\n    readPhotosByThingIds: readPhotosByThingIds.bind(null, tdb),\n    readAlbumsByThingIds: readAlbumsByThingIds.bind(null, tdb),\n    toThingLinks: toThingLinks.bind(null, tdb),\n  };\n}\n\n/*\n * Load the application state from localStorage or return defaults.\n */\nexport async function loadState(): Promise<State> {\n  const data = await loadData();\n  return {\n    darkMode: DarkModes.load(),\n    sidebarVisible: false,\n    data,\n    currentAlbum: undefined,\n    currentPhoto: undefined,\n    currentUrn: undefined,\n    currentType: undefined,\n    services: loadServices(data),\n  };\n}\n", "import m from \"mithril\";\n\ntype SidebarItemAttrs = {\n  name: string;\n  route: string;\n};\n\ntype SidebarAttrs = {\n  visible: boolean;\n};\n\n/*\n * Defines each item in the sidebar\n */\nfunction SidebarItem() {\n  return {\n    view(vnode: m.Vnode<SidebarItemAttrs>) {\n      return m(\"li\", {\n        class: \"sidebar-item\",\n        onclick() {\n          m.route.set(vnode.attrs.route);\n        },\n      }, vnode.attrs.name);\n    },\n  };\n}\n\n/*\n * Defines the app sidebar\n */\nexport function Sidebar() {\n  function classes(visible: boolean) {\n    const cls = [\"photo-sidebar\"];\n    if (visible) {\n      cls.push(\"sidebar-visible\");\n    }\n    return cls.join(\" \");\n  }\n\n  return {\n    view(vnode: m.Vnode<SidebarAttrs>) {\n      return m(\"aside\", { class: classes(vnode.attrs.visible) }, [\n        m(\"nav\", [\n          m(\"ul\", [\n            m(SidebarItem, { name: \"PHOTOS\", route: \"/photos\" }),\n            m(SidebarItem, { name: \"VIDEOS\", route: \"/videos\" }),\n            m(SidebarItem, { name: \"ALBUMS\", route: \"/albums\" }),\n            m(SidebarItem, { name: \"ABOUT\", route: \"/about\" }),\n          ]),\n        ]),\n      ]);\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { AlbumStats } from \"../components/album-stats.ts\";\nimport type { Album } from \"../types.ts\";\nimport { Photos } from \"../services/photos.ts\";\nimport { PhotoAlbumMetadata } from \"../components/photo-album-metadata.ts\";\nimport { PhotoAlbum } from \"../components/photo-album.ts\";\nimport { Windows } from \"../services/window.ts\";\nimport { CountryLink } from \"../components/place-links.ts\";\nimport { block, broadcast } from \"../commons/events.ts\";\nimport { albumYear } from \"../services/albums.ts\";\nimport { asUrn } from \"@rgrannell1/tribbledb\";\n\ntype AlbumsListAttrs = {\n  albums: Album[];\n};\n\nfunction onAlbumClick(id: string, title: string, event: Event) {\n  const parsed = asUrn(id);\n\n  broadcast(\"navigate\", { route: `/album/${parsed.id}`, title });\n  block(event);\n}\n\nfunction drawAlbum(state: { year: number }, album: Album, idx: number) {\n  const loading = Photos.loadingMode(idx);\n\n  const $albumComponents: m.Vnode<\n    unknown,\n    unknown\n  >[] = [];\n\n  // push year header if a new year\n  if (state.year !== albumYear(album)) {\n    state.year = albumYear(album);\n\n    if (state.year !== new Date().getFullYear()) {\n      const $h2 = m(\n        \"h2.album-year-heading\",\n        { key: `year-${state.year}` },\n        state.year.toString(),\n      );\n      $albumComponents.push($h2);\n    }\n  }\n\n  const $countryLinks = album.countries.map((country) => {\n    return m(CountryLink, {\n      country,\n      key: `album-country-${album.id}-${country.id}`,\n      mode: \"flag\",\n    });\n  });\n\n  const $md = m(PhotoAlbumMetadata, {\n    title: album.name,\n    minDate: album.minDate,\n    maxDate: album.maxDate,\n    count: album.photosCount,\n    countryLinks: $countryLinks,\n  });\n\n  const $album = m(PhotoAlbum, {\n    imageUrl: album.thumbnailUrl,\n    thumbnailUrl: album.thumbnailUrl,\n    thumbnailDataUrl: Photos.encodeBitmapDataURL(album.mosaicColours),\n    loading: loading,\n    minDate: album.minDate,\n    onclick: onAlbumClick.bind(null, album.id, album.name),\n  });\n\n  $albumComponents.push(\n    m(\"div\", {\n      key: `album-${album.id}`,\n    }, [\n      $album,\n      $md,\n    ]),\n  );\n\n  return $albumComponents;\n}\n\n/*\n * Construct a list of albums\n */\nfunction AlbumsList() {\n  return {\n    view(vnode: m.Vnode<AlbumsListAttrs>) {\n      const state = { year: 2005 };\n      const { albums } = vnode.attrs;\n\n      const $albumComponents: m.Vnode<\n        unknown,\n        unknown >[] = [];\n\n      // TODO this blocks render too long\n      for (let idx = 0; idx < albums.length; idx++) {\n        $albumComponents.push(...drawAlbum(state, albums[idx], idx));\n      }\n\n      return m(\"section.album-container\", $albumComponents);\n    },\n  };\n}\n\ntype AlbumsPageState = {\n  albums: Album[];\n};\n\n/* */\nexport function AlbumsPage() {\n  return {\n    oninit() {\n      Windows.setTitle(\"Albums - photos\");\n    },\n    view(vnode: m.Vnode<AlbumsPageState>) {\n      const { albums } = vnode.attrs;\n\n      const $md = m(\"section.album-metadata\", [\n        m(\"h1.albums-header\", \"Albums\"),\n        m(AlbumStats),\n      ]);\n\n      return m(\"div\", [\n        $md,\n        //m(YearCursor),\n        m(AlbumsList, { albums }),\n      ]);\n    },\n  };\n}\n", "import m from \"mithril\";\nimport type { AppWindow, Stats } from \"../types\";\n\n/*\n * We inject this in at runtime, so validate its structure\n */\nfunction isStats(stats: unknown): stats is Stats {\n  if (typeof stats !== \"object\" || stats === null) {\n    console.warn(\"Stats is not an object\");\n  }\n\n  const keys = [\n    \"photos\",\n    \"videos\",\n    \"albums\",\n    \"years\",\n    \"countries\",\n    \"bird_species\",\n    \"mammal_species\",\n    \"amphibian_species\",\n    \"reptile_species\",\n    \"unesco_sites\",\n  ] as const;\n\n  for (const key of keys) {\n    if (!(key in stats)) {\n      console.warn(`Stats is missing key: ${key}`);\n    }\n\n    if (typeof (stats as Record<string, unknown>)[key] !== \"number\") {\n      console.warn(`Stats key ${key} is not a number`);\n    }\n  }\n\n  return true;\n}\n\n/*\n * Show statistics and links for the album pages\n */\nexport function AlbumStats() {\n  const stats = (window as AppWindow).stats;\n\n  return {\n    view() {\n      if (!isStats(stats)) {\n        return m(\"p\");\n      }\n\n      return m(\"p.photo-stats\", [\n        `${stats.photos} `,\n        m(\"a\", { href: \"#/photos\" }, \"photos\"),\n        \" \u00B7 \",\n        `${stats.videos} `,\n        m(\"a\", { href: \"#/videos\" }, \"videos\"),\n        \" \u00B7 \",\n        `${stats.albums} albums \u00B7 ${stats.years} years \u00B7 `,\n        `${stats.countries} `,\n        m(\"a\", { href: \"#/listing/country\" }, \"countries\"),\n        \" \u00B7 \",\n        `${stats.bird_species} `,\n        m(\"a\", { href: \"#/listing/bird\" }, \"bird species\"),\n        \" \u00B7 \",\n        `${stats.mammal_species} `,\n        m(\"a\", { href: \"#/listing/mammal\" }, \"mammal species\"),\n        \" \u00B7 a few \",\n        m(\"a\", { href: \"#/listing/amphibian\" }, \"amphibians\"),\n        \" and \",\n        m(\"a\", { href: \"#/listing/reptile\" }, \"reptiles\"),\n        \" \u00B7 \",\n        `${stats.unesco_sites} `,\n        m(\"a\", { href: \"#/thing/unesco:*\" }, \"UNESCO sites\"),\n      ]);\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { Windows } from \"../services/window.ts\";\nimport { Dates } from \"../services/dates.ts\";\nimport type { CountryLinkAttrs } from \"./place-links.ts\";\n\nexport type PhotoAlbumMetadataAttrs = {\n  title: string;\n  minDate?: number;\n  maxDate?: number;\n  count: number;\n  countryLinks: m.Vnode<CountryLinkAttrs, unknown>[];\n};\n\n/* */\nexport function PhotoAlbumMetadata() {\n  function dateRange(minDate?: number, maxDate?: number) {\n    if (!minDate || !maxDate) {\n      return \"unknown date\";\n    }\n\n    // TODO correct types\n    const isSmall = Windows.isSmallerThan(500);\n    return Dates.dateRange(minDate, maxDate, isSmall);\n  }\n\n  return {\n    view(vnode: m.Vnode<PhotoAlbumMetadataAttrs>) {\n      const { title, minDate, maxDate, count, countryLinks } = vnode.attrs;\n      const text = count === 1 ? \"photo\" : \"photos\";\n\n      return m(\"div.photo-album-metadata\", [\n        m(\"p.photo-album-title\", title),\n        m(\"p.photo-album-date\", [\n          m(\"time\", dateRange(minDate, maxDate)),\n        ]),\n        m(\"div.photo-metadata-inline\", [\n          m(\"p.photo-album-count\", `${count} ${text}`),\n          m(\"p.photo-album-countries\", countryLinks),\n        ]),\n      ]);\n    },\n  };\n}\n", "/*\n * Window lookup\n */\nexport class Windows {\n  /*\n   * Check if the window is smaller than a given width\n   * used to detect a mobile device\n   */\n  static isSmallerThan(width: number = 500): boolean {\n    return globalThis.matchMedia(`(max-width: ${width}px)`).matches;\n  }\n\n  /*\n   * Set the page's title\n   */\n  static setTitle(title: string) {\n    document.title = title;\n  }\n}\n", "export class Dates {\n  /* */\n  static parse(dateTime: string): Date {\n    let [date, time] = dateTime.split(\" \");\n    date = date.replace(/:/g, \"-\");\n\n    return new Date(`${date} ${time}`);\n  }\n  /* */\n  static formatExifDate(dateTime: string): string {\n    if (!dateTime) {\n      return dateTime;\n    }\n\n    const createdAt = new Date(dateTime).toISOString();\n    const [date, time] = createdAt.split(\"T\")[0].replace(/\\:/g, \"-\");\n\n    return `${date.replace(/\\:/g, \"/\")} ${time}`;\n  }\n  /* */\n  static formatCreatedAt(dateTime: string): string {\n    const date = new Date(parseInt(dateTime));\n    const options = {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\",\n      hour: \"numeric\",\n      minute: \"numeric\",\n    };\n\n    return date.toLocaleDateString(\"en-US\", options);\n  }\n  /* */\n  static dateRange(\n    minDate: Date | string,\n    maxDate: Date | string,\n    smallDevice: boolean,\n  ): string {\n    if (!minDate && !maxDate) {\n      return \"unknown date\";\n    }\n\n    const parsedMinDate = minDate instanceof Date\n      ? minDate\n      : new Date(parseFloat(minDate));\n    const parsedMaxDate = maxDate instanceof Date\n      ? maxDate\n      : new Date(parseFloat(maxDate));\n\n    if (smallDevice) {\n      const optsShort: Intl.DateTimeFormatOptions = {\n        day: \"numeric\",\n        month: \"short\",\n      };\n      const from = parsedMinDate.toLocaleDateString(\"en-IE\", optsShort);\n      const to = parsedMaxDate.toLocaleDateString(\"en-IE\", optsShort);\n\n      const minDay = parsedMinDate.toLocaleDateString(\"en-IE\", {\n        day: \"numeric\",\n      } as Intl.DateTimeFormatOptions);\n      const maxDay = parsedMaxDate.toLocaleDateString(\"en-IE\", {\n        day: \"numeric\",\n      } as Intl.DateTimeFormatOptions);\n\n      const minMonth = parsedMinDate.toLocaleDateString(\"en-IE\", {\n        month: \"short\",\n      } as Intl.DateTimeFormatOptions);\n      const maxMonth = parsedMaxDate.toLocaleDateString(\"en-IE\", {\n        month: \"short\",\n      } as Intl.DateTimeFormatOptions);\n\n      const minYear = parsedMinDate.getFullYear();\n      const maxYear = parsedMaxDate.getFullYear();\n\n      const monthsEqual = minMonth === maxMonth;\n      const yearsEqual = minYear === maxYear;\n\n      if (from === to) {\n        // e.g 22 Feb 2022\n        return `${from} ${minYear}`;\n      } else if (monthsEqual && yearsEqual) {\n        // e.g 22 - 24 Feb 2022\n\n        return `${minDay} - ${maxDay} ${maxMonth} ${minYear}`;\n      } else {\n        return `${from} ${minYear} - ${to} ${maxYear}`;\n      }\n    } else {\n      const opts: Intl.DateTimeFormatOptions = {\n        year: \"numeric\",\n        month: \"short\",\n        day: \"numeric\",\n      };\n      const from = parsedMinDate.toLocaleDateString(\"en-IE\", opts);\n      const to = parsedMaxDate.toLocaleDateString(\"en-IE\", opts);\n\n      if (from === to) {\n        return from;\n      }\n\n      return `${from} \u2014 ${to}`;\n    }\n  }\n}\n", "import m from \"mithril\";\nimport { ImagePair } from \"./photo.ts\";\n\nexport type PhotoAlbumAttrs = {\n  imageUrl: string;\n  thumbnailUrl: string;\n  thumbnailDataUrl: string;\n  loading: \"eager\" | \"lazy\";\n  child?: m.Children;\n  onclick?: (e: Event) => void;\n  minDate?: number;\n};\n\n/* */\nexport function PhotoAlbum() {\n  return {\n    view(vnode: m.Vnode<PhotoAlbumAttrs>) {\n      const {\n        imageUrl,\n        thumbnailUrl,\n        thumbnailDataUrl,\n        loading,\n        child,\n        minDate,\n        onclick,\n      } = vnode.attrs;\n\n      return m(\"div.photo-album\", { \"data-min-date\": minDate }, [\n        m(ImagePair, {\n          imageUrl,\n          thumbnailUrl,\n          thumbnailDataUrl,\n          loading,\n          onclick,\n        }),\n        // TODO this is broken\n        child,\n      ]);\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { parseUrn } from \"@rgrannell1/tribbledb\";\n\nimport { block, broadcast } from \"../commons/events.ts\";\nimport { MetadataIcon } from \"./metadata-icon.ts\";\nimport { PHOTO_HEIGHT, PHOTO_WIDTH } from \"../constants.ts\";\nimport { Photos } from \"../services/photos.ts\";\nimport type { Photo as PhotoType } from \"../types.ts\";\n\n/*\n * Broadcast an event when a photo loads, and swap out the placeholder\n */\nfunction loadImage(url: string, event: Event) {\n  broadcast(\"photo_loaded\", { url });\n\n  const $placeholder = (event.target as HTMLElement)?.parentNode\n    ?.querySelector(\n      \".thumbnail-placeholder\",\n    ) as HTMLElement;\n\n  if (!$placeholder) {\n    return;\n  }\n\n  $placeholder.style.zIndex = \"-1\";\n}\n\ntype ImageAttrs = {\n  thumbnailUrl: string;\n  loading: \"eager\" | \"lazy\";\n  onclick?: (e: Event) => void;\n};\n\n/*\n * The thumbnail image itself\n */\nfunction Image() {\n  return {\n    view(vnode: m.Vnode<ImageAttrs>) {\n      const { thumbnailUrl, loading, onclick } = vnode.attrs;\n\n      return m(\"img.thumbnail-image\", {\n        onload: loadImage.bind(null, thumbnailUrl),\n        width: PHOTO_WIDTH,\n        height: PHOTO_HEIGHT,\n        src: thumbnailUrl,\n        loading: loading,\n        onclick,\n      });\n    },\n  };\n}\n\ntype PlaceholderImageAttrs = {\n  thumbnailDataUrl: string;\n};\n\n/*\n * The placeholder data URL\n */\nfunction PlaceholderImage() {\n  return {\n    view(vnode: m.Vnode<PlaceholderImageAttrs>) {\n      const { thumbnailDataUrl } = vnode.attrs;\n\n      return m(\"img.u-photo.thumbnail-image.thumbnail-placeholder\", {\n        width: PHOTO_WIDTH,\n        height: PHOTO_HEIGHT,\n        src: thumbnailDataUrl,\n      });\n    },\n  };\n}\n\ntype ImagePairAttrs = {\n  fullImage: string;\n  thumbnailUrl: string;\n  thumbnailDataUrl: string;\n  loading: \"eager\" | \"lazy\";\n  onclick?: (e: Event) => void;\n};\n\n/*\n * The underlying pair of images. One is the actual thumbnail, which\n * takes time to load. The other will be a grid data URL that instantly loads.\n */\nexport function ImagePair() {\n  return {\n    view(vnode: m.Vnode<ImagePairAttrs>) {\n      const {\n        fullImage,\n        thumbnailUrl,\n        thumbnailDataUrl,\n        loading,\n        onclick,\n      } = vnode.attrs;\n\n      return m(\"a\", {\n        href: fullImage,\n        target: \"_blank\",\n        rel: \"external\",\n      }, [\n        m(PlaceholderImage, { thumbnailDataUrl }),\n        m(Image, { thumbnailUrl, loading, onclick }),\n      ]);\n    },\n  };\n}\n\n/* */\nfunction formatId(id: string): string {\n  return id.startsWith(\"urn:\") ? parseUrn(id).id : id;\n}\n\nexport type PhotoAttrs = {\n  photo: PhotoType;\n  loading: \"eager\" | \"lazy\";\n  interactive?: boolean;\n};\n\n/*\n * Represents a photo, with a metadata link and the fake-progressive-loading\n * features (https://rgrannell.xyz/replacing-google-photos) to make images appear blank for\n * less time.\n */\nexport function Photo() {\n  return {\n    view(vnode: m.Vnode<PhotoAttrs>) {\n      const { photo, loading, interactive } = vnode.attrs;\n      const id = formatId(photo.id);\n      const {\n        fullImage,\n        thumbnailUrl,\n        mosaicColours,\n      } = photo;\n\n      // encode a grid of colours into a data URL\n      const thumbnailDataUrl = Photos.encodeBitmapDataURL(mosaicColours);\n\n      const $mdIcon = m(MetadataIcon, { id });\n      const $imagePair = m(ImagePair, {\n        fullImage,\n        thumbnailUrl,\n        thumbnailDataUrl,\n        loading,\n      });\n\n      return m(\n        \"div\",\n        m(\"div.photo\", {}, [\n          m(\n            \"a\",\n            { onclick: block },\n            interactive\n              ? [\n                $mdIcon,\n                $imagePair,\n              ]\n              : [$imagePair],\n          ),\n        ]),\n      );\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { broadcast } from \"../commons/events.ts\";\n\n/* */\nfunction InfoSVG() {\n  return m(\"svg.photo-icon\", {\n    height: 40,\n    width: 40,\n    preserveAspectRatio: \"xMinYMin\",\n    viewBox: \"-2 -2 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n  }, [\n    m(\"path\", {\n      d: \"m10 20c-5.523 0-10-4.477-10-10s4.477-10 10-10 10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm0-10a1 1 0 0 1 1 1v5a1 1 0 0 1 -2 0v-5a1 1 0 0 1 1-1zm0-1a1 1 0 1 1 0-2 1 1 0 0 1 0 2z\",\n    }),\n  ]);\n}\n\ntype MetadataIconAttrs = {\n  id: string;\n};\n\n/* */\nexport function MetadataIcon() {\n  return {\n    view(vnode: m.Vnode<MetadataIconAttrs>) {\n      const { id } = vnode.attrs;\n\n      return m(\"div.photo-metadata-popover\", {\n        onclick: () => broadcast(\"navigate\", { route: `/photo/${id}` }),\n      }, InfoSVG());\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { urnToUrl } from \"../models/urn.ts\";\nimport { asUrn } from \"@rgrannell1/tribbledb\";\nimport { navigate } from \"../commons/events.ts\";\nimport { isACountry } from \"../types.ts\";\nimport type { Country, Place } from \"../types.ts\";\nimport { one } from \"../commons/arrays.ts\";\nimport { countryEmoji, placeEmoji } from \"../services/emoji.ts\";\n\nexport type CountryLinkAttrs = {\n  country: Country;\n  mode: \"flag\" | \"name\";\n};\n\n/*\n * Construct a link to a country. Reuse existing emoji lookup logic\n */\nexport function CountryLink() {\n  return {\n    view(vnode: m.Vnode<CountryLinkAttrs>) {\n      const { country, mode } = vnode.attrs;\n      const { id, name } = country;\n\n      if (!id) {\n        return m(\"p\");\n      }\n\n      const flag = countryEmoji(country);\n\n      const parsed = asUrn(id);\n      const onclick = navigate(`/thing/${parsed.type}:${parsed.id}`);\n\n      if (mode === \"flag\") {\n        return m(\"a.country-link-short\", { href: urnToUrl(id), onclick }, flag);\n      }\n\n      return m(\n        \"a.country-link\",\n        { href: urnToUrl(id), onclick },\n        `${flag} ${name}`,\n      );\n    },\n  };\n}\n\n/*\n * Create a link to a place. Reuse existing emoji lookup logic\n */\nexport function PlaceLink() {\n  return {\n    view(vnode: m.Vnode<{ location: Place; mode: \"flag\" | \"name\" }>) {\n      const { location, mode } = vnode.attrs;\n\n      let text = \"\";\n      if (mode === \"flag\") {\n        text = placeEmoji(location);\n      }\n\n      text = `${placeEmoji(location)} ${one(location.name) || \"Unknown Place\"}`;\n\n      return m(\"a.place-link\", {\n        href: urnToUrl(location.id),\n        onclick: navigate(`/thing/place:${location.id}`),\n      }, text);\n    },\n  };\n}\n\n/*\n * Create a link to a country / place\n */\nexport function LocationLink() {\n  return {\n    view(vnode: m.Vnode<{ location: Country | Place; mode: \"flag\" | \"name\" }>) {\n      const { location, mode } = vnode.attrs;\n\n      if (isACountry(location)) {\n        return m(CountryLink, { country: location, mode });\n      }\n\n      return m(PlaceLink, { location, mode });\n    },\n  };\n}\n", "import { asUrn } from \"@rgrannell1/tribbledb\";\n\n/*\n * Convert a URN into a URL for the thing page.\n */\nexport function urnToUrl(urn: string) {\n  const { type, id } = asUrn(urn);\n  return `#/thing/${type}:${id}`;\n}\n", "import m from \"mithril\";\n\nimport { Windows } from \"../services/window.ts\";\nimport { navigate } from \"../commons/events.ts\";\n\n/* */\nexport function AboutPage() {\n  return {\n    oninit() {\n      Windows.setTitle(\"About - photos\");\n    },\n    view() {\n      const years = new Date().getFullYear() - 2012;\n\n      return m(\"div\", [\n        m(\"section.about-page\", [\n          m(\"h1\", \"About\"),\n          m(\n            \"p\",\n            `I started taking photos ${years} years ago, and have taken a lot of photos since. I've become, in my opinion, a reasonable wildlife photographer (though hit-or-miss at other styles of photography). I built this website to share the things`,\n            m(\"a\", {\n              href: \"https://photos.rgrannell.xyz/#/thing/rating:\u2B50\u2B50\u2B50\u2B50\u2B50\",\n              onclick: navigate(`/thing/rating:\u2B50\u2B50\u2B50\u2B50\u2B50`),\n            }, \" I found beautiful in this world.\"),\n          ),\n          m(\"h2\", \"Can I use the photos on this site?\"),\n          m(\n            \"p\",\n            \"You may use this website and its content for personal, non-commerical purposes only. For example, using photos as a desktop wallpaper is fine, selling these photos is not.\",\n          ),\n          m(\"h2\", \"Can I use data from this site to train AI?\"),\n          m(\n            \"p\",\n            \"No, absolutely not. The \",\n            m(\n              \"a\",\n              { href: \"http://photos.rgrannell.xyz/robots.txt\" },\n              \"robots.txt\",\n            ),\n            \" file for this site explicitly prohibits this.\",\n          ),\n          m(\"h2\", \"What is your contact information?\"),\n          m(\n            \"p\",\n            \"See \",\n            m(\"a\", { href: \"https://rgrannell.xyz/\" }, \"my personal site\"),\n            \" for contact details.\",\n          ),\n        ]),\n      ]);\n    },\n  };\n}\n", "import m from \"mithril\";\nimport type { Video as VideoType } from \"../types.ts\";\nimport { Video } from \"../components/video.ts\";\nimport type { VideoAttrs } from \"../components/video.ts\";\n\ntype VideosPageAttrs = {\n  videos: VideoType[];\n};\n\n/* */\nexport function VideosPage() {\n  return {\n    view(vnode: m.Vnode<VideosPageAttrs>) {\n      const { videos } = vnode.attrs;\n      const videoLengthText = videos.length === 1\n        ? \"1 video\"\n        : `${videos.length} videos`;\n\n      const $videosList = videos.map((video) => {\n        return m(Video, { video, preload: \"auto\" } satisfies VideoAttrs);\n      });\n\n      return m(\n        \"div\",\n        m(\"section.photos-metadata\", [\n          m(\"h1\", \"Videos\"),\n          m(\"p.photo-album-count\", videoLengthText),\n        ]),\n        m(\"section.photo-container\", $videosList),\n      );\n    },\n  };\n}\n", "import m from \"mithril\";\nimport type { Video } from \"../types\";\n\nexport type VideoAttrs = {\n  preload: string;\n  video: Video;\n};\n\n/* */\nexport function Video() {\n  return {\n    view(vnode: m.Vnode<VideoAttrs>) {\n      const {\n        preload,\n        video,\n      } = vnode.attrs;\n\n      if (!video) {\n        return m(\"div\", \"No video\");\n      }\n\n      const {\n        posterUrl,\n        videoUrl1080p,\n        videoUrl480p,\n        videoUrl720p,\n        videoUrlUnscaled,\n      } = video;\n\n      const $source = m(\"source\", {\n        src: videoUrl480p,\n        type: \"video/mp4\",\n      });\n\n      const $resolutionLinks = m(\"ul\", [\n        m(\"a\", { href: videoUrlUnscaled }, \"[L]\"),\n        m(\"a\", { href: videoUrl1080p }, \"[M]\"),\n        m(\"a\", { href: videoUrl720p }, \"[S]\"),\n        m(\"a\", { href: videoUrl480p }, \"[XS]\"),\n      ]);\n\n      return m(\"div\", { key: `video-${video.id}` }, [\n        m(\"video.thumbnail-video\", {\n          controls: true,\n          preload,\n          poster: posterUrl,\n        }, $source),\n        $resolutionLinks,\n      ]);\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { Windows } from \"../services/window.ts\";\nimport { Dates } from \"../services/dates.ts\";\nimport { AlbumShareButton } from \"../components/album-share-button.ts\";\nimport { CountryLink } from \"../components/place-links.ts\";\nimport { Video } from \"../components/video.ts\";\nimport type { VideoAttrs } from \"../components/video.ts\";\n\nimport type {\n  Album,\n  Country,\n  Photo as PhotoType,\n  Thing,\n  Video as VideoType,\n} from \"../types.ts\";\nimport { Photo } from \"../components/photo.ts\";\nimport type { PhotoAttrs } from \"../components/photo.ts\";\nimport { Photos } from \"../services/photos.ts\";\nimport { AlbumsButton } from \"../components/albums-button.ts\";\nimport { AlbumThings } from \"../components/album-things.ts\";\n\n// TODO replace with album type\ntype AlbumAttrs = {\n  album: Album;\n  countries: Country[];\n  videos: VideoType[];\n  photos: PhotoType[];\n  subjects: Thing[];\n  locations: Thing[];\n};\n\n/* */\nexport function AlbumPage() {\n  return {\n    oninit() {\n      Windows.setTitle(\"Album - photos\");\n    },\n    view(vnode: m.Vnode<AlbumAttrs>) {\n      const {\n        album,\n        photos,\n        videos,\n        subjects,\n        locations,\n      } = vnode.attrs;\n      const {\n        name,\n        minDate,\n        maxDate,\n        photosCount,\n        description,\n        countries,\n      } = album;\n\n      const dateRange = Dates.dateRange(\n        minDate,\n        maxDate,\n        Windows.isSmallerThan(500),\n      );\n\n      const photoCountMessage = photosCount === 1\n        ? \"1 photo\"\n        : `${photosCount} photos`;\n\n      const $countryLinks = countries.map((country) => {\n        return m(CountryLink, {\n          country,\n          mode: \"flag\",\n        });\n      });\n\n      const $albumMetadata = m(\"section.photos-metadata\", [\n        m(\"h1\", name),\n        m(\"p.photo-album-date\", m(\"time\", dateRange)),\n        m(\"p.photo-album-count\", photoCountMessage),\n        m(\"p.photo-album-countries\", $countryLinks),\n        m(\"p.photo-album-description\", m.trust(description ?? \"\")),\n        m(AlbumShareButton, { url: location.href, name }),\n        \" \",\n        m(AlbumsButton),\n        \" \",\n        m(AlbumThings, { subjects, locations }),\n      ]);\n\n      const $photosList = photos.map((photo, idx) => {\n        return m(\n          Photo,\n          {\n            photo,\n            loading: Photos.loadingMode(idx),\n            interactive: true,\n          } satisfies PhotoAttrs,\n        );\n      });\n      const $videosList = videos.map((video) => {\n        return m(Video, { ...video, preload: \"auto\" } satisfies VideoAttrs);\n      });\n\n      return m(\n        \"div\",\n        $albumMetadata,\n        m(\"section.photo-container\", $photosList),\n        m(\"section.video-container\", $videosList),\n      );\n    },\n  };\n}\n", "import m from \"mithril\";\n\ntype AlbumShareButtonAttrs = {\n  url: string;\n  name: string;\n};\n\n/* */\nfunction handleError(message: string) {\n  if (message.includes(\"Shared canceled\")) {\n    return;\n  }\n  alert(message);\n}\n\n/* */\nasync function shareAlbum(\n  state: { sharing: boolean },\n  url: string,\n  name: string,\n) {\n  if (!navigator.share) {\n    handleError(\"navigator.share not available\");\n    return;\n  }\n\n  try {\n    await navigator.share({\n      title: `${name} - photos.rgrannell.xyz`,\n      url,\n    });\n  } catch (error) {\n    console.error(\"Error sharing:\", error);\n  } finally {\n    state.sharing = false;\n  }\n}\n\n/* */\nfunction buttonText(state: { sharing: boolean }) {\n  return state.sharing ? \"[sharing...]\" : \"[share]\";\n}\n\n/* */\nexport function AlbumShareButton() {\n  const localState = {\n    sharing: false,\n  };\n\n  return {\n    view(vnode: m.Vnode<AlbumShareButtonAttrs>) {\n      const { url, name } = vnode.attrs;\n\n      return m(\"button.photo-share-button\", {\n        disabled: !navigator.share,\n        onclick: shareAlbum.bind(null, localState, url, name),\n      }, buttonText(localState));\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { navigate } from \"../commons/events\";\n\n/*\n * Links back to the albums page\n */\nexport function AlbumsButton() {\n  return {\n    view() {\n      return m(\n        \"a\",\n        { href: \"/albums\", onclick: navigate(`/albums`) },\n        \"[albums]\",\n      );\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { Thing } from \"../types\";\n\ntype AlbumThingsAttrs = {\n  locations: Thing[];\n  subjects: Thing[];\n};\n\n/* */\nexport function AlbumThings() {\n  return {\n    view(vnode: m.Vnode<AlbumThingsAttrs>) {\n      const { locations, subjects } = vnode.attrs;\n\n      // TODO\n    },\n  };\n}\n", "import m from \"mithril\";\nimport type { Photo as PhotoType } from \"../types.ts\";\nimport { Photos } from \"../services/photos.ts\";\nimport { Photo } from \"../components/photo.ts\";\n\n/* */\nfunction PhotosList() {\n  return {\n    view(vnode: m.Vnode<PhotosPageAttrs>) {\n      const { photos } = vnode.attrs;\n\n      // TODO: load photos lazily\n      return m(\n        \"section.photo-container\",\n        photos.map((photo, idx) => {\n          const loading = Photos.loadingMode(idx);\n\n          return m(Photo, {\n            key: `photo-${photo.id}`,\n            photo,\n            loading,\n            interactive: true,\n          });\n        }),\n      );\n    },\n  };\n}\n\ntype PhotosPageAttrs = {\n  photos: PhotoType[];\n};\n\n/* */\nexport function PhotosPage() {\n  return {\n    view(vnode: m.Vnode<PhotosPageAttrs>) {\n      const { photos } = vnode.attrs;\n\n      const countText = `${photos.length} photo${\n        photos.length === 1 ? \"\" : \"s\"\n      }`;\n\n      const $md = m(\"section.photos-metadata\", [\n        m(\"h1\", \"Photos\"),\n        m(\"p.photo-album-count\", countText),\n      ]);\n\n      return m(\"div\", [$md, m(PhotosList, { photos })]);\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { Photo } from \"../components/photo.ts\";\nimport type { Photo as PhotoType, Services } from \"../types.ts\";\nimport { AlbumButton } from \"../components/album-button.ts\";\nimport { ExifData } from \"../components/exif-data.ts\";\nimport { PhotoInfo } from \"../components/photo-info.ts\";\n\ntype PhotoPageAttrs = {\n  photo: PhotoType;\n  services: Services;\n};\n\n/* */\nexport function PhotoPage() {\n  return {\n    view(vnode: m.Vnode<PhotoPageAttrs>) {\n      const { photo, services } = vnode.attrs;\n\n      const $links = m(\"p\", [\n        m(\"a\", { href: photo.fullImage, rel: \"noreferrer\" }, \"[webp]\"),\n        \" \",\n        m(\"a\", { href: photo.pngUrl, rel: \"noreferrer\" }, \"[png]\"),\n        \" \",\n        // [share]\n        m(AlbumButton, { id: photo.albumId }),\n      ]);\n\n      const $exif = m(ExifData, { photo, services });\n      const $photoInfo = m(PhotoInfo, { photo, services });\n\n      return m(\"section\", [\n        m(\"h1\", \"Photo\"),\n        m(Photo, {\n          photo,\n          loading: \"eager\",\n          interactive: false,\n        }),\n        $links,\n        m(\n          \"div\",\n          m(\"h3\", \"Photo Information\"),\n          $photoInfo,\n          m(\"h3\", \"Exif Data\"),\n          $exif,\n        ),\n      ]);\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { navigate } from \"../commons/events\";\n\ntype AlbumButtonAttrs = {\n  id: string;\n};\n\n/*\n * Links back to the last album page\n */\nexport function AlbumButton() {\n  return {\n    view(vnode: m.Vnode<AlbumButtonAttrs>) {\n      const { id } = vnode.attrs;\n\n      return m(\"a\", {\n        href: `#/album/${id}`,\n        onclick: () => navigate(`/album/${id}`),\n      }, \"[album]\");\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { Dates } from \"../services/dates.ts\";\nimport type { Photo as PhotoType, Services } from \"../types.ts\";\n\ntype ExifDataAttrs = {\n  photo: PhotoType;\n  services: Services;\n};\n\ntype HeadingAttrs = {\n  text: string;\n};\n\n/* */\nfunction Heading() {\n  return {\n    view(vnode: m.Vnode<HeadingAttrs>) {\n      const { text } = vnode.attrs;\n      return m(\"th.exif-heading\", text);\n    },\n  };\n}\n\n/* */\nfunction CameraModel() {\n  return {\n    view(vnode: m.Vnode<ExifDataAttrs>) {\n      const { photo, services } = vnode.attrs;\n\n      const $model = services.toThingLinks([photo.model]);\n      if ($model.length > 0) {\n        return m(\"td\", $model);\n      }\n\n      return m(\"td\", \"Unknown\");\n    },\n  };\n}\n\nfunction ExifDimensions() {\n  return {\n    view(vnode: m.Vnode<ExifDataAttrs>) {\n      const { photo } = vnode.attrs;\n\n      if (typeof photo.width === \"string\" && typeof photo.height === \"string\") {\n        return m(\"td\", `${photo.width} x ${photo.height}`);\n      }\n\n      return m(\"td\", \"Unknown\");\n    },\n  };\n}\n\nfunction FocalLength() {\n  return {\n    view(vnode: m.Vnode<ExifDataAttrs>) {\n      const { photo } = vnode.attrs;\n      if (photo.focalLength === \"Unknown\") {\n        return m(\"td\", \"Unknown\");\n      } else if (photo.focalLength === \"0\") {\n        return m(\"td\", \"Manual lens\");\n      } else if (!photo.focalLength) {\n        return m(\"td\", \"Unknown\");\n      } else {\n        return m(\"td\", `${photo.focalLength}mm`);\n      }\n    },\n  };\n}\n\nfunction ShutterSpeed() {\n  return {\n    view(vnode: m.Vnode<ExifDataAttrs>) {\n      const { photo } = vnode.attrs;\n      if (typeof photo.exposureTime === \"string\") {\n        const parsed = parseFloat(photo.exposureTime);\n        if (isNaN(parsed)) {\n          return m(\"td\", \"Unknown\");\n        } else if (parsed >= 1) {\n          return m(\"td\", `${parsed} s`);\n        } else {\n          return m(\"td\", `1/${Math.round(1 / parsed)} s`);\n        }\n      }\n\n      return m(\"td\", \"Unknown\");\n    },\n  };\n}\n\nfunction Aperture() {\n  return {\n    view(vnode: m.Vnode<ExifDataAttrs>) {\n      const { photo } = vnode.attrs;\n\n      if (photo.fStop === \"Unknown\") {\n        return m(\"td\", \"Unknown\");\n      } else if (photo.fStop === \"0.0\") {\n        return m(\"td\", \"Manual aperture control\");\n      } else if (!photo.fStop) {\n        return m(\"td\", \"Unknown\");\n      }\n\n      return m(\"td\", `\u0192/${photo.fStop}`);\n    },\n  };\n}\n\nexport function ExifData() {\n  return {\n    view(vnode: m.Vnode<ExifDataAttrs>) {\n      const { photo, services } = vnode.attrs;\n\n      const $dateTime = m(\"tr\", [\n        m(Heading, { text: \"Date-Time\" }),\n        m(\"td\", m(\"time\", Dates.formatCreatedAt(photo.createdAt))),\n      ]);\n\n      const $model = m(\"tr\", [\n        m(Heading, { text: \"Camera Model\" }),\n        m(CameraModel, { photo, services }),\n      ]);\n\n      const $dimensions = m(\"tr\", [\n        m(Heading, { text: \"Dimensions\" }),\n        m(ExifDimensions, { photo, services }),\n      ]);\n\n      const $focalLength = m(\"tr\", [\n        m(Heading, { text: \"Focal Length\" }),\n        m(FocalLength, { photo, services }),\n      ]);\n\n      const $shutterSpeed = m(\"tr\", [\n        m(Heading, { text: \"Shutter Speed\" }),\n        m(ShutterSpeed, { photo, services }),\n      ]);\n\n      const $aperture = m(\"tr\", [\n        m(Heading, { text: \"Aperture\" }),\n        m(Aperture, { photo, services }),\n      ]);\n\n      const $iso = m(\"tr\", [\n        m(Heading, { text: \"ISO\" }),\n        m(\"td\", photo.iso ?? \"Unknown\"),\n      ]);\n\n      return m(\"table.metadata-table\", [\n        $dateTime,\n        $model,\n        $dimensions,\n        $focalLength,\n        $shutterSpeed,\n        $aperture,\n        $iso,\n      ]);\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { Photo as PhotoType, Services } from \"../types.ts\";\nimport { arrayify } from \"../commons/arrays.ts\";\n\ntype HeadingAttrs = {\n  text: string;\n};\n\n/* */\nfunction Heading() {\n  return {\n    view(vnode: m.Vnode<HeadingAttrs>) {\n      const { text } = vnode.attrs;\n      return m(\"th.exif-heading\", text);\n    },\n  };\n}\n\ntype PhotoComponentAttrs = {\n  photo: PhotoType;\n  services: Services;\n};\n\n/* */\nfunction Description() {\n  return {\n    view(vnode: m.Vnode<PhotoComponentAttrs>) {\n      const { photo } = vnode.attrs;\n\n      const html = photo.description ?? photo.summary;\n      if (html) {\n        return m(\"td\", m.trust(html));\n      }\n\n      return m(\"td\", \"\u2014\");\n    },\n  };\n}\n\n/* */\nfunction Location() {\n  return {\n    view(vnode: m.Vnode<PhotoComponentAttrs>) {\n      const { photo, services } = vnode.attrs;\n\n      const $locations = services.toThingLinks(arrayify(photo.location));\n      return m(\"td\", $locations.length > 0 ? $locations : \"\u2014\");\n    },\n  };\n}\n\n/* */\nfunction Rating() {\n  return {\n    view(vnode: m.Vnode<PhotoComponentAttrs>) {\n      const { photo, services } = vnode.attrs;\n\n      const $rating = services.toThingLinks([photo.rating]);\n      return m(\"td\", $rating.length > 0 ? $rating : \"\u2014\");\n    },\n  };\n}\n\n/* */\nfunction Style() {\n  return {\n    view(vnode: m.Vnode<PhotoComponentAttrs>) {\n      const { photo, services } = vnode.attrs;\n\n      const $style = services.toThingLinks([photo.style]);\n      return m(\"td\", $style.length > 0 ? $style : \"\u2014\");\n    },\n  };\n}\n\n/* */\nfunction Subject() {\n  return {\n    view(vnode: m.Vnode<PhotoComponentAttrs>) {\n      const { photo, services } = vnode.attrs;\n\n      const $subject = services.toThingLinks(arrayify(photo.subject));\n      return m(\"td\", $subject.length > 0 ? $subject : \"\u2014\");\n    },\n  };\n}\n\n/* */\nfunction Country() {\n  return {\n    view(vnode: m.Vnode<PhotoComponentAttrs>) {\n      const { photo, services } = vnode.attrs;\n\n      const $countries = services.toThingLinks(arrayify(photo.country));\n      return m(\"td\", $countries.length > 0 ? $countries : \"\u2014\");\n    },\n  };\n}\n\ntype PhotoInfoAttrs = {\n  photo: PhotoType;\n  services: Services;\n};\n\n/* */\nexport function PhotoInfo() {\n  return {\n    view(vnode: m.Vnode<PhotoInfoAttrs>) {\n      const { photo, services } = vnode.attrs;\n\n      const infoItems = [];\n\n      if (photo.description || photo.summary) {\n        infoItems.push(m(\"tr\", [\n          m(Heading, { text: \"Description\" }),\n          m(Description, { photo, services }),\n        ]));\n      }\n\n      infoItems.push(\n        m(\"tr\", [\n          m(Heading, { text: \"Country\" }),\n          m(Country, { photo, services }),\n        ]),\n        m(\"tr\", [\n          m(Heading, { text: \"Location\" }),\n          m(Location, { photo, services }),\n        ]),\n        m(\"tr\", [\n          m(Heading, { text: \"Rating\" }),\n          m(Rating, { photo, services }),\n        ]),\n        m(\"tr\", [\n          m(Heading, { text: \"Style\" }),\n          m(Style, { photo, services }),\n        ]),\n        m(\"tr\", [\n          m(Heading, { text: \"Subject\" }),\n          m(Subject, { photo, services }),\n        ]),\n      );\n\n      return m(\"table.metadata-table\", infoItems);\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { NonListableTypes } from \"../constants.ts\";\nimport { Strings } from \"../commons/strings.ts\";\nimport type { TripleObject } from \"@rgrannell1/tribbledb\";\n\n/*\n * Display the component albums and metadata\n * in the listing page\n */\nfunction AlbumsList() {\n  return {\n    view() {\n      const $albumComponents = [];\n\n      return m(\"section.album-container\", $albumComponents);\n    },\n  };\n}\n\n/*\n * Display a pluralised title for the listing page,\n * e.g \"Countries\"\n */\nfunction ListingTitle() {\n  return {\n    view(vnode: m.Vnode<{ type: string }>) {\n      const { type } = vnode.attrs;\n      return m(\n        \"h1.albums-header\",\n        `${Strings.capitalise(Strings.pluralise(type))}`,\n      );\n    },\n  };\n}\n\n/*\n * Link to the things page for this type (wildcard)\n */\nfunction ListingThingsButton() {\n  return {\n    view(vnode: m.Vnode<{ type: string }>) {\n      const { type } = vnode.attrs;\n      return m(\"a\", {\n        href: `/thing/${type}`,\n      }, `See all ${type} photos`);\n    },\n  };\n}\n\ntype ListingPageAttrs = {\n  type: string;\n  things: TripleObject[];\n};\n\n/*\n * Render the listing page. It shows\n * each member of a category (e.g countries)\n */\nexport function ListingPage() {\n  return {\n    view(vnode: m.Vnode<ListingPageAttrs>) {\n      const { type, things } = vnode.attrs;\n      const $albums = [];\n\n      const $md = [\n        m(ListingTitle, { type }),\n      ];\n\n      if (!NonListableTypes.has(type)) {\n        $md.push(\n          m(\"section.album-metadata\", [\n            m(ListingThingsButton, { type }),\n          ]),\n        );\n      }\n\n      return m(\"div\", [\n        m(\"section.album-metadata\", $md),\n        m(AlbumsList),\n      ]);\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { ThingSubtitle, ThingTitle } from \"../components/thing-title.ts\";\nimport { asUrn } from \"@rgrannell1/tribbledb\";\nimport type { TripleObject } from \"@rgrannell1/tribbledb\";\nimport { ExternalLink } from \"../components/external-link.ts\";\nimport { arrayify, one } from \"../commons/arrays.ts\";\nimport type { Album, Services } from \"../types.ts\";\nimport { CountryLink } from \"../components/place-links.ts\";\nimport { Photo } from \"../components/photo.ts\";\nimport { Photos } from \"../services/photos.ts\";\nimport { PhotoAlbumMetadata } from \"../components/photo-album-metadata.ts\";\nimport { PhotoAlbum } from \"../components/photo-album.ts\";\nimport { block, broadcast } from \"../commons/events.ts\";\nimport { PlacesList } from \"../components/places-list.ts\";\nimport { setify, setOf } from \"../commons/sets.ts\";\nimport { KnownRelations } from \"../constants.ts\";\nimport { ListingLink } from \"../components/listing-link.ts\";\nimport { FeaturesList } from \"../components/features-list.ts\";\nimport { UnescoList } from \"../components/unesco-list.ts\";\n\ntype ThingPageAttrs = {\n  urn: string;\n  things: TripleObject[];\n  services: Services;\n};\n\nfunction ThingPlaces() {\n  return {\n    view() {\n    },\n  };\n}\n\nfunction ThingTypeLink() {\n  return {\n    view() {\n    },\n  };\n}\n\n/*\n * Links to external sites about the thing\n */\nfunction ThingUrls() {\n  return {\n    view(vnode: m.Vnode<ThingPageAttrs>) {\n      const { things } = vnode.attrs;\n\n      if (things.length !== 1) {\n        return m(\"ul\");\n      }\n\n      const [thing] = things;\n      const $links = [];\n\n      const wikipedia = one(thing.wikipedia);\n      if (wikipedia) {\n        $links.push(\n          m(\"li\", m(ExternalLink, { href: wikipedia, text: \"[wikipedia]\" })),\n        );\n      }\n\n      const birdwatch = one(thing.birdwatchUrl);\n      if (birdwatch) {\n        $links.push(\n          m(\"li\", m(ExternalLink, { href: birdwatch, text: \"[birdwatch]\" })),\n        );\n      }\n\n      // -- add google maps URL\n      return m(\"ul.link-list\", $links);\n    },\n  };\n}\n\nfunction ThingMetadata() {\n  return {\n    view(vnode: m.Vnode<ThingPageAttrs>) {\n      const metadata: Record<string, m.Children> = {};\n      const { urn, things, services } = vnode.attrs;\n\n      metadata.Classification = m(ListingLink, { urn });\n\n      const locatedIn = setOf<string>(KnownRelations.IN, things);\n      if (locatedIn.size > 0) {\n        metadata[\"Located In\"] = m(PlacesList, { services, urns: locatedIn });\n      }\n\n      if (things.length !== 1) {\n        return;\n      }\n\n      const [thing] = things;\n      // The non-wildcard case\n\n      if (thing.feature) {\n        metadata[\"Place Features\"] = m(FeaturesList, { urns: setify(thing.feature), services });\n      }\n\n      if (thing.contains) {\n        metadata[\"Contains\"] = m(PlacesList, { services, urns: setify(thing.contains) });\n      }\n\n      if (thing.unescoId) {\n        metadata[\"UNESCO\"] = m(UnescoList, {\n          urns: new Set(arrayify(thing.unescoId)),\n          services,\n        })\n      }\n\n      // TODO add `seen in`, first photographed\n\n      // convert the metadaTa to a table\n\n      const $rows = Object.entries(metadata).map(([key, value]) => {\n        return m(\"tr\", [\n          m(\"th.exif-heading\", key),\n          m(\"td\", value),\n        ]);\n      });\n\n      return m(\"div\", [\n        m(\"h3\", \"Details\"),\n        m(\"table.metadata-table\", $rows),\n      ]);\n    },\n  };\n}\n\nfunction onAlbumClick(id: string, title: string, event: Event) {\n  const parsed = asUrn(id);\n\n  broadcast(\"navigate\", { route: `/album/${parsed.id}`, title });\n  block(event);\n}\n\nfunction AlbumSection() {\n  return {\n    view(vnode: m.Vnode<ThingPageAttrs>) {\n      const { things, services } = vnode.attrs;\n\n      const urns = Object.values(things).flatMap((thing) => arrayify(thing.id));\n      const albums = services.readAlbumsByThingIds(new Set(urns));\n\n      // Broken, with odd mithril child-element issue\n      const $albums = albums.map((album: Album) => {\n        // duplicated model. move to render(model) code\n        const $countryLinks = album.countries.map((country) => {\n          return m(CountryLink, {\n            country,\n            key: `album-country-${album.id}-${country.id}`,\n            mode: \"flag\",\n          });\n        });\n\n        const $md = m(PhotoAlbumMetadata, {\n          title: album.name,\n          minDate: album.minDate,\n          maxDate: album.maxDate,\n          count: album.photosCount,\n          countryLinks: $countryLinks,\n        });\n\n        const $album = m(PhotoAlbum, {\n          imageUrl: album.thumbnailUrl,\n          thumbnailUrl: album.thumbnailUrl,\n          thumbnailDataUrl: Photos.encodeBitmapDataURL(album.mosaicColours),\n          loading: \"lazy\",\n          minDate: album.minDate,\n          onclick: onAlbumClick.bind(null, album.id, album.name),\n        });\n\n        return m(\n          \"div\",\n          { key: `album-${album.id}` },\n          $album,\n          $md,\n        );\n      });\n\n      return m(\n        \"section.album-container\",\n        $albums,\n      );\n    },\n  };\n}\n\nfunction PhotoSection() {\n  return {\n    view(vnode: m.Vnode<ThingPageAttrs>) {\n      const { things, services } = vnode.attrs;\n\n      const urns = setOf<string>(\"id\", things);\n      const photos = services.readPhotosByThingIds(urns);\n\n      return m(\n        \"section.photo-container\",\n        photos.map((photo, idx) => {\n          const loading = Photos.loadingMode(idx);\n\n          return m(Photo, {\n            key: `photo-${photo.id}`,\n            photo,\n            loading,\n            interactive: true,\n          });\n        }),\n      );\n    },\n  };\n}\n\nexport function ThingPage() {\n  return {\n    view(vnode: m.Vnode<ThingPageAttrs>) {\n      const { urn, things, services } = vnode.attrs;\n\n      return m(\"div\", [\n        m(\"section.thing-page\", [\n          m(ThingTitle, { urn, things }),\n          m(ThingSubtitle, { urn }),\n          m(\"br\"),\n          m(ThingUrls, { urn, things, services }),\n          m(ThingMetadata, { urn, things, services }),\n          m(\"h3\", \"Photos\"),\n          m(PhotoSection, { urn, things, services }),\n          m(\"h3\", \"Albums\"),\n          //m(AlbumSection, { urn, things, services }),\n        ]),\n      ]);\n    },\n  };\n}\n", "import { asUrn, parseUrn } from \"@rgrannell1/tribbledb\";\nimport type { TripleObject } from \"@rgrannell1/tribbledb\";\nimport m from \"mithril\";\nimport { Strings } from \"../commons/strings.ts\";\nimport { BinomialTypes, KnownTypes } from \"../constants.ts\";\nimport { one } from \"../commons/arrays.ts\";\nimport { countryEmoji, placeEmoji } from \"../services/emoji.ts\";\n\nfunction computeTitle(urn: string, things: TripleObject[]): string {\n  const parsed = parseUrn(urn);\n\n  // if type:*, fall back to pretty render of type information\n  if (parsed.id === \"*\") {\n    return Strings.capitalise(Strings.pluralise(parsed.type));\n  }\n\n  if (things.length === 0) {\n    return urn;\n  }\n\n  const [thing] = things;\n  const name = one(thing.name) ?? parsed.id;\n\n  if (parsed.type === KnownTypes.COUNTRY) {\n    return `${countryEmoji(thing)} ${name}`;\n  } else if (parsed.type === KnownTypes.PLACE) {\n    return `${placeEmoji(thing)} ${name}`;\n  }\n\n  return name;\n}\n\ntype ThingTitleAttrs = {\n  urn: string;\n  things: TripleObject[];\n};\n\nexport function ThingTitle() {\n  return {\n    view(vnode: m.Vnode<ThingTitleAttrs>) {\n      const { urn, things } = vnode.attrs;\n      return m(\"h1\", computeTitle(urn, things));\n    },\n  };\n}\n\nexport function ThingSubtitle() {\n  return {\n    view(vnode: m.Vnode<{ urn: string }>) {\n      const parsed = asUrn(vnode.attrs.urn);\n\n      return BinomialTypes.has(parsed.type) && parsed.id !== \"*\"\n        ? m(\n          \"span\",\n          { class: `thing-binomial ${parsed.type}-binomial` },\n          Strings.binomial(parsed.id),\n        )\n        : m(\"span\");\n    },\n  };\n}\n", "import m from \"mithril\";\n\nexport function ExternalLink() {\n  return {\n    view(vnode: m.Vnode<{ href: string; text: string }>) {\n      const { href, text } = vnode.attrs;\n      return m(\"a\", {\n        href,\n        target: \"_blank\",\n        rel: \"noopener\",\n      }, text);\n    },\n  };\n}\n", "import m from \"mithril\";\nimport { one } from \"../commons/arrays\";\nimport type { Services } from \"../types\";\nimport { ThingLink } from \"./thing-link\";\n\ntype PlacesListAttrs = {\n  urns: Set<string>;\n  services: Services;\n};\n\nexport function PlacesList() {\n  return {\n    view(vnode: m.Vnode<PlacesListAttrs>) {\n      const { urns, services } = vnode.attrs;\n      const locations = services.readLocations(urns).sort(\n        (loca, locb) => {\n          return (one(loca.name) ?? \"\").localeCompare(one(locb.name) ?? \"\");\n        },\n      );\n\n      const $contains = locations.map((location) => {\n        const $link = m(ThingLink, {\n          urn: one(location.id)!,\n          thing: location,\n        });\n        return m(\"li\", { key: `place-${location.id}` }, $link);\n      });\n\n      return m(\"ul\", $contains);\n    },\n  };\n}\n", "import type { TripleObject } from \"@rgrannell1/tribbledb\";\n\n/*\n * Given a value, array of values, or undefined, return a set.\n */\nexport function setify<T>(value: T | T[] | undefined): Set<T> {\n  if (value === undefined) {\n    return new Set();\n  }\n\n  return new Set(Array.isArray(value) ? value : [value]);\n}\n\nexport function setOf<T>(property: string, objects: TripleObject[]): Set<T> {\n  const result = new Set<T>();\n\n  for (const obj of objects) {\n    if (property in obj) {\n      const value = obj[property] as T | T[] | undefined;\n      if (value === undefined) {\n        continue;\n      }\n\n      if (Array.isArray(value)) {\n        for (const elem of value) {\n          result.add(elem);\n        }\n      } else {\n        result.add(value);\n      }\n    }\n  }\n\n  return result;\n}\n", "\nimport { asUrn } from \"@rgrannell1/tribbledb\";\nimport m from \"mithril\";\nimport { Strings } from \"../commons/strings.ts\";\nimport { block, broadcast } from \"../commons/events.ts\";\n\nfunction onListingClick(type: string, event: Event) {\n  broadcast('navigate', {\n    route: `/listing/${type}`,\n  });\n  block(event);\n}\n\ntype ListingLinkAttrs = { urn: string; } | { type: string; };\n\nexport function ListingLink() {\n  return {\n    view(vnode: m.Vnode<ListingLinkAttrs>) {\n      let type = ''\n      if ('type' in vnode.attrs) {\n        type = vnode.attrs.type;\n      } else {\n        const parsed = asUrn(vnode.attrs.urn);\n        type = parsed.type;\n      }\n\n      return m('a', {\n        href: `#/listing/${type}`,\n        onclick: onListingClick.bind(null, type),\n      }, Strings.capitalise(type));\n    }\n  }\n}\n", "\nimport m from \"mithril\";\nimport type { Services } from \"../types.ts\";\nimport { one } from \"../commons/arrays.ts\";\nimport { ThingLink } from \"./thing-link.ts\";\n\ntype FeaturesListAttrs = {\n  urns: Set<string>;\n  services: Services;\n};\n\nexport function FeaturesList() {\n  return {\n    view(vnode: m.Vnode<FeaturesListAttrs>) {\n      const { urns, services } = vnode.attrs;\n      const features = services.readFeatures(urns);\n\n      const $features = features.map((feature) => {\n        const id = one(feature.id)!;\n\n        return m('li', {\n          key: `feature-${id}`,\n        }, m(ThingLink, { urn: id, thing: feature }));\n      });\n\n      return m('ul', $features)\n    }\n  }\n}\n", "\nimport m from \"mithril\";\nimport type { Services } from \"../types.ts\";\nimport { UnescoLink } from \"./unesco-link.ts\";\nimport { one } from \"../commons/arrays.ts\";\n\ntype UnescoListAttrs = {\n  urns: Set<string>;\n  services: Services;\n}\n\nexport function UnescoList() {\n  return {\n    view(vnode: m.Vnode<UnescoListAttrs>) {\n      const { urns, services } = vnode.attrs;\n\n      const unescos = services.readUnescos(urns);\n      const $unescos = unescos.map(unesco => {\n        const urn = one(unesco.id)!;\n\n        return m('li', m(UnescoLink, {urn, thing: unesco}))\n      });\n\n      return m('ul', $unescos)\n    }\n  }\n}\n", "import m from \"mithril\";\nimport { asUrn } from \"@rgrannell1/tribbledb\";\nimport { one } from \"../commons/arrays.ts\";\n\nexport type UnescoLinkAttrs = {\n  urn: string;\n  thing: any;\n};\n\n/* */\nexport function UnescoLink() {\n  return {\n    view(vnode: m.Vnode<UnescoLinkAttrs>) {\n      const { urn, thing } = vnode.attrs;\n      const { type, id } = asUrn(urn);\n\n      const name = one(thing.name) ?? id;\n\n      return m(\"a\", {\n        href: `https://whc.unesco.org/en/list/${id}`,\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        class: [\"thing-link\", `${type}-link`].join(\" \"),\n      }, name);\n    },\n  };\n}\n"],
  "mappings": "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",
  "names": ["object", "state", "require_hyperscript", "v", "require_render", "console", "require_mount_redraw", "object", "key", "require_build", "m", "url", "promise", "require_request", "string", "require_parse", "url", "m", "m", "route", "state", "m", "import_mithril", "import_mithril", "m", "triple", "triples", "url", "tdb", "import_mithril", "import_mithril", "m", "tdb", "m", "object", "tdb", "location", "tdb", "tdb", "tdb", "tdb", "tdb", "tdb", "location", "tdb", "tdb", "tdb", "tdb", "import_mithril", "m", "import_mithril", "import_mithril", "m", "import_mithril", "m", "import_mithril", "import_mithril", "import_mithril", "m", "url", "m", "m", "import_mithril", "m", "state", "m", "import_mithril", "m", "import_mithril", "import_mithril", "m", "m", "import_mithril", "import_mithril", "state", "url", "m", "import_mithril", "m", "import_mithril", "m", "import_mithril", "m", "import_mithril", "import_mithril", "m", "import_mithril", "m", "import_mithril", "Heading", "m", "m", "import_mithril", "AlbumsList", "m", "import_mithril", "import_mithril", "m", "import_mithril", "m", "import_mithril", "location", "m", "import_mithril", "m", "import_mithril", "m", "import_mithril", "import_mithril", "m", "m", "m", "m", "m", "m"]
}
