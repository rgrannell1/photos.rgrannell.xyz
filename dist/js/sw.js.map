{
  "version": 3,
  "sources": ["../../sw.js"],
  "sourcesContent": ["\nconst swChannel = new BroadcastChannel('sw');\n\nswChannel.postMessage(\"\u2699\uFE0F service-worker loaded\");\n\nconst CACHE_NAME = \"sw-cache\";\nconst CACHEABLE_RESOURCES = [\n  \"/icons/android-chrome-192x192.png\",\n  \"/icons/android-chrome-512x512.png\",\n  \"/icons/apple-touch-icon.png\",\n  \"/icons/favicon-16x16.png\",\n  \"/icons/favicon-32x32.png\",\n  \"/favicon.ico\",\n\n  // removed the font, it seemed to do something weird here\n];\n\n// -- let's not cache list of images / albums here. Netlify will cache them for us,\n// -- and we'll attach them to the window so they'll persist within a page load but not reloads.\nconst UNCACHEABLE_RESOURCES = [\n  \"/manifest/metdata.json\",\n];\n\nself.addEventListener(\"install\", function (event) {\n  // -- on install, cache every cacheable resource explicity listed.\n\n  event.waitUntil(\n    caches.open(CACHE_NAME).then(function (cache) {\n      return Promise.all(\n        CACHEABLE_RESOURCES.map((resource) => cache.add(resource)),\n      );\n    }),\n  );\n});\n\nfunction isCacheable(url, status) {\n  if (url.includes('_thumbnail') || url.includes('/t/')) {\n    return true;\n  }\n\n  if (url.includes('.woff2')) {\n    return true;\n  }\n\n  if (url.includes('/manifest/albums')) {\n    return true;\n  }\n\n  if (url.includes('/manifest/images')) {\n    return true;\n  }\n\n  return false;\n}\n\nself.addEventListener(\"fetch\", function (event) {\n  const url = event.request.url;\n\n  // -- do nothing for uncacheable resources\n  for (const resource of UNCACHEABLE_RESOURCES) {\n    if (url.includes(resource)) {\n      swChannel.postMessage(`\u2699\uFE0F rejecting ${url} from cache`);\n      return;\n    }\n  }\n\n  event.respondWith(\n    caches.match(event.request).then(function (response) {\n      if (response) {\n        return response;\n      }\n      swChannel.postMessage(`\u2699\uFE0F service-worker cache miss for ${url}`);\n\n      return fetch(event.request)\n      .then(function (networkResponse) {\n        swChannel.postMessage(`\u2699\uFE0F cannot cache ${url} ${networkResponse?.status}`);\n\n        // -- just return the result directly\n        if (!isCacheable(url, networkResponse.status)) {\n          swChannel.postMessage(`\u2699\uFE0F cannot cache ${url}`);\n\n          return networkResponse;\n        }\n\n        // -- cache thumbnails and artifacts\n        return caches.open(CACHE_NAME).then(function (cache) {\n          swChannel.postMessage(`\u2699\uFE0F caching ${url} ${networkResponse.status}`);\n\n          cache.put(event.request, networkResponse.clone());\n          return networkResponse;\n        });\n      }).catch(err => {\n        swChannel.postMessage(`\u2699\uFE0F service-worker fetch failed for ${url}: ${err}`);\n      });\n    }),\n  );\n});\n"],
  "mappings": "AACA,IAAMA,EAAY,IAAI,iBAAiB,IAAI,EAE3CA,EAAU,YAAY,oCAA0B,EAEhD,IAAMC,EAAa,WACbC,EAAsB,CAC1B,oCACA,oCACA,8BACA,2BACA,2BACA,cAGF,EAIMC,EAAwB,CAC5B,wBACF,EAEA,KAAK,iBAAiB,UAAW,SAAUC,EAAO,CAGhDA,EAAM,UACJ,OAAO,KAAKH,CAAU,EAAE,KAAK,SAAUI,EAAO,CAC5C,OAAO,QAAQ,IACbH,EAAoB,IAAKI,GAAaD,EAAM,IAAIC,CAAQ,CAAC,CAC3D,CACF,CAAC,CACH,CACF,CAAC,EAED,SAASC,EAAYC,EAAKC,EAAQ,CAahC,MAZI,GAAAD,EAAI,SAAS,YAAY,GAAKA,EAAI,SAAS,KAAK,GAIhDA,EAAI,SAAS,QAAQ,GAIrBA,EAAI,SAAS,kBAAkB,GAI/BA,EAAI,SAAS,kBAAkB,EAKrC,CAEA,KAAK,iBAAiB,QAAS,SAAUJ,EAAO,CAC9C,IAAMI,EAAMJ,EAAM,QAAQ,IAG1B,QAAWE,KAAYH,EACrB,GAAIK,EAAI,SAASF,CAAQ,EAAG,CAC1BN,EAAU,YAAY,0BAAgBQ,CAAG,aAAa,EACtD,MACF,CAGFJ,EAAM,YACJ,OAAO,MAAMA,EAAM,OAAO,EAAE,KAAK,SAAUM,EAAU,CACnD,OAAIA,IAGJV,EAAU,YAAY,8CAAoCQ,CAAG,EAAE,EAExD,MAAMJ,EAAM,OAAO,EACzB,KAAK,SAAUO,EAAiB,CAI/B,OAHAX,EAAU,YAAY,6BAAmBQ,CAAG,IAAIG,GAAiB,MAAM,EAAE,EAGpEJ,EAAYC,EAAKG,EAAgB,MAAM,EAOrC,OAAO,KAAKV,CAAU,EAAE,KAAK,SAAUI,EAAO,CACnD,OAAAL,EAAU,YAAY,wBAAcQ,CAAG,IAAIG,EAAgB,MAAM,EAAE,EAEnEN,EAAM,IAAID,EAAM,QAASO,EAAgB,MAAM,CAAC,EACzCA,CACT,CAAC,GAXCX,EAAU,YAAY,6BAAmBQ,CAAG,EAAE,EAEvCG,EAUX,CAAC,EAAE,MAAMC,GAAO,CACdZ,EAAU,YAAY,gDAAsCQ,CAAG,KAAKI,CAAG,EAAE,CAC3E,CAAC,EACH,CAAC,CACH,CACF,CAAC",
  "names": ["swChannel", "CACHE_NAME", "CACHEABLE_RESOURCES", "UNCACHEABLE_RESOURCES", "event", "cache", "resource", "isCacheable", "url", "status", "response", "networkResponse", "err"]
}
