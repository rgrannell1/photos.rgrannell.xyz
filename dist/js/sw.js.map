{
  "version": 3,
  "sources": ["../../sw.js"],
  "sourcesContent": ["const swChannel = new BroadcastChannel(\"sw\");\n\nswChannel.postMessage(\"\u2699\uFE0F service-worker loaded\");\n\nconst CACHE_NAME = \"sw-cache\";\nconst CACHEABLE_RESOURCES = [\n  \"/icons/android-chrome-192x192.png\",\n  \"/icons/android-chrome-512x512.png\",\n  \"/icons/apple-touch-icon.png\",\n  \"/icons/favicon-16x16.png\",\n  \"/icons/favicon-32x32.png\",\n  \"/favicon.ico\",\n  \"/favicon-32x32.png\",\n  // removed the font, it seemed to do something weird here\n];\n\n// -- let's not cache list of images / albums here. Our CDN will cache them for us,\n// -- and we'll attach them to the window so they'll persist within a page load but not reloads.\nconst UNCACHEABLE_RESOURCES = [ ];\n\nself.addEventListener(\"install\", function (event) {\n  // -- on install, cache every cacheable resource explicity listed.\n\n  event.waitUntil(\n    caches.open(CACHE_NAME).then(function (cache) {\n      return Promise.all(\n        CACHEABLE_RESOURCES.map((resource) => cache.add(resource)),\n      );\n    }),\n  );\n});\n\nfunction isCacheable(url) {\n  if (url.includes(\".woff2\")) {\n    return true;\n  }\n\n  const manifestEntries = ['albums', 'images', 'videos', 'exif', 'semantic', 'triples']\n\n  for (const entry of manifestEntries) {\n    if (url.includes(`/manifest/${entry}`)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nself.addEventListener(\"fetch\", function (event) {\n  const url = event.request.url;\n\n  // -- do nothing for uncacheable resources\n  for (const resource of UNCACHEABLE_RESOURCES) {\n    if (url.includes(resource)) {\n      swChannel.postMessage(`\u2699\uFE0F rejecting ${url} from cache`);\n      return;\n    }\n  }\n\n  event.respondWith(\n    caches.match(event.request).then(function (response) {\n      if (response) {\n        return response;\n      }\n      swChannel.postMessage(`\u2699\uFE0F service-worker cache miss for ${url}`);\n\n      return fetch(event.request)\n        .then(function (networkResponse) {\n          swChannel.postMessage(\n            `\u2699\uFE0F cannot cache ${url} ${networkResponse?.status}`,\n          );\n\n          // -- just return the result directly\n          if (!isCacheable(url)) {\n            swChannel.postMessage(`\u2699\uFE0F cannot cache ${url}`);\n\n            return networkResponse;\n          }\n\n          // -- cache thumbnails and artifacts\n          return caches.open(CACHE_NAME).then(function (cache) {\n            swChannel.postMessage(\n              `\u2699\uFE0F caching ${url} ${networkResponse.status}`,\n            );\n\n            cache.put(event.request, networkResponse.clone());\n            return networkResponse;\n          });\n        }).catch((err) => {\n          swChannel.postMessage(\n            `\u2699\uFE0F service-worker fetch failed for ${url}: ${err}`,\n          );\n        });\n    }),\n  );\n});\n"],
  "mappings": "AAAA,IAAMA,EAAY,IAAI,iBAAiB,IAAI,EAE3CA,EAAU,YAAY,oCAA0B,EAEhD,IAAMC,EAAa,WACbC,EAAsB,CAC1B,oCACA,oCACA,8BACA,2BACA,2BACA,eACA,oBAEF,EAIMC,EAAwB,CAAE,EAEhC,KAAK,iBAAiB,UAAW,SAAUC,EAAO,CAGhDA,EAAM,UACJ,OAAO,KAAKH,CAAU,EAAE,KAAK,SAAUI,EAAO,CAC5C,OAAO,QAAQ,IACbH,EAAoB,IAAKI,GAAaD,EAAM,IAAIC,CAAQ,CAAC,CAC3D,CACF,CAAC,CACH,CACF,CAAC,EAED,SAASC,EAAYC,EAAK,CACxB,GAAIA,EAAI,SAAS,QAAQ,EACvB,MAAO,GAGT,IAAMC,EAAkB,CAAC,SAAU,SAAU,SAAU,OAAQ,WAAY,SAAS,EAEpF,QAAWC,KAASD,EAClB,GAAID,EAAI,SAAS,aAAaE,CAAK,EAAE,EACnC,MAAO,GAIX,MAAO,EACT,CAEA,KAAK,iBAAiB,QAAS,SAAUN,EAAO,CAC9C,IAAMI,EAAMJ,EAAM,QAAQ,IAG1B,QAAWE,KAAYH,EACrB,GAAIK,EAAI,SAASF,CAAQ,EAAG,CAC1BN,EAAU,YAAY,0BAAgBQ,CAAG,aAAa,EACtD,MACF,CAGFJ,EAAM,YACJ,OAAO,MAAMA,EAAM,OAAO,EAAE,KAAK,SAAUO,EAAU,CACnD,OAAIA,IAGJX,EAAU,YAAY,8CAAoCQ,CAAG,EAAE,EAExD,MAAMJ,EAAM,OAAO,EACvB,KAAK,SAAUQ,EAAiB,CAM/B,OALAZ,EAAU,YACR,6BAAmBQ,CAAG,IAAII,GAAiB,MAAM,EACnD,EAGKL,EAAYC,CAAG,EAOb,OAAO,KAAKP,CAAU,EAAE,KAAK,SAAUI,EAAO,CACnD,OAAAL,EAAU,YACR,wBAAcQ,CAAG,IAAII,EAAgB,MAAM,EAC7C,EAEAP,EAAM,IAAID,EAAM,QAASQ,EAAgB,MAAM,CAAC,EACzCA,CACT,CAAC,GAbCZ,EAAU,YAAY,6BAAmBQ,CAAG,EAAE,EAEvCI,EAYX,CAAC,EAAE,MAAOC,GAAQ,CAChBb,EAAU,YACR,gDAAsCQ,CAAG,KAAKK,CAAG,EACnD,CACF,CAAC,EACL,CAAC,CACH,CACF,CAAC",
  "names": ["swChannel", "CACHE_NAME", "CACHEABLE_RESOURCES", "UNCACHEABLE_RESOURCES", "event", "cache", "resource", "isCacheable", "url", "manifestEntries", "entry", "response", "networkResponse", "err"]
}
