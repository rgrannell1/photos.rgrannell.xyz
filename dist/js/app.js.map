{
  "version": 3,
  "sources": ["../../js/library/lit.js", "../../js/models/lit-element.ts", "../../js/library/tribble.js", "../../js/models/artifacts.ts", "../../js/constants.js", "../../js/services/location.ts", "../../js/views/components/sidebar.ts", "../../js/views/components/header.ts", "../../js/services/photos.ts", "../../js/views/components/photo.ts", "../../js/services/json-feed.ts", "../../js/views/pages/photos.ts", "../../js/views/components/photos-stats.ts", "../../js/services/dates.ts", "../../js/things/things.ts", "../../js/views/components/photo-album.ts", "../../js/views/components/year-cursor.ts", "../../js/views/pages/albums.ts", "../../js/views/components/video.ts", "../../js/views/components/share.ts", "../../js/views/components/thing-link.ts", "../../js/views/pages/album.ts", "../../js/views/components/share-button.ts", "../../js/views/components/tag-link.ts", "../../js/views/pages/metadata.ts", "../../js/views/pages/about.ts", "../../js/views/pages/thing.ts", "../../js/services/videos.ts", "../../js/views/pages/videos.ts", "../../js/views/app.ts"],
  "sourcesContent": ["/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,s=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,i=Symbol(),e=new WeakMap;class n{constructor(t,s,e){if(this._$cssResult$=!0,e!==i)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=s}get styleSheet(){let t=this.i;const i=this.t;if(s&&void 0===t){const s=void 0!==i&&1===i.length;s&&(t=e.get(i)),void 0===t&&((this.i=t=new CSSStyleSheet).replaceSync(this.cssText),s&&e.set(i,t))}return t}toString(){return this.cssText}}const r=t=>new n(\"string\"==typeof t?t:t+\"\",void 0,i),o=(t,...s)=>{const e=1===t.length?t[0]:s.reduce(((s,i,e)=>s+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(i)+t[e+1]),t[0]);return new n(e,t,i)},h=(i,e)=>{if(s)i.adoptedStyleSheets=e.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const s of e){const e=document.createElement(\"style\"),n=t.litNonce;void 0!==n&&e.setAttribute(\"nonce\",n),e.textContent=s.cssText,i.appendChild(e)}},c=s?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let s=\"\";for(const i of t.cssRules)s+=i.cssText;return r(s)})(t):t\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */,{is:l,defineProperty:a,getOwnPropertyDescriptor:u,getOwnPropertyNames:d,getOwnPropertySymbols:f,getPrototypeOf:p}=Object,v=globalThis,y=v.trustedTypes,m=y?y.emptyScript:\"\",b=v.reactiveElementPolyfillSupport,g=(t,s)=>t,w={toAttribute(t,s){switch(s){case Boolean:t=t?m:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,s){let i=t;switch(s){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},_=(t,s)=>!l(t,s),S={attribute:!0,type:String,converter:w,reflect:!1,useDefault:!1,hasChanged:_};Symbol.metadata??=Symbol(\"metadata\"),v.litPropertyMetadata??=new WeakMap;class $ extends HTMLElement{static addInitializer(t){this.o(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this.u&&[...this.u.keys()]}static createProperty(t,s=S){if(s.state&&(s.attribute=!1),this.o(),this.prototype.hasOwnProperty(t)&&((s=Object.create(s)).wrapped=!0),this.elementProperties.set(t,s),!s.noAccessor){const i=Symbol(),e=this.getPropertyDescriptor(t,i,s);void 0!==e&&a(this.prototype,t,e)}}static getPropertyDescriptor(t,s,i){const{get:e,set:n}=u(this.prototype,t)??{get(){return this[s]},set(t){this[s]=t}};return{get:e,set(s){const r=e?.call(this);n?.call(this,s),this.requestUpdate(t,r,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??S}static o(){if(this.hasOwnProperty(g(\"elementProperties\")))return;const t=p(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(g(\"finalized\")))return;if(this.finalized=!0,this.o(),this.hasOwnProperty(g(\"properties\"))){const t=this.properties,s=[...d(t),...f(t)];for(const i of s)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const s=litPropertyMetadata.get(t);if(void 0!==s)for(const[t,i]of s)this.elementProperties.set(t,i)}this.u=new Map;for(const[t,s]of this.elementProperties){const i=this.p(t,s);void 0!==i&&this.u.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const s=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const t of i)s.unshift(c(t))}else void 0!==t&&s.push(c(t));return s}static p(t,s){const i=s.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}constructor(){super(),this.v=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this.m=null,this._()}_(){this.S=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this.$(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this.P??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this.P?.delete(t)}$(){const t=new Map,s=this.constructor.elementProperties;for(const i of s.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this.v=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return h(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this.P?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this.P?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,s,i){this._$AK(t,i)}C(t,s){const i=this.constructor.elementProperties.get(t),e=this.constructor.p(t,i);if(void 0!==e&&!0===i.reflect){const n=(void 0!==i.converter?.toAttribute?i.converter:w).toAttribute(s,i.type);this.m=t,null==n?this.removeAttribute(e):this.setAttribute(e,n),this.m=null}}_$AK(t,s){const i=this.constructor,e=i.u.get(t);if(void 0!==e&&this.m!==e){const t=i.getPropertyOptions(e),n=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:w;this.m=e;const r=n.fromAttribute(s,t.type);this[e]=r??this.T?.get(e)??r,this.m=null}}requestUpdate(t,s,i){if(void 0!==t){const e=this.constructor,n=this[t];if(i??=e.getPropertyOptions(t),!((i.hasChanged??_)(n,s)||i.useDefault&&i.reflect&&n===this.T?.get(t)&&!this.hasAttribute(e.p(t,i))))return;this.M(t,s,i)}!1===this.isUpdatePending&&(this.S=this.k())}M(t,s,{useDefault:i,reflect:e,wrapped:n},r){i&&!(this.T??=new Map).has(t)&&(this.T.set(t,r??s??this[t]),!0!==n||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||i||(s=void 0),this._$AL.set(t,s)),!0===e&&this.m!==t&&(this.A??=new Set).add(t))}async k(){this.isUpdatePending=!0;try{await this.S}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this.v){for(const[t,s]of this.v)this[t]=s;this.v=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[s,i]of t){const{wrapped:t}=i,e=this[s];!0!==t||this._$AL.has(s)||void 0===e||this.M(s,void 0,i,e)}}let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),this.P?.forEach((t=>t.hostUpdate?.())),this.update(s)):this.U()}catch(s){throw t=!1,this.U(),s}t&&this._$AE(s)}willUpdate(t){}_$AE(t){this.P?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}U(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this.S}shouldUpdate(t){return!0}update(t){this.A&&=this.A.forEach((t=>this.C(t,this[t]))),this.U()}updated(t){}firstUpdated(t){}}$.elementStyles=[],$.shadowRootOptions={mode:\"open\"},$[g(\"elementProperties\")]=new Map,$[g(\"finalized\")]=new Map,b?.({ReactiveElement:$}),(v.reactiveElementVersions??=[]).push(\"2.1.1\");\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst T=globalThis,x=T.trustedTypes,E=x?x.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,C=\"$lit$\",P=`lit$${Math.random().toFixed(9).slice(2)}$`,M=\"?\"+P,A=`<${M}>`,k=document,O=()=>k.createComment(\"\"),U=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,V=Array.isArray,R=t=>V(t)||\"function\"==typeof t?.[Symbol.iterator],N=\"[ \\t\\n\\f\\r]\",L=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,z=/-->/g,j=/>/g,D=RegExp(`>|${N}(?:([^\\\\s\"'>=/]+)(${N}*=${N}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),H=/'/g,I=/\"/g,B=/^(?:script|style|textarea|title)$/i,W=t=>(s,...i)=>({_$litType$:t,strings:s,values:i}),Z=W(1),q=W(2),F=W(3),G=Symbol.for(\"lit-noChange\"),J=Symbol.for(\"lit-nothing\"),K=new WeakMap,Y=k.createTreeWalker(k,129);function Q(t,s){if(!V(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==E?E.createHTML(s):s}const X=(t,s)=>{const i=t.length-1,e=[];let n,r=2===s?\"<svg>\":3===s?\"<math>\":\"\",o=L;for(let s=0;s<i;s++){const i=t[s];let h,c,l=-1,a=0;for(;a<i.length&&(o.lastIndex=a,c=o.exec(i),null!==c);)a=o.lastIndex,o===L?\"!--\"===c[1]?o=z:void 0!==c[1]?o=j:void 0!==c[2]?(B.test(c[2])&&(n=RegExp(\"</\"+c[2],\"g\")),o=D):void 0!==c[3]&&(o=D):o===D?\">\"===c[0]?(o=n??L,l=-1):void 0===c[1]?l=-2:(l=o.lastIndex-c[2].length,h=c[1],o=void 0===c[3]?D:'\"'===c[3]?I:H):o===I||o===H?o=D:o===z||o===j?o=L:(o=D,n=void 0);const u=o===D&&t[s+1].startsWith(\"/>\")?\" \":\"\";r+=o===L?i+A:l>=0?(e.push(h),i.slice(0,l)+C+i.slice(l)+P+u):i+P+(-2===l?s:u)}return[Q(t,r+(t[i]||\"<?>\")+(2===s?\"</svg>\":3===s?\"</math>\":\"\")),e]};class tt{constructor({strings:t,_$litType$:s},i){let e;this.parts=[];let n=0,r=0;const o=t.length-1,h=this.parts,[c,l]=X(t,s);if(this.el=tt.createElement(c,i),Y.currentNode=this.el.content,2===s||3===s){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(e=Y.nextNode())&&h.length<o;){if(1===e.nodeType){if(e.hasAttributes())for(const t of e.getAttributeNames())if(t.endsWith(C)){const s=l[r++],i=e.getAttribute(t).split(P),o=/([.?@])?(.*)/.exec(s);h.push({type:1,index:n,name:o[2],strings:i,ctor:\".\"===o[1]?rt:\"?\"===o[1]?ot:\"@\"===o[1]?ht:nt}),e.removeAttribute(t)}else t.startsWith(P)&&(h.push({type:6,index:n}),e.removeAttribute(t));if(B.test(e.tagName)){const t=e.textContent.split(P),s=t.length-1;if(s>0){e.textContent=x?x.emptyScript:\"\";for(let i=0;i<s;i++)e.append(t[i],O()),Y.nextNode(),h.push({type:2,index:++n});e.append(t[s],O())}}}else if(8===e.nodeType)if(e.data===M)h.push({type:2,index:n});else{let t=-1;for(;-1!==(t=e.data.indexOf(P,t+1));)h.push({type:7,index:n}),t+=P.length-1}n++}}static createElement(t,s){const i=k.createElement(\"template\");return i.innerHTML=t,i}}function st(t,s,i=t,e){if(s===G)return s;let n=void 0!==e?i.N?.[e]:i.O;const r=U(s)?void 0:s._$litDirective$;return n?.constructor!==r&&(n?._$AO?.(!1),void 0===r?n=void 0:(n=new r(t),n._$AT(t,i,e)),void 0!==e?(i.N??=[])[e]=n:i.O=n),void 0!==n&&(s=st(t,n._$AS(t,s.values),n,e)),s}class it{constructor(t,s){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=s}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}R(t){const{el:{content:s},parts:i}=this._$AD,e=(t?.creationScope??k).importNode(s,!0);Y.currentNode=e;let n=Y.nextNode(),r=0,o=0,h=i[0];for(;void 0!==h;){if(r===h.index){let s;2===h.type?s=new et(n,n.nextSibling,this,t):1===h.type?s=new h.ctor(n,h.name,h.strings,this,t):6===h.type&&(s=new ct(n,this,t)),this._$AV.push(s),h=i[++o]}r!==h?.index&&(n=Y.nextNode(),r++)}return Y.currentNode=k,e}V(t){let s=0;for(const i of this._$AV)void 0!==i&&(void 0!==i.strings?(i._$AI(t,i,s),s+=i.strings.length-2):i._$AI(t[s])),s++}}let et=class t{get _$AU(){return this._$AM?._$AU??this.D}constructor(t,s,i,e){this.type=2,this._$AH=J,this._$AN=void 0,this._$AA=t,this._$AB=s,this._$AM=i,this.options=e,this.D=e?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const s=this._$AM;return void 0!==s&&11===t?.nodeType&&(t=s.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,s=this){t=st(this,t,s),U(t)?t===J||null==t||\"\"===t?(this._$AH!==J&&this._$AR(),this._$AH=J):t!==this._$AH&&t!==G&&this.L(t):void 0!==t._$litType$?this.j(t):void 0!==t.nodeType?this.I(t):R(t)?this.H(t):this.L(t)}B(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}I(t){this._$AH!==t&&(this._$AR(),this._$AH=this.B(t))}L(t){this._$AH!==J&&U(this._$AH)?this._$AA.nextSibling.data=t:this.I(k.createTextNode(t)),this._$AH=t}j(t){const{values:s,_$litType$:i}=t,e=\"number\"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=tt.createElement(Q(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===e)this._$AH.V(s);else{const t=new it(e,this),i=t.R(this.options);t.V(s),this.I(i),this._$AH=t}}_$AC(t){let s=K.get(t.strings);return void 0===s&&K.set(t.strings,s=new tt(t)),s}H(s){V(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let e,n=0;for(const r of s)n===i.length?i.push(e=new t(this.B(O()),this.B(O()),this,this.options)):e=i[n],e._$AI(r),n++;n<i.length&&(this._$AR(e&&e._$AB.nextSibling,n),i.length=n)}_$AR(t=this._$AA.nextSibling,s){for(this._$AP?.(!1,!0,s);t!==this._$AB;){const s=t.nextSibling;t.remove(),t=s}}setConnected(t){void 0===this._$AM&&(this.D=t,this._$AP?.(t))}};class nt{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,s,i,e,n){this.type=1,this._$AH=J,this._$AN=void 0,this.element=t,this.name=s,this._$AM=e,this.options=n,i.length>2||\"\"!==i[0]||\"\"!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=J}_$AI(t,s=this,i,e){const n=this.strings;let r=!1;if(void 0===n)t=st(this,t,s,0),r=!U(t)||t!==this._$AH&&t!==G,r&&(this._$AH=t);else{const e=t;let o,h;for(t=n[0],o=0;o<n.length-1;o++)h=st(this,e[i+o],s,o),h===G&&(h=this._$AH[o]),r||=!U(h)||h!==this._$AH[o],h===J?t=J:t!==J&&(t+=(h??\"\")+n[o+1]),this._$AH[o]=h}r&&!e&&this.W(t)}W(t){t===J?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??\"\")}}class rt extends nt{constructor(){super(...arguments),this.type=3}W(t){this.element[this.name]=t===J?void 0:t}}class ot extends nt{constructor(){super(...arguments),this.type=4}W(t){this.element.toggleAttribute(this.name,!!t&&t!==J)}}class ht extends nt{constructor(t,s,i,e,n){super(t,s,i,e,n),this.type=5}_$AI(t,s=this){if((t=st(this,t,s,0)??J)===G)return;const i=this._$AH,e=t===J&&i!==J||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,n=t!==J&&(i===J||e);e&&this.element.removeEventListener(this.name,this,i),n&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){\"function\"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class ct{constructor(t,s,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=s,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){st(this,t)}}const lt={q:C,J:P,Z:M,F:1,G:X,K:it,X:R,Y:st,tt:et,st:nt,it:ot,et:ht,ht:rt,ot:ct},at=T.litHtmlPolyfillSupport;at?.(tt,et),(T.litHtmlVersions??=[]).push(\"3.3.1\");const ut=(t,s,i)=>{const e=i?.renderBefore??s;let n=e._$litPart$;if(void 0===n){const t=i?.renderBefore??null;e._$litPart$=n=new et(s.insertBefore(O(),t),t,void 0,i??{})}return n._$AI(t),n},dt=globalThis;\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */class ft extends ${constructor(){super(...arguments),this.renderOptions={host:this},this.rt=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const s=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this.rt=ut(s,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this.rt?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this.rt?.setConnected(!1)}render(){return G}}ft._$litElement$=!0,ft[\"finalized\"]=!0,dt.litElementHydrateSupport?.({LitElement:ft});const pt=dt.litElementPolyfillSupport;pt?.({LitElement:ft});const vt={_$AK:(t,s,i)=>{t._$AK(s,i)},_$AL:t=>t._$AL};(dt.litElementVersions??=[]).push(\"4.2.1\");\n/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst yt=!1,{tt:mt}=lt,bt=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,gt={HTML:1,SVG:2,MATHML:3},wt=(t,s)=>void 0===s?void 0!==t?._$litType$:t?._$litType$===s,_t=t=>null!=t?._$litType$?.h,St=t=>void 0!==t?._$litDirective$,$t=t=>t?._$litDirective$,Tt=t=>void 0===t.strings,xt=()=>document.createComment(\"\"),Et=(t,s,i)=>{const e=t._$AA.parentNode,n=void 0===s?t._$AB:s._$AA;if(void 0===i){const s=e.insertBefore(xt(),n),r=e.insertBefore(xt(),n);i=new mt(s,r,t,t.options)}else{const s=i._$AB.nextSibling,r=i._$AM,o=r!==t;if(o){let s;i._$AQ?.(t),i._$AM=t,void 0!==i._$AP&&(s=t._$AU)!==r._$AU&&i._$AP(s)}if(s!==n||o){let t=i._$AA;for(;t!==s;){const s=t.nextSibling;e.insertBefore(t,n),t=s}}}return i},Ct=(t,s,i=t)=>(t._$AI(s,i),t),Pt={},Mt=(t,s=Pt)=>t._$AH=s,At=t=>t._$AH,kt=t=>{t._$AR(),t._$AA.remove()},Ot=t=>{t._$AR()},Ut={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},Vt=t=>(...s)=>({_$litDirective$:t,values:s});class Rt{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,s,i){this.nt=t,this._$AM=s,this.ct=i}_$AS(t,s){return this.update(t,s)}update(t,s){return this.render(...s)}}\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const Nt=(t,s)=>{const i=t._$AN;if(void 0===i)return!1;for(const t of i)t._$AO?.(s,!1),Nt(t,s);return!0},Lt=t=>{let s,i;do{if(void 0===(s=t._$AM))break;i=s._$AN,i.delete(t),t=s}while(0===i?.size)},zt=t=>{for(let s;s=t._$AM;t=s){let i=s._$AN;if(void 0===i)s._$AN=i=new Set;else if(i.has(t))break;i.add(t),Ht(s)}};function jt(t){void 0!==this._$AN?(Lt(this),this._$AM=t,zt(this)):this._$AM=t}function Dt(t,s=!1,i=0){const e=this._$AH,n=this._$AN;if(void 0!==n&&0!==n.size)if(s)if(Array.isArray(e))for(let t=i;t<e.length;t++)Nt(e[t],!1),Lt(e[t]);else null!=e&&(Nt(e,!1),Lt(e));else Nt(this,t)}const Ht=t=>{2==t.type&&(t._$AP??=Dt,t._$AQ??=jt)};class It extends Rt{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,s,i){super._$AT(t,s,i),zt(this),this.isConnected=t._$AU}_$AO(t,s=!0){t!==this.isConnected&&(this.isConnected=t,t?this.reconnected?.():this.disconnected?.()),s&&(Nt(this,t),Lt(this))}setValue(t){if(Tt(this.nt))this.nt._$AI(t,this);else{const s=[...this.nt._$AH];s[this.ct]=t,this.nt._$AI(s,this,0)}}disconnected(){}reconnected(){}}\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */class Bt{constructor(t){this.lt=t}disconnect(){this.lt=void 0}reconnect(t){this.lt=t}deref(){return this.lt}}class Wt{constructor(){this.ut=void 0,this.dt=void 0}get(){return this.ut}pause(){this.ut??=new Promise((t=>this.dt=t))}resume(){this.dt?.(),this.ut=this.dt=void 0}}\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */class Zt extends It{constructor(){super(...arguments),this.ft=new Bt(this),this.vt=new Wt}render(t,s){return G}update(t,[s,i]){if(this.isConnected||this.disconnected(),s===this.yt)return G;this.yt=s;let e=0;const{ft:n,vt:r}=this;return(async(t,s)=>{for await(const i of t)if(!1===await s(i))return})(s,(async t=>{for(;r.get();)await r.get();const o=n.deref();if(void 0!==o){if(o.yt!==s)return!1;void 0!==i&&(t=i(t,e)),o.commitValue(t,e),e++}return!0})),G}commitValue(t,s){this.setValue(t)}disconnected(){this.ft.disconnect(),this.vt.pause()}reconnected(){this.ft.reconnect(this),this.vt.resume()}}const qt=Vt(Zt),Ft=Vt(\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nclass extends Zt{constructor(t){if(super(t),2!==t.type)throw Error(\"asyncAppend can only be used in child expressions\")}update(t,s){return this.rt=t,super.update(t,s)}commitValue(t,s){0===s&&Ot(this.rt);const i=Et(this.rt);Ct(i,t)}}),Gt=t=>_t(t)?t._$litType$.h:t.strings,Jt=Vt(class extends Rt{constructor(t){super(t),this.bt=new WeakMap}render(t){return[t]}update(t,[s]){const i=wt(this.gt)?Gt(this.gt):null,e=wt(s)?Gt(s):null;if(null!==i&&(null===e||i!==e)){const s=At(t).pop();let e=this.bt.get(i);if(void 0===e){const t=document.createDocumentFragment();e=ut(J,t),e.setConnected(!1),this.bt.set(i,e)}Mt(e,[s]),Et(e,void 0,s)}if(null!==e){if(null===i||i!==e){const s=this.bt.get(e);if(void 0!==s){const i=At(s).pop();Ot(t),Et(t,void 0,i),Mt(t,[i])}}this.gt=s}else this.gt=void 0;return this.render(s)}}),Kt=(t,s,i)=>{for(const i of s)if(i[0]===t)return(0,i[1])();return i?.()},Yt=Vt(\n/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nclass extends Rt{constructor(t){if(super(t),1!==t.type||\"class\"!==t.name||t.strings?.length>2)throw Error(\"`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.\")}render(t){return\" \"+Object.keys(t).filter((s=>t[s])).join(\" \")+\" \"}update(t,[s]){if(void 0===this.wt){this.wt=new Set,void 0!==t.strings&&(this._t=new Set(t.strings.join(\" \").split(/\\s/).filter((t=>\"\"!==t))));for(const t in s)s[t]&&!this._t?.has(t)&&this.wt.add(t);return this.render(s)}const i=t.element.classList;for(const t of this.wt)t in s||(i.remove(t),this.wt.delete(t));for(const t in s){const e=!!s[t];e===this.wt.has(t)||this._t?.has(t)||(e?(i.add(t),this.wt.add(t)):(i.remove(t),this.wt.delete(t)))}return G}}),Qt={},Xt=Vt(class extends Rt{constructor(){super(...arguments),this.St=Qt}render(t,s){return s()}update(t,[s,i]){if(Array.isArray(s)){if(Array.isArray(this.St)&&this.St.length===s.length&&s.every(((t,s)=>t===this.St[s])))return G}else if(this.St===s)return G;return this.St=Array.isArray(s)?Array.from(s):s,this.render(s,i)}}),ts=t=>t??J\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */;function*ss(t,s){const i=\"function\"==typeof s;if(void 0!==t){let e=-1;for(const n of t)e>-1&&(yield i?s(e):s),e++,yield n}}\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const is=Vt(class extends Rt{constructor(){super(...arguments),this.key=J}render(t,s){return this.key=t,s}update(t,[s,i]){return s!==this.key&&(Mt(t),this.key=s),i}}),es=Vt(\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nclass extends Rt{constructor(t){if(super(t),3!==t.type&&1!==t.type&&4!==t.type)throw Error(\"The `live` directive is not allowed on child or event bindings\");if(!Tt(t))throw Error(\"`live` bindings can only contain a single expression\")}render(t){return t}update(t,[s]){if(s===G||s===J)return s;const i=t.element,e=t.name;if(3===t.type){if(s===i[e])return G}else if(4===t.type){if(!!s===i.hasAttribute(e))return G}else if(1===t.type&&i.getAttribute(e)===s+\"\")return G;return Mt(t),s}});\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nfunction*ns(t,s){if(void 0!==t){let i=0;for(const e of t)yield s(e,i++)}}\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function*rs(t,s,i=1){const e=void 0===s?0:t;s??=t;for(let t=e;i>0?t<s:s<t;t+=i)yield t}\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const os=()=>new hs;class hs{}const cs=new WeakMap,ls=Vt(class extends It{render(t){return J}update(t,[s]){const i=s!==this.lt;return i&&void 0!==this.lt&&this.$t(void 0),(i||this.Tt!==this.xt)&&(this.lt=s,this.Et=t.options?.host,this.$t(this.xt=t.element)),J}$t(t){if(this.isConnected||(t=void 0),\"function\"==typeof this.lt){const s=this.Et??globalThis;let i=cs.get(s);void 0===i&&(i=new WeakMap,cs.set(s,i)),void 0!==i.get(this.lt)&&this.lt.call(this.Et,void 0),i.set(this.lt,t),void 0!==t&&this.lt.call(this.Et,t)}else this.lt.value=t}get Tt(){return\"function\"==typeof this.lt?cs.get(this.Et??globalThis)?.get(this.lt):this.lt?.value}disconnected(){this.Tt===this.xt&&this.$t(void 0)}reconnected(){this.$t(this.xt)}}),as=(t,s,i)=>{const e=new Map;for(let n=s;n<=i;n++)e.set(t[n],n);return e},us=Vt(class extends Rt{constructor(t){if(super(t),2!==t.type)throw Error(\"repeat() can only be used in text expressions\")}Ct(t,s,i){let e;void 0===i?i=s:void 0!==s&&(e=s);const n=[],r=[];let o=0;for(const s of t)n[o]=e?e(s,o):o,r[o]=i(s,o),o++;return{values:r,keys:n}}render(t,s,i){return this.Ct(t,s,i).values}update(t,[s,i,e]){const n=At(t),{values:r,keys:o}=this.Ct(s,i,e);if(!Array.isArray(n))return this.Pt=o,r;const h=this.Pt??=[],c=[];let l,a,u=0,d=n.length-1,f=0,p=r.length-1;for(;u<=d&&f<=p;)if(null===n[u])u++;else if(null===n[d])d--;else if(h[u]===o[f])c[f]=Ct(n[u],r[f]),u++,f++;else if(h[d]===o[p])c[p]=Ct(n[d],r[p]),d--,p--;else if(h[u]===o[p])c[p]=Ct(n[u],r[p]),Et(t,c[p+1],n[u]),u++,p--;else if(h[d]===o[f])c[f]=Ct(n[d],r[f]),Et(t,n[u],n[d]),d--,f++;else if(void 0===l&&(l=as(o,f,p),a=as(h,u,d)),l.has(h[u]))if(l.has(h[d])){const s=a.get(o[f]),i=void 0!==s?n[s]:null;if(null===i){const s=Et(t,n[u]);Ct(s,r[f]),c[f]=s}else c[f]=Ct(i,r[f]),Et(t,n[u],i),n[s]=null;f++}else kt(n[d]),d--;else kt(n[u]),u++;for(;f<=p;){const s=Et(t,c[p+1]);Ct(s,r[f]),c[f++]=s}for(;u<=d;){const t=n[u++];null!==t&&kt(t)}return this.Pt=o,Mt(t,c),G}}),ds=\"important\",fs=\" !\"+ds,ps=Vt(class extends Rt{constructor(t){if(super(t),1!==t.type||\"style\"!==t.name||t.strings?.length>2)throw Error(\"The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.\")}render(t){return Object.keys(t).reduce(((s,i)=>{const e=t[i];return null==e?s:s+`${i=i.includes(\"-\")?i:i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,\"-$&\").toLowerCase()}:${e};`}),\"\")}update(t,[s]){const{style:i}=t.element;if(void 0===this.Mt)return this.Mt=new Set(Object.keys(s)),this.render(s);for(const t of this.Mt)null==s[t]&&(this.Mt.delete(t),t.includes(\"-\")?i.removeProperty(t):i[t]=null);for(const t in s){const e=s[t];if(null!=e){this.Mt.add(t);const s=\"string\"==typeof e&&e.endsWith(fs);t.includes(\"-\")||s?i.setProperty(t,s?e.slice(0,-11):e,s?ds:\"\"):i[t]=e}}return G}}),vs=Vt(\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nclass extends Rt{constructor(t){if(super(t),2!==t.type)throw Error(\"templateContent can only be used in child bindings\")}render(t){return this.At===t?G:(this.At=t,document.importNode(t.content,!0))}});class ys extends Rt{constructor(t){if(super(t),this.gt=J,2!==t.type)throw Error(this.constructor.directiveName+\"() can only be used in child bindings\")}render(t){if(t===J||null==t)return this.kt=void 0,this.gt=t;if(t===G)return t;if(\"string\"!=typeof t)throw Error(this.constructor.directiveName+\"() called with a non-string value\");if(t===this.gt)return this.kt;this.gt=t;const s=[t];return s.raw=s,this.kt={_$litType$:this.constructor.resultType,strings:s,values:[]}}}ys.directiveName=\"unsafeHTML\",ys.resultType=1;const ms=Vt(ys);\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */class bs extends ys{}bs.directiveName=\"unsafeSVG\",bs.resultType=2;const gs=Vt(bs),ws=t=>!bt(t)&&\"function\"==typeof t.then,_s=1073741823;\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */class Ss extends It{constructor(){super(...arguments),this.Ot=_s,this.Ut=[],this.ft=new Bt(this),this.vt=new Wt}render(...t){return t.find((t=>!ws(t)))??G}update(t,s){const i=this.Ut;let e=i.length;this.Ut=s;const n=this.ft,r=this.vt;this.isConnected||this.disconnected();for(let t=0;t<s.length&&!(t>this.Ot);t++){const o=s[t];if(!ws(o))return this.Ot=t,o;t<e&&o===i[t]||(this.Ot=_s,e=0,Promise.resolve(o).then((async t=>{for(;r.get();)await r.get();const s=n.deref();if(void 0!==s){const i=s.Ut.indexOf(o);i>-1&&i<s.Ot&&(s.Ot=i,s.setValue(t))}})))}return G}disconnected(){this.ft.disconnect(),this.vt.pause()}reconnected(){this.ft.reconnect(this),this.vt.resume()}}const $s=Vt(Ss);\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function Ts(t,s,i){return t?s(t):i?.(t)}\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const xs=Symbol.for(\"\"),Es=t=>{if(t?.r===xs)return t?._$litStatic$},Cs=t=>({_$litStatic$:t,r:xs}),Ps=(t,...s)=>({_$litStatic$:s.reduce(((s,i,e)=>s+(t=>{if(void 0!==t._$litStatic$)return t._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${t}. Use 'unsafeStatic' to pass non-literal values, but\\n            take care to ensure page security.`)})(i)+t[e+1]),t[0]),r:xs}),Ms=new Map,As=t=>(s,...i)=>{const e=i.length;let n,r;const o=[],h=[];let c,l=0,a=!1;for(;l<e;){for(c=s[l];l<e&&void 0!==(r=i[l],n=Es(r));)c+=n+s[++l],a=!0;l!==e&&h.push(r),o.push(c),l++}if(l===e&&o.push(s[e]),a){const t=o.join(\"$$lit$$\");void 0===(s=Ms.get(t))&&(o.raw=o,Ms.set(t,s=o)),i=h}return t(s,...i)},ks=As(Z),Os=As(q);\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nwindow.litDisableBundleWarning||console.warn(\"Lit has been loaded from a bundle that combines all core features into a single file. To reduce transfer size and parsing cost, consider using the `lit` npm package directly in your project.\");export{It as AsyncDirective,Zt as AsyncReplaceDirective,n as CSSResult,Rt as Directive,ft as LitElement,Ut as PartType,$ as ReactiveElement,gt as TemplateResultType,ys as UnsafeHTMLDirective,Ss as UntilDirective,vt as _$LE,lt as _$LH,h as adoptStyles,Ft as asyncAppend,qt as asyncReplace,Jt as cache,Kt as choose,Yt as classMap,Ot as clearPart,os as createRef,o as css,w as defaultConverter,Vt as directive,At as getCommittedValue,c as getCompatibleStyle,$t as getDirectiveClass,Xt as guard,Z as html,ts as ifDefined,Et as insertPart,_t as isCompiledTemplateResult,St as isDirectiveResult,bt as isPrimitive,yt as isServer,Tt as isSingleExpression,wt as isTemplateResult,ss as join,is as keyed,Ps as literal,es as live,ns as map,F as mathml,G as noChange,_ as notEqual,J as nothing,rs as range,ls as ref,kt as removePart,ut as render,us as repeat,Ct as setChildPartValue,Mt as setCommittedValue,ks as staticHtml,Os as staticSvg,ps as styleMap,s as supportsAdoptingStyleSheets,q as svg,vs as templateContent,r as unsafeCSS,ms as unsafeHTML,gs as unsafeSVG,Cs as unsafeStatic,$s as until,Ts as when,As as withStatic};\n//# sourceMappingURL=lit-all.min.js.map\n", "import { LitElement } from \"../library/lit.js\";\n\nexport class LitElem extends LitElement {\n  createRenderRoot() {\n    return this;\n  }\n\n  broadcast(label, detail) {\n    return () => {\n      const dispatched = new CustomEvent(label, {\n        detail,\n        bubbles: true,\n        composed: true,\n      });\n\n      this.dispatchEvent(dispatched);\n    };\n  }\n}\n", "// sets.ts\nvar IndexedSet = class {\n  #idx;\n  #map;\n  #reverseMap;\n  constructor() {\n    this.#idx = 0;\n    this.#map = /* @__PURE__ */ new Map();\n    this.#reverseMap = /* @__PURE__ */ new Map();\n  }\n  map() {\n    return this.#map;\n  }\n  reverseMap() {\n    return this.#reverseMap;\n  }\n  add(value) {\n    if (this.#map.has(value)) {\n      return this.#map.get(value);\n    }\n    this.#map.set(value, this.#idx);\n    this.#reverseMap.set(this.#idx, value);\n    this.#idx++;\n    return this.#idx - 1;\n  }\n  setIndex(value, index) {\n    this.#map.set(value, index);\n    this.#reverseMap.set(index, value);\n  }\n  getIndex(value) {\n    return this.#map.get(value);\n  }\n  getValue(idx) {\n    return this.#reverseMap.get(idx);\n  }\n  has(value) {\n    return this.#map.has(value);\n  }\n};\nvar Sets = class {\n  /*\n   * Compute the intersection of multiple numeric sets.\n   * The number of sets will be low (we're not adding ninety\n   * query parameters to these URNs) so first sort the\n   * sets in ascending size. This could be done much, much more\n   * efficiently with a dataset that allows cheap intersections though...TODO\n   */\n  static intersection(metrics, sets) {\n    if (sets.length === 0) {\n      return /* @__PURE__ */ new Set();\n    }\n    sets.sort((setA, setB) => {\n      return setA.size - setB.size;\n    });\n    const acc = new Set(sets[0]);\n    for (let idx = 1; idx < sets.length; idx++) {\n      const currentSet = sets[idx];\n      for (const value of acc) {\n        metrics.setCheck();\n        if (!currentSet.has(value)) {\n          acc.delete(value);\n        }\n      }\n      if (acc.size === 0) {\n        break;\n      }\n    }\n    return acc;\n  }\n};\n\n// tribble/parse.ts\nvar TribbleParser = class {\n  stringIndex;\n  constructor() {\n    this.stringIndex = new IndexedSet();\n  }\n  parseTriple(line) {\n    const match = line.match(/^(\\d+) (\\d+) (\\d+)$/);\n    if (!match) {\n      throw new SyntaxError(`Invalid format for triple line: ${line}`);\n    }\n    const src = this.stringIndex.getValue(parseInt(match[1], 10));\n    const rel = this.stringIndex.getValue(parseInt(match[2], 10));\n    const tgt = this.stringIndex.getValue(parseInt(match[3], 10));\n    if (src === void 0 || rel === void 0 || tgt === void 0) {\n      throw new SyntaxError(`Invalid triple reference: ${line}`);\n    }\n    return [src, rel, tgt];\n  }\n  parseDeclaration(line) {\n    const match = line.match(/^(\\d+) \"(.*)\"$/);\n    if (!match) {\n      throw new SyntaxError(`Invalid format for declaration line: ${line}`);\n    }\n    const id = match[1];\n    const value = match[2];\n    this.stringIndex.setIndex(value, parseInt(id, 10));\n  }\n  parse(line) {\n    const isTriple = /^(\\d+)\\s(\\d+)\\s(\\d+)$/;\n    if (isTriple.test(line)) {\n      return this.parseTriple(line);\n    } else {\n      this.parseDeclaration(line);\n      return;\n    }\n  }\n};\n\n// tribble/stringify.ts\nvar TribbleStringifier = class {\n  stringIndex;\n  constructor() {\n    this.stringIndex = new IndexedSet();\n  }\n  stringify(triple) {\n    const message = [];\n    const [source, relation, target] = triple;\n    for (const value of [source, relation, target]) {\n      if (!this.stringIndex.has(value)) {\n        const newId = this.stringIndex.add(value);\n        const stringifiedValue = value === \"null\" || value === null ? JSON.stringify(\"null\") : JSON.stringify(value.toString());\n        message.push(`${newId} ${stringifiedValue}`);\n      }\n    }\n    message.push(\n      `${this.stringIndex.getIndex(source)} ${this.stringIndex.getIndex(relation)} ${this.stringIndex.getIndex(target)}`\n    );\n    return message.join(\"\\n\");\n  }\n};\n\n// urn.ts\nfunction parseUrn(urn, namespace = \"r\\xF3\") {\n  if (!urn.startsWith(`urn:${namespace}:`)) {\n    throw new Error(`Invalid URN for namespace ${namespace}: ${urn}`);\n  }\n  const type = urn.split(\":\")[2];\n  const [urnPart, queryString] = urn.split(\"?\");\n  const id = urnPart.split(\":\")[3];\n  const qs = queryString ? Object.fromEntries(new URLSearchParams(queryString)) : {};\n  return {\n    type,\n    id,\n    qs\n  };\n}\nfunction asUrn(value, namespace = \"r\\xF3\") {\n  try {\n    return parseUrn(value, namespace);\n  } catch (_) {\n    return {\n      type: \"unknown\",\n      id: value,\n      qs: {}\n    };\n  }\n}\n\n// metrics.ts\nvar IndexPerformanceMetrics = class {\n  mapReadCount;\n  constructor() {\n    this.mapReadCount = 0;\n  }\n  mapRead() {\n    this.mapReadCount++;\n  }\n};\nvar TribbleDBPerformanceMetrics = class {\n  setCheckCount;\n  constructor() {\n    this.setCheckCount = 0;\n  }\n  setCheck() {\n    this.setCheckCount++;\n  }\n};\n\n// triple-index.ts\nvar Index = class {\n  // Internal indexed representation for memory efficiency\n  indexedTriples;\n  // String indexing sets for memory efficiency\n  stringIndex;\n  sourceType;\n  sourceId;\n  // note: QS uses a composite key: <key>=<value>\n  sourceQs;\n  relations;\n  targetType;\n  targetId;\n  targetQs;\n  metrics;\n  stringUrn;\n  constructor(triples) {\n    this.indexedTriples = [];\n    this.stringIndex = new IndexedSet();\n    this.sourceType = /* @__PURE__ */ new Map();\n    this.sourceId = /* @__PURE__ */ new Map();\n    this.sourceQs = /* @__PURE__ */ new Map();\n    this.relations = /* @__PURE__ */ new Map();\n    this.targetType = /* @__PURE__ */ new Map();\n    this.targetId = /* @__PURE__ */ new Map();\n    this.targetQs = /* @__PURE__ */ new Map();\n    this.stringUrn = /* @__PURE__ */ new Map();\n    this.add(triples);\n    this.metrics = new IndexPerformanceMetrics();\n  }\n  /*\n   * Add new triples to the index incrementally\n   */\n  add(triples) {\n    const startIdx = this.indexedTriples.length;\n    for (let jdx = 0; jdx < triples.length; jdx++) {\n      const idx = startIdx + jdx;\n      const triple = triples[jdx];\n      const parsedSource = this.stringUrn.has(triple[0]) ? this.stringUrn.get(triple[0]) : this.stringUrn.set(triple[0], asUrn(triple[0])).get(triple[0]);\n      const relation = triple[1];\n      const parsedTarget = this.stringUrn.has(triple[2]) ? this.stringUrn.get(triple[2]) : this.stringUrn.set(triple[2], asUrn(triple[2])).get(triple[2]);\n      const sourceTypeIdx = this.stringIndex.add(parsedSource.type);\n      const sourceIdIdx = this.stringIndex.add(parsedSource.id);\n      const relationIdx = this.stringIndex.add(relation);\n      const targetTypeIdx = this.stringIndex.add(parsedTarget.type);\n      const targetIdIdx = this.stringIndex.add(parsedTarget.id);\n      this.indexedTriples.push([\n        this.stringIndex.add(triple[0]),\n        relationIdx,\n        this.stringIndex.add(triple[2])\n      ]);\n      if (!this.sourceType.has(sourceTypeIdx)) {\n        this.sourceType.set(sourceTypeIdx, /* @__PURE__ */ new Set());\n      }\n      this.sourceType.get(sourceTypeIdx).add(idx);\n      if (!this.sourceId.has(sourceIdIdx)) {\n        this.sourceId.set(sourceIdIdx, /* @__PURE__ */ new Set());\n      }\n      this.sourceId.get(sourceIdIdx).add(idx);\n      for (const [key, val] of Object.entries(parsedSource.qs)) {\n        const qsIdx = this.stringIndex.add(`${key}=${val}`);\n        if (!this.sourceQs.has(qsIdx)) {\n          this.sourceQs.set(qsIdx, /* @__PURE__ */ new Set());\n        }\n        this.sourceQs.get(qsIdx).add(idx);\n      }\n      if (!this.relations.has(relationIdx)) {\n        this.relations.set(relationIdx, /* @__PURE__ */ new Set());\n      }\n      this.relations.get(relationIdx).add(idx);\n      if (!this.targetType.has(targetTypeIdx)) {\n        this.targetType.set(targetTypeIdx, /* @__PURE__ */ new Set());\n      }\n      this.targetType.get(targetTypeIdx).add(idx);\n      if (!this.targetId.has(targetIdIdx)) {\n        this.targetId.set(targetIdIdx, /* @__PURE__ */ new Set());\n      }\n      this.targetId.get(targetIdIdx).add(idx);\n      for (const [key, val] of Object.entries(parsedTarget.qs)) {\n        const qsIdx = this.stringIndex.add(`${key}=${val}`);\n        if (!this.targetQs.has(qsIdx)) {\n          this.targetQs.set(qsIdx, /* @__PURE__ */ new Set());\n        }\n        this.targetQs.get(qsIdx).add(idx);\n      }\n    }\n  }\n  /*\n   * Get the number of triples in the index\n   */\n  get length() {\n    return this.indexedTriples.length;\n  }\n  /*\n   * Reconstruct the original triples from the indexed representation\n   */\n  triples() {\n    return this.indexedTriples.map(([sourceIdx, relationIdx, targetIdx]) => [\n      this.stringIndex.getValue(sourceIdx),\n      this.stringIndex.getValue(relationIdx),\n      this.stringIndex.getValue(targetIdx)\n    ]);\n  }\n  /*\n   * Get a specific triple by index\n   */\n  getTriple(index) {\n    if (index < 0 || index >= this.indexedTriples.length) {\n      return void 0;\n    }\n    const [sourceIdx, relationIdx, targetIdx] = this.indexedTriples[index];\n    return [\n      this.stringIndex.getValue(sourceIdx),\n      this.stringIndex.getValue(relationIdx),\n      this.stringIndex.getValue(targetIdx)\n    ];\n  }\n  getTripleIndices(index) {\n    if (index < 0 || index >= this.indexedTriples.length) {\n      return void 0;\n    }\n    return this.indexedTriples[index];\n  }\n  /*\n   * Helper methods to convert string keys to indices for external API compatibility\n   */\n  getSourceTypeSet(type) {\n    const typeIdx = this.stringIndex.getIndex(type);\n    if (typeIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.sourceType.get(typeIdx);\n  }\n  getSourceIdSet(id) {\n    const idIdx = this.stringIndex.getIndex(id);\n    if (idIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.sourceId.get(idIdx);\n  }\n  getSourceQsSet(key, val) {\n    const qsIdx = this.stringIndex.getIndex(`${key}=${val}`);\n    if (qsIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.sourceQs.get(qsIdx);\n  }\n  getRelationSet(relation) {\n    const relationIdx = this.stringIndex.getIndex(relation);\n    if (relationIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.relations.get(relationIdx);\n  }\n  getTargetTypeSet(type) {\n    const typeIdx = this.stringIndex.getIndex(type);\n    if (typeIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.targetType.get(typeIdx);\n  }\n  getTargetIdSet(id) {\n    const idIdx = this.stringIndex.getIndex(id);\n    if (idIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.targetId.get(idIdx);\n  }\n  getTargetQsSet(key, val) {\n    const qsIdx = this.stringIndex.getIndex(`${key}=${val}`);\n    if (qsIdx === void 0) {\n      return void 0;\n    }\n    this.metrics.mapRead();\n    return this.targetQs.get(qsIdx);\n  }\n};\n\n// triples.ts\nvar Triples = class {\n  static source(triple) {\n    return triple[0];\n  }\n  static relation(triple) {\n    return triple[1];\n  }\n  static target(triple) {\n    return triple[2];\n  }\n};\n\n// tribble-db.ts\nfunction joinSubqueryResults(metrics, acc, tripleResult) {\n  const joinedNames = acc.names.concat(tripleResult.names);\n  if (acc.rows.length === 0 || tripleResult.rows.length === 0) {\n    return {\n      names: joinedNames,\n      rows: []\n    };\n  }\n  const endings = /* @__PURE__ */ new Map();\n  const starts = /* @__PURE__ */ new Map();\n  for (let idx = 0; idx < acc.rows.length; idx++) {\n    const refId = acc.rows[idx][2];\n    if (!endings.has(refId)) {\n      endings.set(refId, []);\n    }\n    endings.get(refId).push(idx);\n  }\n  for (let idx = 0; idx < tripleResult.rows.length; idx++) {\n    const refId = tripleResult.rows[idx][0];\n    if (!starts.has(refId)) {\n      starts.set(refId, []);\n    }\n    starts.get(refId).push(idx);\n  }\n  const commonLinks = Sets.intersection(metrics, [\n    new Set(endings.keys()),\n    new Set(starts.keys())\n  ]);\n  const joinedRows = [];\n  for (const link of commonLinks) {\n    const startRowIndices = starts.get(link);\n    const endRowsIndices = endings.get(link);\n    for (const startRowIndex of startRowIndices) {\n      for (const endRowIndex of endRowsIndices) {\n        const joinedRow = acc.rows[startRowIndex].concat(\n          tripleResult.rows[endRowIndex]\n        );\n        joinedRows.push(joinedRow);\n      }\n    }\n  }\n  return {\n    names: joinedNames,\n    rows: joinedRows\n  };\n}\nvar TribbleDB = class _TribbleDB {\n  index;\n  triplesCount;\n  cursorIndices;\n  metrics;\n  constructor(triples) {\n    this.index = new Index(triples);\n    this.triplesCount = this.index.length;\n    this.cursorIndices = /* @__PURE__ */ new Set();\n    this.metrics = new TribbleDBPerformanceMetrics();\n    for (let idx = 0; idx < this.triplesCount; idx++) {\n      this.cursorIndices.add(idx);\n    }\n  }\n  clone() {\n    const clonedDB = new _TribbleDB([]);\n    clonedDB.index = this.index;\n    clonedDB.triplesCount = this.triplesCount;\n    clonedDB.cursorIndices = this.cursorIndices;\n    clonedDB.metrics = this.metrics;\n    return clonedDB;\n  }\n  static of(triples) {\n    return new _TribbleDB(triples);\n  }\n  /*\n   * Convert an array of TripleObject instances to a TribbleDB.\n   *\n   * @param objects - An array of TripleObject instances.\n   *\n   * @returns A TribbleDB instance.\n   */\n  static from(objects) {\n    const triples = [];\n    for (const obj of objects) {\n      const { id, ...relations } = obj;\n      if (typeof id !== \"string\") {\n        throw new Error(\"Each TripleObject must have a string id.\");\n      }\n      for (const [relation, target] of Object.entries(relations)) {\n        if (Array.isArray(target)) {\n          for (const sub of target) {\n            triples.push([id, relation, sub]);\n          }\n        } else {\n          triples.push([id, relation, target]);\n        }\n      }\n    }\n    return new _TribbleDB(triples);\n  }\n  /**\n   * Add new triples to the database.\n   *\n   * @param triples - An array of triples to add.\n   */\n  add(triples) {\n    const oldLength = this.index.length;\n    this.index.add(triples);\n    this.triplesCount = this.index.length;\n    for (let idx = oldLength; idx < this.triplesCount; idx++) {\n      this.cursorIndices.add(idx);\n    }\n  }\n  /**\n   * Map over the triples in the database.\n   *\n   * @param fn - A mapping function.\n   * @returns A new TribbleDB instance containing the mapped triples.\n   */\n  map(fn) {\n    return new _TribbleDB(this.index.triples().map(fn));\n  }\n  /**\n   * Flat map over the triples in the database.\n   *\n   * @param fn - A mapping function.\n   * @returns A new TribbleDB instance containing the flat-mapped triples.\n   */\n  flatMap(fn) {\n    const flatMappedTriples = this.index.triples().flatMap(fn);\n    return new _TribbleDB(flatMappedTriples);\n  }\n  /**\n   * Get the first triple in the database.\n   *\n   * @returns The first triple, or undefined if there are no triples.\n   */\n  firstTriple() {\n    return this.index.length > 0 ? this.index.getTriple(0) : void 0;\n  }\n  /*\n   * Get the first source in the database.\n   */\n  firstSource() {\n    const first = this.firstTriple();\n    return first ? Triples.source(first) : void 0;\n  }\n  /**\n   * Get the first relation in the database.\n   */\n  firstRelation() {\n    const first = this.firstTriple();\n    return first ? Triples.relation(first) : void 0;\n  }\n  /**\n   * Get the first target in the database.\n   */\n  firstTarget() {\n    const first = this.firstTriple();\n    return first ? Triples.target(first) : void 0;\n  }\n  /*\n   * Get the first object in the database.\n   */\n  firstObject(listOnly = false) {\n    return this.objects(listOnly)[0];\n  }\n  /*\n   * Get all triples in the database.\n   *\n   * @returns An array of all triples.\n   */\n  triples() {\n    return this.index.triples();\n  }\n  /**\n   * Get all unique sources in the database.\n   *\n   * @returns A set of all unique sources.\n   */\n  sources() {\n    return new Set(\n      this.index.triples().map(Triples.source)\n    );\n  }\n  /**\n   * Get all unique relations in the database.\n   *\n   * @returns A set of all unique relations.\n   */\n  relations() {\n    return new Set(\n      this.index.triples().map(Triples.relation)\n    );\n  }\n  /**\n   * Get all unique targets in the database.\n   *\n   * @returns A set of all unique targets.\n   */\n  targets() {\n    return new Set(\n      this.index.triples().map(Triples.target)\n    );\n  }\n  /*\n   * Get all unique objects represented by the triples.\n   *\n   * @returns An array of unique TripleObject instances.\n   */\n  objects(listOnly = false) {\n    const output = [];\n    for (const [id, obj] of Object.entries(this.object(listOnly))) {\n      obj.id = id;\n      output.push(obj);\n    }\n    return output;\n  }\n  /*\n   * yes, this is a bad name given firstObject.\n   */\n  object(listOnly = false) {\n    const objs = {};\n    for (const [source, relation, target] of this.index.triples()) {\n      if (!objs[source]) {\n        objs[source] = { id: source };\n      }\n      if (!objs[source][relation]) {\n        objs[source][relation] = listOnly ? [target] : target;\n      } else if (Array.isArray(objs[source][relation])) {\n        objs[source][relation].push(target);\n      } else {\n        objs[source][relation] = [objs[source][relation], target];\n      }\n    }\n    return objs;\n  }\n  #findMatchingRows(params) {\n    const matchingRowSets = [\n      this.cursorIndices\n    ];\n    const { source, relation, target } = params;\n    if (typeof source === \"undefined\" && typeof target === \"undefined\" && typeof relation === \"undefined\") {\n      throw new Error(\"At least one search parameter must be defined\");\n    }\n    const allowedKeys = [\"source\", \"relation\", \"target\"];\n    for (const key of Object.keys(params)) {\n      if (!Object.prototype.hasOwnProperty.call(params, key)) continue;\n      if (!allowedKeys.includes(key)) {\n        throw new Error(`Unexpected search parameter: ${key}`);\n      }\n    }\n    if (source) {\n      if (source.type) {\n        const sourceTypeSet = this.index.getSourceTypeSet(source.type);\n        if (sourceTypeSet) {\n          matchingRowSets.push(sourceTypeSet);\n        } else {\n          return /* @__PURE__ */ new Set();\n        }\n      }\n      if (source.id) {\n        const sourceIdSet = this.index.getSourceIdSet(source.id);\n        if (sourceIdSet) {\n          matchingRowSets.push(sourceIdSet);\n        } else {\n          return /* @__PURE__ */ new Set();\n        }\n      }\n      if (source.qs) {\n        for (const [key, val] of Object.entries(source.qs)) {\n          const sourceQsSet = this.index.getSourceQsSet(key, val);\n          if (sourceQsSet) {\n            matchingRowSets.push(sourceQsSet);\n          } else {\n            return /* @__PURE__ */ new Set();\n          }\n        }\n      }\n    }\n    if (target) {\n      if (target.type) {\n        const targetTypeSet = this.index.getTargetTypeSet(target.type);\n        if (targetTypeSet) {\n          matchingRowSets.push(targetTypeSet);\n        } else {\n          return /* @__PURE__ */ new Set();\n        }\n      }\n      if (target.id) {\n        const targetIdSet = this.index.getTargetIdSet(target.id);\n        if (targetIdSet) {\n          matchingRowSets.push(targetIdSet);\n        } else {\n          return /* @__PURE__ */ new Set();\n        }\n      }\n      if (target.qs) {\n        for (const [key, val] of Object.entries(target.qs)) {\n          const targetQsSet = this.index.getTargetQsSet(key, val);\n          if (targetQsSet) {\n            matchingRowSets.push(targetQsSet);\n          } else {\n            return /* @__PURE__ */ new Set();\n          }\n        }\n      }\n    }\n    if (relation) {\n      const relationDsl = typeof relation === \"string\" ? { relation: [relation] } : relation;\n      if (relationDsl.relation) {\n        const unionedRelations = /* @__PURE__ */ new Set();\n        for (const rel of relationDsl.relation) {\n          const relationSet = this.index.getRelationSet(rel);\n          if (relationSet) {\n            for (const elem of relationSet) {\n              unionedRelations.add(elem);\n            }\n          }\n        }\n        if (unionedRelations.size > 0) {\n          matchingRowSets.push(unionedRelations);\n        } else {\n          return /* @__PURE__ */ new Set();\n        }\n      }\n    }\n    const intersection = Sets.intersection(this.metrics, matchingRowSets);\n    const matchingTriples = /* @__PURE__ */ new Set();\n    for (const index of intersection) {\n      const triple = this.index.getTriple(index);\n      if (!source?.predicate && !target?.predicate && !(typeof relation === \"object\" && relation.predicate)) {\n        matchingTriples.add(index);\n        continue;\n      }\n      let isValid = true;\n      if (source?.predicate) {\n        isValid = isValid && source.predicate(Triples.source(triple));\n      }\n      if (target?.predicate) {\n        isValid = isValid && target.predicate(Triples.target(triple));\n      }\n      if (typeof relation === \"object\" && relation.predicate) {\n        isValid = isValid && relation.predicate(Triples.relation(triple));\n      }\n      if (isValid) {\n        matchingTriples.add(index);\n      }\n    }\n    return matchingTriples;\n  }\n  /*\n   * Search all triples in the database.\n   *\n   * @param params - The search parameters.\n   * @returns A new TribbleDB instance containing the matching triples.\n   */\n  search(params) {\n    const matchingTriples = [];\n    for (const rowIdx of this.#findMatchingRows(params)) {\n      const triple = this.index.getTriple(rowIdx);\n      if (triple) {\n        matchingTriples.push(triple);\n      }\n    }\n    return new _TribbleDB(matchingTriples);\n  }\n  search2(query) {\n    const bindings = Object.entries(query);\n    const subqueryResults = [];\n    for (let idx = 0; idx < bindings.length - 2; idx += 2) {\n      const tripleSlice = bindings.slice(idx, idx + 3);\n      const pattern = {\n        source: tripleSlice[0][1],\n        relation: tripleSlice[1][1],\n        target: tripleSlice[2][1]\n      };\n      const bindingNames = tripleSlice.map((pair) => pair[0]);\n      const tripleRows = this.#findMatchingRows(pattern);\n      const rowData = Array.from(tripleRows).flatMap((row) => {\n        const contents = this.index.getTripleIndices(row);\n        return typeof contents === \"undefined\" ? [] : [contents];\n      });\n      subqueryResults.push({\n        names: bindingNames,\n        rows: rowData\n      });\n    }\n    const queryResult = subqueryResults.reduce(\n      joinSubqueryResults.bind(this, this.metrics)\n    );\n    const outputNames = queryResult.names;\n    const objects = [];\n    for (const row of queryResult.rows) {\n      const data = {};\n      for (let idx = 0; idx < outputNames.length; idx++) {\n        const label = outputNames[idx];\n        data[label] = this.index.stringIndex.getValue(row[idx]);\n      }\n      objects.push(data);\n    }\n    return objects;\n  }\n  getMetrics() {\n    return {\n      index: this.index.metrics,\n      db: this.metrics\n    };\n  }\n};\nexport {\n  TribbleDB,\n  TribbleParser,\n  TribbleStringifier,\n  asUrn,\n  parseUrn\n};\n", "import { TribbleParser } from \"../library/tribble.js\";\n\n// injected into the HTLM during build-time\nconst CONFIG = window.envConfig;\n\nexport class TribblesArtifact {\n  url: string;\n  constructor(url = `/manifest/tribbles.${CONFIG.publication_id}.txt`) {\n    this.url = url;\n  }\n\n  async *stream() {\n    const parser = new TribbleParser();\n    const response = await fetch(this.url);\n    if (!response.body) {\n      throw new Error(\"No response body\");\n    }\n\n    const decoder = new TextDecoderStream();\n    const reader = response.body.pipeThrough(decoder).getReader();\n    let buffer = \"\";\n\n    while (true) {\n      const { value, done } = await reader.read();\n      if (done) {\n        break;\n      }\n      buffer += value;\n      let lines = buffer.split(\"\\n\");\n      buffer = lines.pop() ?? \"\";\n      for (const line of lines) {\n        const triple = parser.parse(line);\n        if (triple !== undefined) {\n          yield triple;\n        }\n      }\n    }\n\n    // parse any remaining line in buffer\n    if (buffer.length > 0) {\n      const triple = parser.parse(buffer);\n      if (triple !== undefined) {\n        yield triple;\n      }\n    }\n  }\n}\n", "// symbols to uniquely define the manifest and metadata\n// in the global window scope\nexport const ALBUMS_SYMBOL = Symbol(\"the albums manifest\");\nexport const IMAGES_SYMBOL = Symbol(\"the images manifest\");\nexport const MANIFEST_SYMBOL = Symbol(\"the site manifest\");\nexport const VIDEOS_SYMBOL = Symbol(\"the videos manifest\");\nexport const SEMANTIC_SYMBOL = Symbol(\"the semantic data\");\nexport const STATS_SYMBOL = Symbol(\"the album stats\");\nexport const TRIPLES_SYMBOL = Symbol(\"the triples data\");\n\nexport const LOCATION_LATITUDE = 53.33306;\nexport const LOCATION_LONGITUDE = -6.24889;\nexport const LOCATION_ZOOM = 6;\n\nexport const BRAND_TEXT = \"photos\";\n\nexport class LoadMode {\n  static EAGER = \"eager\";\n  static LAZY = \"lazy\";\n}\n\nexport class Pages {\n  static PHOTOS = \"photos\";\n  static ALBUMS = \"albums\";\n  static ALBUM = \"album\";\n  static METADATA = \"metadata\";\n  static ABOUT = \"about\";\n  static VIDEOS = \"videos\";\n  static THING = \"thing\";\n}\n\nexport class KnownThings {\n  static UNESCO = \"unesco\";\n  static BIRD = \"bird\";\n  static MAMMAL = \"mammal\";\n  static REPTILE = \"reptile\";\n  static FISH = \"fish\";\n  static INSECT = \"insect\";\n  static AMPHIBIAN = \"amphibian\";\n  static GEONAME = \"geoname\";\n}\n\nexport class KnownRelations {\n  static SUBJECT = \"subject\";\n  static LOCATION = \"location\";\n  static LONGITUDE = \"longitude\";\n  static LATITUDE = \"latitude\";\n  static COUNTRY = \"country\";\n  static FLAG = \"flag\";\n  static RATING = \"rating\";\n  static NAME = \"name\";\n  static BIRDWATCH_URL = \"birdwatch_url\";\n  static WIKIPEDIA = \"wikipedia\";\n  static CREATED_AT = \"created_at\";\n  static F_STOP = \"f_stop\";\n  static FOCAL_LENGTH = \"focal_length\";\n  static MODEL = \"model\";\n  static EXPOSURE_TIME = \"exposure_time\";\n  static ISO = \"iso\";\n  static WIDTH = \"width\";\n  static HEIGHT = \"height\";\n}\n\nexport const ExifRelations = new Set([\n  \"created_at\",\n  \"f_stop\",\n  \"focal_length\",\n  \"model\",\n  \"exposure_time\",\n  \"iso\",\n  \"width\",\n  \"height\",\n]);\n\nexport const BinomialTypes = new Set([\n  \"bird\",\n  \"mammal\",\n  \"reptile\",\n  \"amphibian\",\n  \"fish\",\n  \"insect\",\n]);\n", "/*\n * Define page routes (poorly)\n */\n\nimport { Pages } from \"../constants.js\";\n\nexport class PageLocation {\n  static ROUTES = {\n    [Pages.PHOTOS]: this.showPhotosUrl,\n    [Pages.ALBUMS]: this.showAlbumsUrl,\n    [Pages.ALBUM]: this.showAlbumUrl,\n    [Pages.METADATA]: this.showMetadataUrl,\n    [Pages.ABOUT]: this.showAboutUrl,\n    [Pages.VIDEOS]: this.showVideosUrl,\n    [Pages.THING]: this.showThingUrl,\n  };\n\n  static router(page) {\n    if (PageLocation.ROUTES.hasOwnProperty(page)) {\n      return PageLocation.ROUTES[page];\n    }\n    throw new Error(`Unknown page: ${page}`);\n  }\n\n  static pageUsesId(page) {\n    return page === Pages.ALBUM ||\n      page === Pages.PHOTO ||\n      page === Pages.METADATA ||\n      page === Pages.THING;\n  }\n\n  static showAboutUrl() {\n    window.location.hash = \"#/about\";\n    document.title = \"About - photos\";\n  }\n  static showAlbumsUrl() {\n    window.location.hash = \"#/albums\";\n    document.title = \"Albums - photos\";\n  }\n  static showPhotosUrl() {\n    window.location.hash = \"#/photos\";\n    document.title = \"Photos - photos\";\n  }\n  static showAlbumUrl(id: string) {\n    window.location.hash = `#/album/${id}`;\n    document.title = \"Album - photos\";\n  }\n  static showPhotoUrl(id: string) {\n    window.location.hash = `#/photo/${id}`;\n    document.title = \"Photo - photos\";\n  }\n  static showMetadataUrl(id: string) {\n    window.location.hash = `#/metadata/${id}`;\n    document.title = \"Metadata - photos\";\n  }\n  static showVideosUrl() {\n    window.location.hash = \"#/videos\";\n    document.title = \"Videos - photos\";\n  }\n\n  static showThingUrl(urn: string) {\n    window.location.hash = `#/thing/${urn}`;\n    // TODO dynamically look up the name for this urn\n    document.title = \"Thing - photos\";\n  }\n\n  static getUrl() {\n    if (window.location.hash.startsWith(\"#/albums\")) {\n      return {\n        type: \"albums\",\n      };\n    } else if (window.location.hash.startsWith(\"#/album\")) {\n      return {\n        type: \"album\",\n        id: window.location.hash.split(\"/\")[2],\n      };\n    } else if (window.location.hash.startsWith(\"#/metadata\")) {\n      return {\n        type: \"metadata\",\n        id: window.location.hash.split(\"/\")[2],\n      };\n    } else if (window.location.hash.startsWith(\"#/thing\")) {\n      return {\n        type: \"thing\",\n        id: window.location.hash.split(\"/\")[2],\n      };\n    } else if (window.location.hash.startsWith(\"#/photos\")) {\n      return {\n        type: \"photos\",\n      };\n    } else if (window.location.hash.startsWith(\"#/about\")) {\n      return {\n        type: \"about\",\n      };\n    } else if (window.location.hash.startsWith(\"#/videos\")) {\n      return {\n        type: \"videos\",\n      };\n    } else {\n      return {\n        type: \"albums\",\n      };\n    }\n  }\n}\n", "import { html } from \"../../library/lit.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\n\nexport class Sidebar extends LitElem {\n  static get properties() {\n    return {\n      visible: { type: Boolean },\n    };\n  }\n\n  render() {\n    const classes = [\"photo-sidebar\"];\n    if (this.visible) {\n      classes.push(\"sidebar-visible\");\n    }\n\n    return html`\n    <aside class=\"${classes.join(\" \")}\">\n      <nav>\n        <ul>\n          <li\n            @click=${\n      this.broadcast(\"navigate-page\", {\n        page: \"photos\",\n      })\n    }\n            class=\"sidebar-item\">PHOTOS</li>\n\n          <li\n            @click=${\n      this.broadcast(\"navigate-page\", {\n        page: \"videos\",\n      })\n    }\n            class=\"sidebar-item\">VIDEOS</li>\n\n          <li\n            @click=${\n      this.broadcast(\"navigate-page\", {\n        page: \"albums\",\n      })\n    }\n            id=\"albums-sidebar-link\" class=\"sidebar-item\">ALBUMS</li>\n          <li\n            @click=${\n      this.broadcast(\"navigate-page\", {\n        page: \"about\",\n      })\n    }\n            class=\"sidebar-item\">ABOUT</li>\n\n      </nav>\n    </aside>\n    `;\n  }\n}\n\ncustomElements.define(\"photo-sidebar\", Sidebar);\n", "import { html } from \"../../library/lit.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\nimport { BRAND_TEXT } from \"../../constants.js\";\n\nexport class PhotoHeader extends LitElem {\n  static get properties() {\n    return {\n      darkMode: { type: Boolean },\n      tag: { type: String },\n    };\n  }\n\n  feedUrl() {\n    if (this.tag) {\n      return `/feeds/tags/${this.tag}.json`;\n    }\n\n    return `/manifest/atom/atom-index.xml`;\n  }\n\n  render() {\n    const text = this.darkMode ? \"\u2600\uFE0F\" : \"\uD83C\uDF19\";\n    const brandText = BRAND_TEXT;\n\n    return html`\n    <nav class=\"header\" role=\"navigation\">\n      <ul>\n      <li @click=${this.broadcast(\"click-burger-menu\")}>\n      <a><span class=\"burger\">\u039E</span></a>\n      </li>\n      <li><a href=\"/\"><span class=\"brand\">${brandText}</span></a></li>\n\n      <li class=\"rss-tag\" style=\"float: right\">\n      <a id=\"rss\" title=\"rss\" href=\"${this.feedUrl()}\">\n      <svg alt=\"rss\" width=\"25px\" height=\"25px\" viewBox=\"0 0 32 32\" style=\"position: relative; top: 5px;\">\n      <path fill=\"#ff9132\" d=\"M 4.259,23.467c-2.35,0-4.259,1.917-4.259,4.252c0,2.349, 1.909,4.244, 4.259,4.244 c 2.358,0, 4.265-1.895, 4.265-4.244C 8.525,25.383, 6.618,23.467, 4.259,23.467zM 0.005,10.873l0,6.133 c 3.993,0, 7.749,1.562, 10.577,4.391c 2.825,2.822, 4.384,6.595, 4.384,10.603l 6.16,0 C 21.125,20.349, 11.648,10.873, 0.005,10.873zM 0.012,0l0,6.136 c 14.243,0, 25.836,11.604, 25.836,25.864L 32,32 C 32,14.36, 17.648,0, 0.012,0z\"></path>\n      </svg>\n      </a>\n      </li>\n\n      <li style=\"float: right\">\n      <a>\n      <span @click=${\n      this.broadcast(\"switch-theme\")\n    } class=\"brand switch\">${text}</span>\n      </a>\n      </li>\n\n      </ul>\n    </nav>\n    `;\n  }\n}\n\ncustomElements.define(\"photo-header\", PhotoHeader);\n", "/*\n * Utility classes for dealing with photos\n */\n\nconst coloursCache = new Map();\n\nexport class Photos {\n  /*\n   * Determine whether a photo should be eagerly or lazily loaded\n   * depending on page position\n   */\n  static loadingMode(idx: number) {\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n\n    const imageDimension = 400;\n    const maxImagesPerRow = Math.floor(viewportWidth / imageDimension);\n    const maxRowsInFold = Math.floor(viewportHeight / imageDimension);\n\n    return idx > (maxImagesPerRow * maxRowsInFold) + 1 ? \"lazy\" : \"eager\";\n  }\n\n  static encodeBitmapDataURL(colours: string) {\n    if (coloursCache.has(colours)) {\n      return coloursCache.get(colours);\n    }\n\n    const coloursList = colours.split(\"#\").map((colour: string) =>\n      `#${colour}`\n    );\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = 2;\n    canvas.height = 2;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) {\n      console.error('context missing, cannot render colours');\n      return;\n    }\n    ctx.fillStyle = coloursList[1];\n    ctx.fillRect(0, 0, 1, 1);\n    ctx.fillStyle = coloursList[2];\n    ctx.fillRect(1, 0, 1, 1);\n    ctx.fillStyle = coloursList[3];\n    ctx.fillRect(0, 1, 1, 1);\n    ctx.fillStyle = coloursList[4];\n    ctx.fillRect(1, 1, 1, 1);\n\n    coloursCache.set(colours, canvas.toDataURL(\"image/png\"));\n    return coloursCache.get(colours);\n  }\n}\n", "import { parseUrn } from \"js/library/tribble.js\";\nimport { html } from \"../../library/lit.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\nimport { Photos } from \"../../services/photos.ts\";\n\nexport class AppPhoto extends LitElem {\n  static get properties() {\n    return {\n      id: { type: String },\n      imageUrl: { type: String },\n      thumbnailUrl: { type: String },\n      mosaicColours: { type: String },\n      summary: { type: String },\n      loading: { type: String },\n    };\n  }\n\n  renderIcon() {\n    return html`\n    <svg class=\"photo-icon\" height=\"40\" width=\"40\" preserveAspectRatio=\"xMinYMin\" viewBox=\"-2 -2 24 24\"  xmlns=\"http://www.w3.org/2000/svg\"><path d=\"m10 20c-5.523 0-10-4.477-10-10s4.477-10 10-10 10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm0-10a1 1 0 0 1 1 1v5a1 1 0 0 1 -2 0v-5a1 1 0 0 1 1-1zm0-1a1 1 0 1 1 0-2 1 1 0 0 1 0 2z\"/></svg>\n    `;\n  }\n\n  hidePlaceholder(event) {\n    this.broadcast(\"photo-loaded\", { url: this.thumbnailUrl })();\n\n    const $placeholder = event.target.parentNode.querySelector(\n      \".thumbnail-placeholder\",\n    );\n    $placeholder.style.zIndex = -1;\n  }\n\n  render() {\n    if (!this.id) {\n      return html`<p>Missing photo ID</p>`;\n    }\n\n    const broadcastId = this.id.startsWith(\"urn:\")\n      ? parseUrn(this.id).id\n      : this.id;\n\n    const photoMetadata = {\n      id: broadcastId,\n      imageUrl: this.imageUrl,\n      thumbnailUrl: this.thumbnailUrl,\n      thumbnailDataUrl: Photos.encodeBitmapDataURL(this.mosaicColours),\n    };\n\n    // Yes this is a script injection risk, no I don't plan on doing that to myself.\n    const div = document.createElement(\"div\");\n    div.innerHTML = this.summary ?? \"\";\n    const sanitisedDangerously = div.textContent ?? div.innerText ?? \"\";\n\n    return html`\n    <div class=\"photo\">\n      <a href=\"${\n      \"#/metadata/\" + broadcastId\n    }\" onclick=\"event.preventDefault();\">\n        <div\n          @click=${this.broadcast(\"click-photo-metadata\", photoMetadata)}\n          class=\"photo-metadata-popover\">${this.renderIcon()}</div>\n      </a>\n\n      <a href=\"${this.imageUrl}\" target=\"_blank\" rel=\"external\">\n        <img class=\"u-photo thumbnail-image thumbnail-placeholder\" width=\"400\" height=\"400\" src=\"${photoMetadata.thumbnailDataUrl}\"/>\n\n        <img\n          @load=${this.hidePlaceholder.bind(this)} style=\"z-index: -1\"\n          class=\"thumbnail-image\"\n          alt=${sanitisedDangerously}\n          title=${sanitisedDangerously}\n          width=\"400\"\n          height=\"400\"\n          src=\"${this.thumbnailUrl}\"\n          loading=\"${this.loading}\"/>\n      </a>\n    </div>\n    `;\n  }\n}\n\ncustomElements.define(\"app-photo\", AppPhoto);\n", "export class JSONFeed {\n  static getElement() {\n    return document.getElementById(\"rss\");\n  }\n\n  static setTag(tag) {\n    const $rss = this.getElement();\n    if (!$rss || !tag) {\n      return;\n    }\n\n    const feedUrl = `/feeds/tags/${tag}.json`;\n    $rss.href = feedUrl;\n  }\n\n  static setIndex() {\n    const $rss = this.getElement();\n    if (!$rss) {\n      return;\n    }\n\n    const feedUrl = `/manifest/atom/atom-index.xml`;\n    $rss.href = feedUrl;\n  }\n}\n", "/*\n * #/photos\n *\n * List all photos\n */\n\nimport { html } from \"../../library/lit.js\";\n\nimport { asyncAppend } from \"../../library/lit.js\";\nimport \"../components/photo.ts\";\nimport { Photos } from \"../../services/photos.ts\";\nimport { JSONFeed } from \"../../services/json-feed.ts\";\nimport { LitElem } from \"../../models/lit-element.ts\";\nimport { asUrn } from \"js/library/tribble.js\";\n\nexport class PhotosPage extends LitElem {\n  static get properties() {\n    return {\n      triples: { type: Object, state: true },\n    };\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n\n    JSONFeed.setIndex();\n  }\n\n  allImages() {\n    // NOTE: this is really slow now!\n    return this.triples.search({\n      source: { type: \"photo\" },\n      relation: {\n        relation: [\n          \"thumbnail_url\",\n          \"mosaic_colours\",\n          \"full_image\",\n        ],\n      },\n      target: {\n        type: \"unknown\",\n      },\n    }).objects().sort((left, right) => {\n      return right.created_at - left.created_at;\n    });\n  }\n\n  render() {\n    const photos = this.allImages();\n\n    async function* photosIterable() {\n      for (let idx = 0; idx < photos.length; idx++) {\n        const photo = photos[idx];\n\n        if (idx % 4 === 0) {\n          await new Promise(res => setTimeout(res, 0));\n        }\n\n        yield html`\n          <app-photo\n            id=${asUrn(photo.id).id}\n            loading=\"${Photos.loadingMode(idx)}\"\n            thumbnailUrl=\"${photo.thumbnail_url}\"\n            mosaicColours=\"${photo.mosaic_colours}\"\n            imageUrl=\"${photo.full_image}\"></app-photo>`;\n      }\n    }\n\n    return html`\n    <div>\n      <section class=\"photos-metadata\">\n        <h1>Photos</h1>\n        <p class=\"photo-album-count\">${photos.length} photos</p>\n      </section>\n\n      <section class=\"photo-container\">\n        ${asyncAppend(photosIterable())}\n      </section>\n    </div>\n    `;\n  }\n}\n\ncustomElements.define(\"photos-page\", PhotosPage);\n", "import { STATS_SYMBOL } from \"js/constants.js\";\nimport { html } from \"../../library/lit.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\n\nexport class PhotosStats extends LitElem {\n  static get properties() {\n    return {\n      albums: { type: Array },\n    };\n  }\n\n  render() {\n    const $statsData = document.getElementById(\"stats-data\");\n    const stats = JSON.parse($statsData.innerText);\n\n    return html`\n      <p class=\"photo-stats\">${stats.photos} <a href=\"#/photos\">photos</a> \u00B7\n        ${stats.albums} albums \u00B7 ${stats.years} years \u00B7\n        ${stats.countries} <span title=\"well, roughly\">countries</span> \u00B7\n        ${stats.bird_species} <a href=\"#/thing/bird:*\">bird species</a> \u00B7\n        ${stats.mammal_species} <a href=\"#/thing/mammal:*\">mammal species</a> \u00B7\n        ${stats.unesco_sites} <a href=\"#/thing/unesco:*\">UNESCO sites</a>\n      </p>\n    `;\n  }\n}\n\ncustomElements.define(\"photos-stats\", PhotosStats);\n", "/*\n * Utility code for detailing with dates & rendering them\n */\n\nexport class Dates {\n  static parse(dateTime) {\n    let [date, time] = dateTime.split(\" \");\n    date = date.replace(/:/g, \"-\");\n\n    return new Date(`${date} ${time}`);\n  }\n\n  static formatExifDate(dateTime) {\n    if (!dateTime) {\n      return dateTime;\n    }\n\n    const createdAt = new Date(dateTime).toISOString();\n    const [date, time] = createdAt.split(\"T\")[0].replace(/\\:/g, \"-\");\n\n    return `${date.replace(/\\:/g, \"/\")} ${time}`;\n  }\n\n  static findRange(images) {\n    let minimum = Infinity;\n    let maximum = -Infinity;\n\n    for (const image of images) {\n      if (!image.created_at) {\n        continue;\n      }\n\n      const parsedDate = Dates.parse(image.created_at);\n      if (parsedDate < minimum) {\n        minimum = parsedDate;\n      }\n\n      if (parsedDate > maximum) {\n        maximum = parsedDate;\n      }\n    }\n\n    return [minimum, maximum];\n  }\n\n  static dateRange(minDate, maxDate, smallDevice) {\n    if (!minDate && !maxDate) {\n      return \"unknown date\";\n    }\n\n    const parsedMinDate = minDate instanceof Date\n      ? minDate\n      : new Date(parseFloat(minDate));\n    const parsedMaxDate = maxDate instanceof Date\n      ? maxDate\n      : new Date(parseFloat(maxDate));\n\n    if (smallDevice) {\n      const optsShort = {\n        day: \"numeric\",\n        month: \"short\",\n      };\n      const from = parsedMinDate.toLocaleDateString(\"en-IE\", optsShort);\n      const to = parsedMaxDate.toLocaleDateString(\"en-IE\", optsShort);\n\n      const minDay = parsedMinDate.toLocaleDateString(\"en-IE\", {\n        day: \"numeric\",\n      });\n      const maxDay = parsedMaxDate.toLocaleDateString(\"en-IE\", {\n        day: \"numeric\",\n      });\n\n      const minMonth = parsedMinDate.toLocaleDateString(\"en-IE\", {\n        month: \"short\",\n      });\n      const maxMonth = parsedMaxDate.toLocaleDateString(\"en-IE\", {\n        month: \"short\",\n      });\n\n      const minYear = parsedMinDate.getFullYear();\n      const maxYear = parsedMaxDate.getFullYear();\n\n      const monthsEqual = minMonth === maxMonth;\n      const yearsEqual = minYear === maxYear;\n\n      if (from === to) {\n        // e.g 22 Feb 2022\n        return `${from} ${minYear}`;\n      } else if (monthsEqual && yearsEqual) {\n        // e.g 22 - 24 Feb 2022\n\n        return `${minDay} - ${maxDay} ${maxMonth} ${minYear}`;\n      } else {\n        return `${from} ${minYear} - ${to} ${maxYear}`;\n      }\n    } else {\n      const opts = {\n        year: \"numeric\",\n        month: \"short\",\n        day: \"numeric\",\n      };\n      const from = parsedMinDate.toLocaleDateString(\"en-IE\", opts);\n      const to = parsedMaxDate.toLocaleDateString(\"en-IE\", opts);\n\n      if (from === to) {\n        return from;\n      }\n\n      return `${from} \u2014 ${to}`;\n    }\n  }\n}\n", "import { Triple } from \"js/types.js\";\nimport { KnownRelations } from \"../constants.js\";\nimport { parseUrn } from \"../library/tribble.js\";\n\nconst CONFIG = window.envConfig;\n\nexport class Triples {\n  static isUrnSource(triple: [string, string, string]) {\n    return Things.isUrn(triple[0]);\n  }\n  static hasRelation(triple: [string, string, string], relation: string) {\n    return triple[1] === relation;\n  }\n  static hasUrnTarget(triple: [string, string, string]) {\n    return Things.isUrn(triple[2]);\n  }\n\n  static getSource(triple: [string, string, string]) {\n    return triple[0];\n  }\n\n  static getRelation(triple: [string, string, string]) {\n    return triple[1];\n  }\n\n  static getTarget(triple: [string, string, string]) {\n    return triple[2];\n  }\n}\n\nexport class Things {\n  // TODO handle arrays\n  static isUrn(candidate) {\n    return candidate && candidate.startsWith(\"urn:r\u00F3\");\n  }\n  static parseUrn(urn: string) {\n    if (!Things.isUrn(urn)) {\n      throw new Error(`Invalid URN: ${urn}`);\n    }\n\n    const type = urn.split(\":\")[2];\n    const [urnPart, queryString] = urn.split(\"?\");\n    const id = urnPart.split(\":\")[3];\n    const qs = queryString\n      ? Object.fromEntries(new URLSearchParams(queryString))\n      : {};\n\n    return {\n      type,\n      id,\n      qs,\n    };\n  }\n\n  static is(urn, type) {\n    return Things.isUrn(urn) && Things.parseUrn(urn).type === type;\n  }\n\n  static toURL(urn) {\n    if (!Things.isUrn(urn)) {\n      throw new Error(`Invalid URN: ${urn}`);\n    }\n\n    const { type, id } = Things.parseUrn(urn);\n    return `#/thing/${type}:${id}`;\n  }\n\n  static sameURN(urn1, urn2) {\n    if (!Things.isUrn(urn1) || !Things.isUrn(urn2)) {\n      return false;\n    }\n\n    const parsed1 = Things.parseUrn(urn1);\n    const parsed2 = Things.parseUrn(urn2);\n\n    return parsed1.type === parsed2.type && parsed1.id === parsed2.id;\n  }\n\n  static isRating(value) {\n    return /^[\u2B50]{1,5}$/.test(value);\n  }\n\n  static hasId(urn, id) {\n    return Things.isUrn(urn) && Things.parseUrn(urn).id === id;\n  }\n\n  static sameType(urn0, urn1) {\n    if (!Things.isUrn(urn0) || !Things.isUrn(urn1)) {\n      return false;\n    }\n\n    const parsed0 = Things.parseUrn(urn0);\n    const parsed1 = Things.parseUrn(urn1);\n\n    return parsed0.type === parsed1.type;\n  }\n\n  static isType(urn, type) {\n    if (!Things.isUrn(urn)) {\n      return false;\n    }\n\n    const parsed = Things.parseUrn(urn);\n    return parsed.type === type;\n  }\n}\n\nexport class Binomials {\n  static pretty(binomial) {\n    const pretty = binomial.replace(/-/g, \" \");\n    return pretty.charAt(0).toUpperCase() + pretty.slice(1);\n  }\n\n  static toCommonName(tdb, binomial) {\n    return tdb.search({\n      source: { id: binomial },\n      relation: KnownRelations.NAME,\n    }).firstTarget() ?? binomial;\n  }\n\n  static birdwatchUrl(tdb, urn) {\n    const { id } = parseUrn(urn);\n\n    return tdb.search({\n      source: { id },\n      relation: KnownRelations.BIRDWATCH_URL,\n    }).firstTarget();\n  }\n}\n\nexport class Countries {\n  // TODO deprecate this, as we move away from passing\n  // non URN data to the client\n  static details(tdb: any, name: string) {\n    // narrow down the search to triples about country names and flags\n    const countriesData = tdb.search({\n      source: { type: \"country\" },\n      relation: { relation: [KnownRelations.NAME, KnownRelations.FLAG] },\n    });\n\n    // grab the URN based on the name\n    const urn = countriesData.search({\n      relation: KnownRelations.NAME,\n      target: { id: name },\n    }).firstSource();\n\n    const parsed = parseUrn(urn);\n\n    // and the flag based on the URN\n    const flag = countriesData.search({\n      source: parsed,\n      relation: KnownRelations.FLAG,\n    }).firstTarget();\n\n    return {\n      urn,\n      name,\n      flag,\n    };\n  }\n\n  static urnDetails(tdb: any, urn: string) {\n    const parsed = parseUrn(urn);\n\n    // narrow down the search to triples about country names and flags\n    const name = tdb.search({\n      source: { type: \"country\", id: parsed.id },\n      relation: KnownRelations.NAME,\n    }).firstTarget();\n\n    return {\n      urn,\n      name,\n    };\n  }\n}\n\n/*\n * We enter ratings as literals; convert them to URNs\n *\n */\nexport function ratingsAsUrns(triple: Triple) {\n  if (Triples.getRelation(triple) !== KnownRelations.RATING) {\n    return [triple];\n  }\n\n  return [[\n    Triples.getSource(triple),\n    Triples.getRelation(triple),\n    `urn:r\u00F3:rating:${encodeURIComponent(Triples.getTarget(triple))}`,\n  ]];\n}\n\n/*\n * Convert `country` relations to URNs\n *\n */\nexport function countriesAsUrns(triple: Triple) {\n  if (Triples.getRelation(triple) !== KnownRelations.COUNTRY) {\n    return [triple];\n  }\n\n  const countryId = Triples.getTarget(triple).toLowerCase().replace(\" \", \"-\");\n  const countryUrn = `urn:r\u00F3:country:${countryId}`;\n\n  return [\n    [\n      Triples.getSource(triple),\n      Triples.getRelation(triple),\n      countryUrn\n    ],\n  ];\n}\n\n/*\n * We remove CDN hostnames from our URLS; re-add them for relevant\n * relations\n *\n */\nexport function expandCdnUrls(triple: Triple) {\n  for (\n    const relation of [\n      \"thumbnail_url\",\n      \"full_image\",\n      \"poster_url\",\n      \"video_url_1080p\",\n      \"video_url_480p\",\n      \"video_url_720p\",\n      \"video_url_unscaled\",\n    ]\n  ) {\n    if (Triples.getRelation(triple) === relation) {\n      return [\n        [\n          Triples.getSource(triple),\n          relation,\n          `${CONFIG.photos_url}${Triples.getTarget(triple)}`,\n        ],\n      ];\n    }\n  }\n\n  return [triple];\n}\n\nexport function expandBirdwatchUrl(triple: Triple) {\n  if (Triples.getRelation(triple) !== KnownRelations.BIRDWATCH_URL) {\n    return [triple];\n  }\n\n  return [\n    [\n      Triples.getSource(triple),\n      KnownRelations.BIRDWATCH_URL,\n      `https://birdwatchireland.ie/birds/${Triples.getTarget(triple)}`,\n    ]\n  ]\n}\n\n/*\n * For compression, we remove urn prefixes from URNs before transmitting them. Re-add them\n *\n * @param triple The triple to expand\n */\nexport function expandUrns(triple: Triple) {\n  const [source, relation, target] = triple;\n\n  return [[\n    source.startsWith(\"::\") ? `urn:r\u00F3:${source.slice(2)}` : source,\n    relation,\n    target.startsWith(\"::\") ? `urn:r\u00F3:${target.slice(2)}` : target,\n  ]];\n}\n", "import { html } from \"../../library/lit.js\";\nimport { parseUrn } from \"../../library/tribble.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\nimport { Dates } from \"../../services/dates.ts\";\nimport { Photos } from \"../../services/photos.ts\";\nimport { Countries } from \"../../things/things.ts\";\n\nexport class PhotoAlbum extends LitElem {\n  static get properties() {\n    return {\n      title: { type: String },\n      triples: { type: Object, state: true },\n      url: { type: String },\n      mosaicColours: { type: String },\n      minDate: { type: String },\n      maxDate: { type: String },\n      id: { type: String },\n      count: { type: Number },\n      countries: { type: String },\n      loading: { type: String },\n    };\n  }\n\n  dateRange() {\n    if (!this.minDate && !this.maxDate) {\n      return \"unknown date\";\n    }\n    const mediaQuery = window.matchMedia(\"(max-width: 500px)\");\n\n    return Dates.dateRange(this.minDate, this.maxDate, mediaQuery.matches);\n  }\n\n  hidePlaceholder(event) {\n    this.broadcast(\"photo-loaded\", { url: this.url })();\n\n    const $placeholder = event.target.parentNode.querySelector(\n      \".thumbnail-placeholder\",\n    );\n    $placeholder.style.zIndex = -1;\n  }\n\n  renderCountries() {\n    return this.countries.split(\",\").map((country) => {\n      const { flag, urn } = Countries.details(this.triples, country);\n\n      const parsed = parseUrn(urn);\n\n      // TODO swap for an anchor tag\n      return html`<span href=\"#/thing/country:${parsed.id}\" title=${country}>${flag}</span>`;\n    });\n  }\n\n  render() {\n    performance.mark(`start-album-render-${this.url}`);\n\n    const thumbnailDataUrl = Photos.encodeBitmapDataURL(this.mosaicColours);\n    const flags = this.renderCountries();\n\n    const albumId = parseUrn(this.id);\n\n    return html`\n    <div class=\"photo-album\">\n      <a href=\"${\"/#/album/\" + this.id}\" onclick=\"event.preventDefault();\">\n        <img class=\"thumbnail-image thumbnail-placeholder\" width=\"400\" height=\"400\" src=\"${thumbnailDataUrl}\"/>\n        <img @load=${\n      this.hidePlaceholder.bind(this)\n    } style=\"z-index: -1\" class=\"u-photo thumbnail-image\" width=\"400\" height=\"400\" src=\"${this.url}\" alt=\"${this.title} - Photo Album Thumbnail\" loading=\"${this.loading}\"\n        @click=${\n      this.broadcast(\"click-album\", {\n        id: albumId.id,\n        title: this.title,\n      })\n    }>\n    </a>\n      <div class=\"photo-album-metadata\">\n        <p class=\"photo-album-title\">${this.title}</p>\n        <p class=\"photo-album-date\" data-min-date=${this.minDate}>\n          <time>${this.dateRange()}</time>\n        </p>\n        <div class=\"photo-metadata-inline\">\n        <p class=\"photo-album-count\">${this.count} ${\n      this.count === 1 ? \"photo\" : \"photos\"\n    }</p>\n        <p class=\"photo-album-countries\">${flags}</p>\n        </div>\n\n    </div>\n    </div>\n    `;\n  }\n}\n\ncustomElements.define(\"photo-album\", PhotoAlbum);\n", "import { html } from \"../../library/lit.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\n\nexport class YearCursor extends LitElem {\n  datesCache: {\n    position: DOMRect;\n    minDate: number;\n  }[];\n\n  constructor() {\n    super();\n    this._onScroll = this._onScroll.bind(this);\n    this._clearCacheOnResize = this._clearCacheOnResize.bind(this);\n    this.datesCache = [];\n  }\n\n  _onScroll() {\n    const yearCursor = document.getElementById(\"year-cursor\");\n    if (window.scrollY < 200) {\n      if (yearCursor) {\n        yearCursor.style.display = \"none\";\n      }\n      return;\n    } else if (yearCursor) {\n      yearCursor.style.display = \"block\";\n    }\n\n    const dates = this.getDates();\n\n    let firstBelowPositionHeight: number | undefined = undefined;\n    const row: {\n      position: DOMRect;\n      minDate: number;\n    }[] = [];\n\n    // efficiently get the dates below the current window position;\n    // collect a list of ones on the same row\n    for (let idx = 0; idx < dates.length; idx++) {\n      if (dates[idx].position.top > window.scrollY) {\n        if (!firstBelowPositionHeight) {\n          firstBelowPositionHeight = dates[idx].position.top;\n          row.push(dates[idx]);\n        }\n\n        if (dates[idx].position.top === firstBelowPositionHeight) {\n          row.push(dates[idx]);\n        } else {\n          break;\n        }\n      }\n    }\n\n    const minimumDate = Math.min(...row.map((item) => item.minDate));\n    const dateSummary = new Date(minimumDate);\n    const monthYearString = dateSummary.toLocaleString(\"default\", {\n      month: \"short\",\n      year: \"numeric\",\n    });\n\n    if (yearCursor && monthYearString !== \"Invalid Date\") {\n      yearCursor.textContent = monthYearString;\n    }\n  }\n\n  _clearCacheOnResize() {\n    this.datesCache = [];\n  }\n\n  getDates() {\n    if (this.datesCache.length > 0) {\n      return this.datesCache;\n    }\n    const $dates = document.querySelectorAll(\".photo-album-date\");\n    const details = Array.from($dates).flatMap((date: Element) => {\n      const minDate = date.getAttribute(\"data-min-date\");\n\n      if (!minDate) {\n        return [];\n      }\n      return [{\n        position: date.getBoundingClientRect(),\n        minDate: parseInt(minDate, 10),\n      }];\n    });\n\n    this.datesCache = details;\n    return this.datesCache;\n  }\n\n  override connectedCallback(): void {\n    super.connectedCallback();\n    window.addEventListener(\"scroll\", this._onScroll, { passive: true });\n    window.addEventListener(\"resize\", this._clearCacheOnResize, {\n      passive: true,\n    });\n  }\n\n  override disconnectedCallback(): void {\n    window.removeEventListener(\"scroll\", this._onScroll);\n    window.removeEventListener(\"scroll\", this._clearCacheOnResize);\n  }\n\n  render() {\n    return html`<div id=\"year-cursor\"></div>`;\n  }\n}\n\ncustomElements.define(\"year-cursor\", YearCursor);\n", "/*\n * /#/albums\n *\n * All albums. Shows cover photos in a grid + some basic album information.\n */\n\nimport { asyncAppend } from \"../../library/lit.js\";\nimport { html } from \"../../library/lit.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\nimport { JSONFeed } from \"../../services/json-feed.ts\";\nimport { Photos } from \"../../services/photos.ts\";\n\nimport \"../components/photos-stats.ts\";\nimport \"../components/photo-album.ts\";\nimport \"../components/year-cursor.ts\";\n\nexport class AlbumsPage extends LitElem {\n  static get properties() {\n    return {\n      albums: { type: Object },\n      triples: { type: Object, state: true },\n    };\n  }\n  connectedCallback() {\n    super.connectedCallback();\n\n    JSONFeed.setIndex();\n  }\n  getAlbums() {\n    return this.triples.search({\n      source: { type: \"album\" },\n    }).objects().map((album) => {\n      return {\n        title: album.name,\n        minDate: parseInt(album.min_date),\n        maxDate: parseInt(album.max_date),\n        url: album.thumbnail_url,\n        mosaicColours: album.mosaic,\n        id: album.id,\n        count: album.photos_count,\n        flags: album.flags,\n      };\n    });\n  }\n\n  render() {\n    performance.mark(\"start-albums-render\");\n\n    const sorted = this.getAlbums()\n      .sort((album0, album1) => {\n        return album1.maxDate - album0.maxDate;\n      });\n\n    /*\n     * append photo albums to the DOM\n     */\n    async function* albumIterable() {\n      let year = 2000;\n      const currentYear = new Date().getFullYear();\n\n      for (let idx = 0; idx < sorted.length; idx++) {\n        const album = sorted[idx];\n        const loading = Photos.loadingMode(idx);\n\n        const albumYear = new Date(album.minDate).getFullYear();\n        if (albumYear !== year) {\n          year = albumYear;\n\n          if (albumYear !== currentYear) {\n            yield html`<h2 class=\"album-year-heading\">${albumYear}</h2>`;\n          }\n        }\n\n        if (idx % 4 === 0) {\n          await new Promise(res => setTimeout(res, 0));\n        }\n\n        yield html`\n          <photo-album\n            .triples=${this.triples}\n            title=\"${album.title}\"\n            url=\"${album.url}\"\n            mosaicColours=\"${album.mosaicColours}\"\n            id=\"${album.id}\" count=\"${album.count}\"\n            minDate=\"${album.minDate}\"\n            maxDate=\"${album.maxDate}\"\n            countries=\"${album.flags}\"\n            loading=${loading}>\n            </photo-album>\n          `;\n      }\n    }\n\n    return html`\n    <section class=\"album-metadata\">\n      <h1 class=\"albums-header\">Albums</h1>\n      <photos-stats></photos-stats>\n    </section>\n\n    <year-cursor></year-cursor>\n\n    <section class=\"album-container\">\n      ${asyncAppend(albumIterable.bind(this)())}\n    </section>\n    `;\n  }\n}\n\ncustomElements.define(\"albums-page\", AlbumsPage);\n", "import { html } from \"../../library/lit.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\n\nexport class AppVideo extends LitElem {\n  static get properties() {\n    return {\n      id: { type: String },\n      url: { type: String },\n      preload: { type: String },\n      url_poster: { type: String },\n      url_unscaled: { type: String },\n      url_1080p: { type: String },\n      url_720p: { type: String },\n      url_480p: { type: String },\n    };\n  }\n\n  render() {\n    return html`\n    <div>\n      <video controls class=\"thumbnail-video\" preload=\"${this.preload}\" poster=${this.url_poster}>\n        <source src=\"${this.url_480p}\" type=\"video/mp4\">\n      </video>\n      <ul>\n        <a href=\"${this.url_unscaled}\">[L]</a>\n        <a href=\"${this.url_1080p}\">[M]</a>\n        <a href=\"${this.url_720p}\">[S]</a>\n        <a href=\"${this.url_480p}\">[XS]</a>\n      </ul>\n\n    </div>\n    `;\n  }\n}\n\ncustomElements.define(\"app-video\", AppVideo);\n", "import { html } from \"../../library/lit.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\n\nexport class AlbumShareButton extends LitElem {\n  static get properties() {\n    return {\n      title: { type: String },\n      url: { type: String },\n      sharing: { state: true, type: Boolean },\n    };\n  }\n\n  /*\n   * Share an image using the Web Share API, if available.\n   *\n   * @param {string} url the url of the image to share\n   */\n  async shareAlbum(url) {\n    if (!navigator.share) {\n      console.error(\"navigator.share not available\");\n    } else {\n      this.sharing = true;\n\n      try {\n        await navigator.share({\n          title: `${this.title} - photos.rgrannell.xyz`,\n          url,\n        });\n      } finally {\n        this.sharing = false;\n      }\n    }\n  }\n\n  render() {\n    if (this.sharing) {\n      return html`<button class=\"photo-share-button\" disabled>[sharing...]</button>`;\n    } else {\n      return html`\n      <button class=\"photo-share-button\" ?disabled=${!navigator.share} @click=${\n        this.shareAlbum.bind(this, this.url)\n      }>[share]</button>\n      `;\n    }\n  }\n}\n\ncustomElements.define(\"album-share-button\", AlbumShareButton);\n", "/*\n * Construct a link for a urn:r\u00F3 arn\n */\nimport { KnownRelations, KnownThings } from \"../../constants.js\";\n\nimport { html } from \"../../library/lit.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\nimport { Things } from \"../../things/things.ts\";\n\nimport { BinomialTypes } from \"../../constants.js\";\nimport { Binomials } from \"../../things/things.ts\";\n\nexport class UnescoLink extends LitElem {\n  static properties = {\n    urn: { type: String },\n  };\n\n  id() {\n    return Things.parseUrn(this.urn)?.id ?? \"unknown\";\n  }\n\n  url() {\n    return this.id() ? `https://whc.unesco.org/en/list/${this.id()}` : null;\n  }\n\n  render() {\n    if (!this.id()) {\n      return html`<span>Invalid UNESCO URN</span>`;\n    }\n    return html`\n      <a class=\"unesco-link\" href=\"${this.url()}\" target=\"_blank\" rel=\"noopener noreferrer\">\n        <span class=\"unesco-text-full\">UNESCO World Heritage Site #${this.id()}</span>\n        <span class=\"unesco-text-short\">UNESCO #${this.id()}</span>\n      </a>\n    `;\n  }\n}\n\ncustomElements.define(\"unesco-link\", UnescoLink);\n\nexport class ThingLink extends LitElem {\n  static properties = {\n    urn: { type: String },\n    triples: { type: Array },\n  };\n\n  name() {\n    const { type, id } = Things.parseUrn(this.urn);\n\n    if (BinomialTypes.has(type)) {\n      return html`<span>${Binomials.toCommonName(this.triples, id)}</span>`;\n    }\n    const name = this.triples.search({\n      source: Things.parseUrn(this.urn),\n      relation: KnownRelations.NAME,\n    }).firstTarget();\n\n    if (name) {\n      return html`<span>${name}</span>`;\n    }\n\n    return decodeURIComponent(id);\n  }\n\n  linkClass() {\n    const { type } = Things.parseUrn(this.urn);\n\n    const classes = {\n      [KnownThings.BIRD]: \"bird-link\",\n      [KnownThings.MAMMAL]: \"mammal-link\",\n      [KnownThings.REPTILE]: \"reptile-link\",\n      [KnownThings.AMPHIBIAN]: \"amphibian-link\",\n      [KnownThings.FISH]: \"fish-link\",\n      [KnownThings.INSECT]: \"insect-link\",\n    };\n\n    return classes[type] ?? \"\";\n  }\n\n  render() {\n    if (!Things.isUrn(this.urn)) {\n      return html`<span>Invalid URN</span>`;\n    }\n\n    return html`\n      <a class=\"thing-link ${this.linkClass()}\" href=\"${\n      Things.toURL(this.urn)\n    }\">${this.name()}</a>\n    `;\n  }\n}\n\ncustomElements.define(\"thing-link\", ThingLink);\n", "/*\n * /#/album/<id>\n *\n * Each individual album page. Shows photos, videos, and some album metadata\n */\n\nimport { html, unsafeHTML } from \"../../library/lit.js\";\nimport { parseUrn } from \"../../library/tribble.js\";\n\nimport \"../components/photo.ts\";\nimport \"../components/video.ts\";\nimport \"../components/share.ts\";\nimport \"../components/thing-link.ts\";\n\nimport { Dates } from \"../../services/dates.ts\";\nimport { Photos } from \"../../services/photos.ts\";\nimport { JSONFeed } from \"../../services/json-feed.ts\";\nimport { Countries, Things } from \"../../things/things.ts\";\nimport { LitElem } from \"../../models/lit-element.ts\";\nimport { KnownRelations, KnownThings } from \"../../constants.js\";\n\nexport class AlbumPage extends LitElem {\n  static get properties() {\n    return {\n      title: { type: String },\n      id: { type: String },\n      minDate: { type: String },\n      maxDate: { type: String },\n      imageCount: { type: Number },\n      description: { type: String },\n      triples: { type: Object, state: true },\n      countries: { type: String },\n    };\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    JSONFeed.setIndex();\n  }\n\n  albumPhotos(tdb) {\n    const albumPhotoSources: Set<string> = tdb.search({\n      source: { type: \"photo\" },\n      relation: \"album_id\",\n      target: { id: this.id },\n    }).sources();\n\n    return Array.from(albumPhotoSources).flatMap((source: string) => {\n      const info = tdb.search({\n        source: parseUrn(source),\n      }).firstObject();\n\n      return info ? [info] : [];\n    });\n  }\n\n  albumVideos(tdb) {\n    const albumVideoIds: Set<string> = tdb.search({\n      source: {\n        type: \"video\",\n      },\n      relation: \"album_id\",\n      target: {\n        id: this.id,\n      },\n    }).sources();\n\n    return Array.from(albumVideoIds).flatMap((source: string) => {\n      const info = tdb.search({\n        source: parseUrn(source),\n      }).firstObject();\n\n      return info ? [info] : [];\n    });\n  }\n\n  renderPhotoCount() {\n    return this.imageCount === 1\n      ? `${this.imageCount} photo`\n      : `${this.imageCount} photos`;\n  }\n\n  thingsLinks(tdb) {\n    const groups = {};\n    const albumPhotos = this.albumPhotos(tdb);\n\n    for (const type of [KnownThings.UNESCO]) {\n      groups[type] = Array.from(\n        new Set(\n          albumPhotos.flatMap((photo: Record<string, string | string[]>) => {\n            return photo[KnownRelations.LOCATION]?.filter(\n              (location: string) => {\n                return Things.is(location, type);\n              },\n            );\n          }).filter((val) => val),\n        ),\n      );\n    }\n\n    for (\n      const type of [\n        KnownThings.BIRD,\n        KnownThings.MAMMAL,\n        KnownThings.REPTILE,\n        KnownThings.FISH,\n        KnownThings.AMPHIBIAN,\n        KnownThings.INSECT,\n      ]\n    ) {\n      groups[type] = Array.from(\n        new Set(\n          albumPhotos.flatMap((photo) => {\n            return photo[KnownRelations.SUBJECT]?.filter(\n              (subject: string) => {\n                return Things.is(subject, type);\n              },\n            );\n          }).filter((val) => val),\n        ),\n      );\n    }\n\n    let links = [];\n\n    links = links.concat(groups[KnownThings.UNESCO].map((urn) => {\n      return html`<unesco-link urn=\"${urn}\"></unesco-link>`;\n    }));\n\n    for (\n      const type of [\n        KnownThings.BIRD,\n        KnownThings.MAMMAL,\n        KnownThings.REPTILE,\n        KnownThings.FISH,\n        KnownThings.AMPHIBIAN,\n        KnownThings.INSECT,\n      ]\n    ) {\n      links = links.concat(groups[type].map((urn) => {\n        return html`<thing-link .urn=\"${urn}\" .triples=\"${this.triples}\"></thing-link>`;\n      }));\n    }\n\n    return links;\n  }\n\n  render() {\n    const tdb = this.triples;\n\n    const mediaQuery = window.matchMedia(\"(max-width: 500px)\");\n    const range = Dates.dateRange(\n      this.minDate,\n      this.maxDate,\n      mediaQuery.matches,\n    );\n\n    const albumPhotos = this.albumPhotos(tdb);\n    const photos = albumPhotos.map((photo, idx) => {\n      return html`\n      <app-photo\n        id=${photo.id}\n        summary=${photo.summary}\n        loading=\"${Photos.loadingMode(idx)}\"\n        thumbnailUrl=\"${photo.thumbnail_url}\"\n        mosaicColours=\"${photo.mosaic_colours}\"\n        imageUrl=\"${photo.full_image}\"></app-photo>`;\n    });\n\n    const videos = this.albumVideos(tdb).map((video, idx) => {\n      return html`<app-video\n        id=${video.id}\n        url_poster=${video.poster_url}\n        url_unscaled=${video.video_url_unscaled}\n        url_1080p=${video.video_url_1080p}\n        url_720p=${video.video_url_720p}\n        url_480p=${video.video_url_480p}\n        ></app-video>`;\n    });\n\n    const flags = this?.countries.split(\",\").map((country: string) => {\n      const { flag, urn } = Countries.details(this.triples, country);\n\n      const parsed = parseUrn(urn);\n\n      // TODO swap for an anchor tag\n      return html`<span href=\"#/thing/country:${parsed.id}\" title=${country}>${flag}</span>`;\n    });\n\n    return html`\n    <div>\n      <section class=\"photos-metadata\">\n        <h1>${this.title}</h1>\n        <p class=\"photo-album-date\">\n          <time>${range}</time>\n        </p>\n        <p class=\"photo-album-count\">${this.renderPhotoCount()}</p>\n        <p class=\"photo-album-countries\">${flags}</p>\n        <p class=\"photo-album-description\">${unsafeHTML(this.description)}\n        </p>\n\n        <album-share-button\n          .title=${this.title}\n          .url=${window.location.href}></album-share-button>\n        <a href=\"#/albums\">[albums]</a>\n\n        <ul class=\"unesco-links\">\n          ${this.thingsLinks(tdb).map((link) => html`<li>${link}</li>`)}\n        </ul>\n\n      </section>\n\n      <section class=\"photo-container\">\n        ${photos}\n      </section>\n\n      <section class=\"video-container\">\n        ${videos}\n      </section>\n    </div>\n    `;\n  }\n}\n\ncustomElements.define(\"album-page\", AlbumPage);\n", "import { html } from \"../../library/lit.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\n\nexport class ShareButton extends LitElem {\n  static get properties() {\n    return {\n      url: { type: String },\n      format: { type: String },\n      sharing: { state: true, type: Boolean },\n    };\n  }\n\n  /*\n   * Share an image using the Web Share API, if available.\n   *\n   * @param {string} url the url of the image to share\n   */\n  async shareImage(url) {\n    if (!navigator.share) {\n      console.error(\"navigator.share not available\");\n    } else {\n      this.sharing = true;\n\n      try {\n        const response = await fetch(url);\n        const resourceName = (new URL(url)).pathname;\n\n        await navigator.share({\n          title: resourceName,\n          files: [\n            new File([await response.blob()], resourceName, {\n              type: this.format,\n            }),\n          ],\n        });\n      } finally {\n        this.sharing = false;\n      }\n    }\n  }\n\n  render() {\n    if (this.sharing) {\n      return html`<button class=\"photo-share-button\" disabled>[sharing...]</button>`;\n    } else {\n      return html`\n      <button class=\"photo-share-button\" ?disabled=${!navigator.share} @click=${\n        this.shareImage.bind(this, this.url)\n      }>[share]</button>\n      `;\n    }\n  }\n}\n\ncustomElements.define(\"share-metadata-button\", ShareButton);\n", "import { html } from \"../../library/lit.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\n\nexport class TagLink extends LitElem {\n  static get properties() {\n    return {\n      tagName: { type: String },\n      count: { type: Number },\n    };\n  }\n\n  render() {\n    const { tagName, count } = this;\n    const encodedTagName = encodeURIComponent(tagName);\n\n    if (typeof count === \"undefined\") {\n      return html`<a\n        href=\"#/tag/${encodedTagName}\"\n        @click=${this.broadcast(\"click-tag\", { tagName })}>${tagName}</a>`;\n    }\n\n    return html`<a\n      href=\"#/tag/${encodedTagName}\"\n      rel=\"tag\"\n      @click=${\n      this.broadcast(\"click-tag\", { tagName })\n    }>${tagName}</a> (${count})`;\n  }\n}\n\ncustomElements.define(\"tag-link\", TagLink);\n", "/*\n * /#/metadata/<photo-id\n *\n * Shows information about the photo, like:\n * - Exif data\n * - Semantic data\n * - Links & Sharing Options\n */\n\nimport { html, unsafeHTML } from \"../../library/lit.js\";\nimport { LitElem } from \"../../models/lit-element.ts\";\nimport { JSONFeed } from \"../../services/json-feed.ts\";\n\nimport \"../components/share-button.ts\";\nimport \"../components/thing-link.ts\";\nimport \"../components/tag-link.ts\";\nimport { Things, Triples } from \"../../things/things.ts\";\nimport { ExifRelations, KnownThings } from \"../../constants.js\";\nimport { parseUrn } from \"js/library/tribble.js\";\n\nexport class MetadataPage extends LitElem {\n  static get properties() {\n    return {\n      id: { type: String },\n      image: { type: Object },\n      semantic: { type: Object },\n      sharing: { state: true, type: Boolean },\n      triples: { type: Object, state: true },\n    };\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n\n    JSONFeed.setIndex();\n  }\n\n  renderAperture(exif) {\n    if (exif.f_stop === \"Unknown\") {\n      return html`<td>Unknown aperture</td>`;\n    } else if (exif.f_stop === \"0.0\") {\n      return html`<td>Manual aperture control</td>`;\n    }\n\n    return html`<td>\u0192/${exif.f_stop}</td>`;\n  }\n\n  renderFocalLength(exif) {\n    if (exif.focal_length === \"Unknown\") {\n      return html`${exif.focal_length}`;\n    } else if (exif.focal_length === \"0\") {\n      return html`<td>Manual lens</td>`;\n    } else {\n      return html`<td>${exif.focal_length}mm equiv.</td>`;\n    }\n  }\n\n  renderSemanticKey(key) {\n    return key.replace(/_/g, \" \").replace(/\\b\\w/g, (l) => l.toUpperCase());\n  }\n\n  renderSemanticValue(key, value) {\n    if (Array.isArray(value)) {\n      return html`<ul class=\"thing-list\">\n        ${\n        value.map((subval) =>\n          html`<li>${this.renderSemanticValue.call(this, key, subval)}</li>`\n        )\n      }\n      </ul>`;\n    }\n\n    if (key.includes(\"binomial\")) {\n      return html`<em>${value}</em>`;\n    }\n\n    if (key.toLowerCase() === \"summary\") {\n      return html`${unsafeHTML(value ?? \"\")}`;\n    }\n\n    if (Things.isRating(value)) {\n      const urn = `urn:r\u00F3:rating:${value}`;\n      return html`<thing-link .triples=${this.triples} .urn=\"${urn}\"></thing-link>`;\n    } else if (Things.isUrn(value) && Things.is(value, KnownThings.UNESCO)) {\n      return html`<unesco-link .urn=\"${value}\"></unesco-link>`;\n    } else if (Things.isUrn(value)) {\n      return html`<thing-link .triples=${this.triples} .urn=\"${value}\"></thing-link>`;\n    }\n\n    return value;\n  }\n\n  isIgnoredKey(key) {\n    // TODO remove this when semantic data is cleaned up\n    return (new Set([\n      \"bird_binomial\",\n      \"wildlife\",\n      \"living_conditions\",\n    ])).has(key);\n  }\n\n  renderSemanticData(triples: [string, string, string][]) {\n    return html`\n      <h3>Photo Information</h3>\n      <table class=\"metadata-table\">\n        ${\n      triples.sort((triple0, triple1) => {\n        return Triples.getRelation(triple0).localeCompare(\n          Triples.getRelation(triple1),\n        );\n      })\n        .filter((triple) => {\n          return !this.isIgnoredKey(Triples.getRelation(triple));\n        })\n        .map((triple) => {\n          return html`\n          <tr>\n            <th class=\"exif-heading\">${\n            this.renderSemanticKey(Triples.getRelation(triple))\n          }</th>\n              <td>${\n            this.renderSemanticValue(\n              Triples.getRelation(triple),\n              Triples.getTarget(triple),\n            )\n          }</td>\n          `;\n        })\n    }\n      <table>\n    `;\n  }\n\n  renderExif(tdb) {\n    const exif = tdb.search({\n      source: {\n        type: \"photo\",\n        id: this.id,\n      },\n      relation: {\n        //relation: ExifRelations,\n      },\n    }).firstObject();\n\n    if (!exif) {\n      return html`<p>No EXIF data available</p>`;\n    }\n\n    return html`\n    <h3>Exif</h3>\n\n    <table class=\"metadata-table\">\n      <tr>\n        <th class=\"exif-heading\">Date-Time</th>\n        <td><time>\n        ${exif.created_at}\n      </time></td>\n      </tr>\n      <tr>\n        <th class=\"exif-heading\">Camera Model</th>\n        <td><thing-link .triples=${this.triples} urn=${exif.model}></thing-link></td>\n        </tr>\n      <tr>\n        <th class=\"exif-heading\">Dimensions</th>\n        <td>${exif.width} x ${exif.height}</td>\n      </tr>\n      <tr>\n        <th class=\"exif-heading\">Focal Length</th>\n        ${this.renderFocalLength(exif)}\n      </tr>\n      <tr>\n        <th class=\"exif-heading\">Shutter Speed</th>\n        <td>1/${\n      exif.exposure_time ? Math.round(1 / exif.exposure_time) : \"Unknown\"\n    }</td>\n      </tr>\n      <tr>\n        <th class=\"exif-heading\">Aperture</th>\n        ${this.renderAperture(exif)}\n        </tr>\n      <tr>\n        <th class=\"exif-heading\">ISO</th>\n        <td>${exif.iso}</td>\n      </tr>\n    </table>\n    `;\n  }\n\n  render() {\n    const photo = this.image;\n    const albumId = photo.album_id;\n\n    const tdb = this.triples;\n    const imageTriples = tdb.search({\n      source: {\n        id: parseUrn(photo.id).id,\n      },\n      relation: {\n        predicate: (relation: string) => {\n          const TODO = new Set([\n            \"album_id\",\n            \"full_image\",\n            \"mosaic_colours\",\n            \"thumbnail_url\",\n          ]);\n          return !ExifRelations.has(relation) && !TODO.has(relation);\n        },\n      },\n    }).triples();\n\n    return html`\n    <section>\n    <h1>Metadata</h1>\n\n    <img class=\"u-photo thumbnail-image\" src=\"${photo.thumbnail_url}\"/>\n\n      <p>\n        <a href=\"${photo.full_image}\">[full image]</a>\n        <share-metadata-button format=\"image/webp\" url=${photo.image_url}></share-metadata-button>\n        <a href=\"#/album/${albumId}\">[album]</a>\n      </p>\n\n      ${this.renderSemanticData(imageTriples)}\n      ${this.renderExif(tdb)}\n\n    </section>\n    `;\n  }\n}\n\ncustomElements.define(\"metadata-page\", MetadataPage);\n", "/*\n * /#/about\n *\n * The website's about page.\n */\n\nimport { html } from \"../../library/lit.js\";\n\nimport \"../components/photo.ts\";\nimport { JSONFeed } from \"../../services/json-feed.ts\";\nimport { LitElem } from \"../../models/lit-element.ts\";\n\nexport class AboutPage extends LitElem {\n  static get properties() {\n    return {};\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n\n    JSONFeed.setIndex();\n  }\n\n  render() {\n    return html`\n    <div>\n      <section class=\"about-page\">\n        <h1>About</h1>\n\n        <h2>Can I use the photos on this site?</h2>\n\n        <p>You may use this website and its content for personal, non-commerical purposes only. For example, using photos as a desktop wallpaper is fine, selling these photos is not.</p>\n\n        <h2>Can I use data from this site to train AI?</h2>\n\n        <p>No, absolutely not. The <a href=\"http://photos.rgrannell.xyz/robots.txt\">robots.txt</a> file for this site explicitly prohibits this.</p>\n\n        <h2>What is your contact information?</h2>\n\n        <p>See <a href=\"https://rgrannell.xyz/\">my personal site</a> for contact details.</p>\n\n        </section>\n    </div>\n    `;\n  }\n}\n\ncustomElements.define(\"about-page\", AboutPage);\n", "/*\n * /#/thing/:urn\n *\n * Details about subjects or places of a photo\n */\n\nimport { html } from \"../../library/lit.js\";\nimport { asUrn, parseUrn } from \"../../library/tribble.js\";\n\nimport \"../components/photo.ts\";\nimport { JSONFeed } from \"../../services/json-feed.ts\";\nimport { LitElem } from \"../../models/lit-element.ts\";\nimport { BinomialTypes, KnownRelations } from \"../../constants.js\";\nimport { Binomials, Things } from \"../../things/things.ts\";\nimport { Photos } from \"../../services/photos.ts\";\nimport { URN } from \"js/types.ts\";\n\nexport class ThingPage extends LitElem {\n  static get properties() {\n    return {\n      urn: { type: String },\n      triples: { type: Object, state: true },\n    };\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n\n    JSONFeed.setIndex();\n  }\n\n  urnImages(tdb: any, query: any) {\n    const relevantPhotos = tdb.search(query);\n    const relevantPhotoIds = relevantPhotos.sources();\n\n    return Array.from(relevantPhotoIds).flatMap((photoId: string) => {\n      if (photoId.startsWith('urn:r\u00F3')) {\n        const match = tdb.search({\n          source: asUrn(photoId),\n        }).firstObject();\n\n        return match ? [match] : [];\n      }\n\n      const match = tdb.search({\n        source: { id: photoId, type: \"photo\" },\n      }).firstObject();\n\n      return match ? [match] : [];\n    });\n  }\n\n  renderSubjectPhotos(images: Record<string, string>[]) {\n    return images\n      .sort((photo0, photo1) => {\n        return photo1.created_at - photo0.created_at;\n      })\n      .map((photo, idx) => {\n        return html`\n      <app-photo\n        id=${photo.id.startsWith(\"urn:\") ? parseUrn(photo.id).id : photo.id}\n        loading=\"${Photos.loadingMode(idx)}\"\n        thumbnailUrl=\"${photo.thumbnail_url}\"\n        mosaicColours=\"${photo.mosaic_colours}\"\n        imageUrl=\"${photo.full_image}\"></app-photo>`;\n      });\n  }\n\n  getAlbums() {\n    return this.triples.search({\n      source: { type: \"album\" },\n    }).objects();\n  }\n\n  renderSubjectAlbums(tdb, search) {\n    const filtered = this.urnImages(tdb, search);\n\n    const albumSet = new Set(filtered.map((photo) => {\n      return photo.album_id;\n    }));\n\n    return Array\n      .from(albumSet)\n      .flatMap((albumId) => {\n        return this.getAlbums().filter((album) => {\n          return parseUrn(album.id).id === albumId;\n        });\n      })\n      .sort((album0, album1) => {\n        return album1.min_date - album0.min_date;\n      })\n      .map((album) => {\n        return html`\n          <photo-album\n            .triples=${this.triples}\n            title=\"${album.name}\"\n            url=\"${album.thumbnail_url}\"\n            mosaicColours=\"${album.mosaic}\"\n            id=\"${album.id}\"\n            count=\"${album.photos_count}\"\n            minDate=\"${album.min_date}\"\n            maxDate=\"${album.max_date}\"\n            countries=\"${album.flags}\"\n            loading=\"eager\">\n            </photo-album>\n      `;\n      });\n  }\n\n  // todo push into semantic layer\n  firstPhotographed(images, tdb, query) {\n    const relevantPhotos = this\n      .urnImages(tdb, query)\n      .sort((photo0, photo1) => {\n        return photo0.created_at - photo1.created_at;\n      });\n\n    const first = relevantPhotos[0];\n    if (!first) {\n      return \"Unknown\";\n    }\n\n    return new Date(parseInt(first.created_at)).toLocaleDateString(\"en-IE\", {\n      day: \"numeric\",\n      month: \"short\",\n      year: \"numeric\",\n    });\n  }\n\n  renderTitle() {\n    const { id, type } = Things.parseUrn(this.urn);\n\n    const definedName = this.triples.search({\n      source: { id, type },\n      relation: KnownRelations.NAME,\n    }).firstTarget();\n\n    if (definedName) {\n      return definedName;\n    }\n\n    try {\n      const parsedUrn = Things.parseUrn(this.urn);\n      const value = decodeURIComponent(parsedUrn.id);\n\n      if (parsedUrn.id === \"*\") {\n        return `${parsedUrn.type.charAt(0).toUpperCase()}${\n          parsedUrn.type.slice(1)\n        }`;\n      }\n\n      if (BinomialTypes.has(parsedUrn.type)) {\n        return Binomials.toCommonName(this.triples, value);\n      }\n\n      return value;\n    } catch (_) {\n      return this.urn;\n    }\n  }\n\n  renderClassification(type: string) {\n    return html`<a href=\"#/thing/${type}:*\">${type.charAt(0).toUpperCase()}${\n      type.slice(1)\n    }</a>`;\n  }\n\n  getPhotoQueries(urn: URN) {\n    const target: Partial<URN> = urn;\n    if (target.id === \"*\") {\n      delete target.id;\n    }\n\n    const queries = [];\n    if (BinomialTypes.has(urn.type)) {\n      for (const label of [\"captivity\", \"wild\"]) {\n        const qs = { context: label };\n\n        const target = { ...urn, ...{ qs } };\n        queries.push({\n          label,\n          query: { target },\n        });\n      }\n    } else {\n      // todo, search where QS is missing\n      queries.push({\n        label: \"default\",\n        query: {\n          target: urn,\n        },\n      });\n    }\n\n    return queries;\n  }\n\n  renderPhotoSection(groups) {\n    return html`<div>\n    ${\n      Object.entries(groups).flatMap(([label, groupPhotos]) => {\n        if (!groupPhotos) {\n          return [];\n        }\n        if (groupPhotos.length === 0) {\n          return [];\n        }\n\n        if (label === \"default\") {\n          return [html`\n        <div class=\"photo-group\">\n          ${groupPhotos}\n        </div>\n        `];\n        }\n\n        return [html`\n        <div class=\"photo-group\">\n          <h4>${label.charAt(0).toUpperCase() + label.slice(1)}</h4>\n          ${groupPhotos}\n        </div>\n      `];\n      })\n    }\n    <div/>`;\n  }\n\n  render() {\n    // Show a Name, URN, Description,\n    // Wikilinks, and all images with this ARN\n    // Support bird:* level queries\n    const tdb = this.triples;\n\n    const images = tdb.search({\n      source: { type: \"photo\" },\n    }).objects();\n    const urn = Things.parseUrn(this.urn);\n\n    const type = urn.type;\n\n    const urnFacts = tdb.search({\n      source: asUrn(this.urn),\n    }).firstObject() ?? {};\n\n    const metadata = Object.assign({\n      \"Classification\": this.renderClassification(type),\n    });\n\n    if (urnFacts.country) {\n      metadata[\"Country\"] =\n        html`<thing-link .triples=${this.triples} urn=${urnFacts.country}></thing-link>`;\n    }\n\n    if (urnFacts.fcode_name) {\n      const fcodeName = urnFacts.fcode_name;\n      metadata[\"Place Type\"] = html`${fcodeName.charAt(0).toUpperCase()}${\n        fcodeName.slice(1)\n      }`;\n    }\n\n    if (BinomialTypes.has(type)) {\n      // TODO move to fact layer, not render layer\n      metadata[\"First Photographed\"] = html`<span>${\n        this.firstPhotographed(images, tdb, {\n          target: asUrn(this.urn),\n        })\n      }</span>`;\n    }\n\n    const wikipedia = urnFacts[KnownRelations.WIKIPEDIA];\n    const birdwatchUrl = urnFacts[KnownRelations.BIRDWATCH_URL];\n    const longitude = urnFacts[KnownRelations.LONGITUDE];\n    const latitude = urnFacts[KnownRelations.LATITUDE];\n\n    let location;\n    if (longitude && latitude) {\n      const googleMapsUrl =\n        `https://www.google.com/maps?q=${latitude},${longitude}`;\n      location = html`\n      <a href=\"${googleMapsUrl}\" target=\"_blank\" rel=\"noopener\">[maps]</a>\n      `;\n    }\n\n    // TODO; rework photos to allow group by function\n    const targetSearch = asUrn(this.urn);\n    if (targetSearch.id === \"*\") {\n      // don't filter by ID in this case\n      delete targetSearch.id;\n    }\n\n    const query = {\n      target: targetSearch\n    };\n\n    const queries = this.getPhotoQueries(asUrn(this.urn));\n\n    const photoGroups = {};\n    for (const { query, label } of queries) {\n      const relevantPhotos = this.urnImages(tdb, query);\n      photoGroups[label] = this.renderSubjectPhotos(relevantPhotos);\n    }\n\n    const albums = this.renderSubjectAlbums(tdb, query);\n    const photos = this.renderPhotoSection(photoGroups);\n\n    return html`\n      <div>\n      <section class=\"thing-page\">\n        <h1>${this.renderTitle()}</h1>\n\n        <p>\n          ${\n      BinomialTypes.has(type) && urn.id !== \"*\"\n        ? html`<span class=\"thing-binomial\">(${\n          Binomials.pretty(urn.id)\n        })</span>`\n        : html``\n    }\n        </p>\n        <br>\n\n        ${\n      wikipedia\n        ? html`<a href=\"${wikipedia}\" target=\"_blank\" rel=\"noopener\">[wikipedia]</a>`\n        : html``\n    }\n        ${\n      birdwatchUrl\n        ? html`<a href=\"${birdwatchUrl}\" target=\"_blank\" rel=\"noopener\">[birdwatch]</a>`\n        : html``\n    }\n        ${location ? html`<span class=\"location\">${location}</span>` : html``}\n\n        <h3>Metadata</h3>\n        <table class=\"metadata-table\">\n        ${\n      Object.entries(metadata).map(\n        ([key, value]) =>\n          html`\n          <tr>\n            <th class=\"exif-heading\">${key}</th>\n            <td>${value}</td>\n          </tr>\n          `,\n      )\n    }\n        </table>\n\n        <br>\n        ${photos}\n\n        <h3>Albums</h3>\n\n        </section>\n\n        <section class=\"album-container\">\n          ${albums}\n        </section>\n\n      </div>\n    `;\n  }\n}\n\ncustomElements.define(\"thing-page\", ThingPage);\n", "/*\n * Utility classes for dealing with videos\n */\n\nexport class Videos {\n  /*\n   * Determine whether a photo should be eagerly or lazily loaded\n   * depending on page position\n   */\n  static loadingMode(idx: number) {\n    // mmhh, I just want length and the first frame\n    //something more sophisticated is needed to reduce parallel requests\n    return idx === 0 ? \"auto\" : \"none\";\n  }\n}\n", "/*\n * #/videos\n *\n * List all videos in a grid, with differen quality options available.\n */\n\nimport { html } from \"../../library/lit.js\";\n\nimport { asyncAppend } from \"../../library/lit.js\";\nimport \"../components/video.ts\";\nimport { JSONFeed } from \"../../services/json-feed.ts\";\nimport { LitElem } from \"../../models/lit-element.ts\";\nimport { Videos } from \"../../services/videos.ts\";\n\nexport class VideosPage extends LitElem {\n  static get properties() {\n    return {\n      triples: { type: Object, state: true },\n    };\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    JSONFeed.setIndex();\n  }\n\n  getVideos() {\n    return this.triples.search({\n      source: { type: \"video\" },\n    }).objects();\n  }\n\n  render() {\n    const videos = this.getVideos();\n\n    async function* videosIterable() {\n      for (let idx = 0; idx < videos.length; idx++) {\n        const video = videos[idx];\n\n        if (idx % 4 === 0) {\n          await new Promise(res => setTimeout(res, 0));\n        }\n\n        yield html`<app-video\n          id=${video.id}\n          url_poster=${video.poster_url}\n          url_unscaled=${video.video_url_unscaled}\n          url_1080p=${video.video_url_1080p}\n          url_720p=${video.video_url_720p}\n          url_480p=${video.video_url_480p}\n          preload=\"${Videos.loadingMode(idx)}\"\n        ></app-video>`;\n      }\n    }\n\n    return html`\n    <div>\n      <section class=\"photos-metadata\">\n        <h1>Videos</h1>\n        <p class=\"photo-album-count\">${videos.length} videos</p>\n      </section>\n\n      <section class=\"photo-container\">\n        ${asyncAppend(videosIterable())}\n      </section>\n    </div>\n    `;\n  }\n}\n\ncustomElements.define(\"videos-page\", VideosPage);\n", "import { html } from \"../library/lit.js\";\nimport { LitElem } from \"../models/lit-element.ts\";\nimport { TribblesArtifact } from \"../models/artifacts.ts\";\n\nimport { PageLocation } from \"../services/location.ts\";\nimport { Pages } from \"../constants.js\";\n\nimport \"./components/sidebar.ts\";\nimport \"./components/header.ts\";\nimport \"./pages/photos.ts\";\nimport \"./pages/albums.ts\";\nimport \"./pages/album.ts\";\nimport \"./pages/metadata.ts\";\nimport \"./pages/about.ts\";\nimport \"./pages/thing.ts\";\nimport \"./pages/videos.ts\";\nimport { TribbleDB } from \"js/library/tribble.js\";\n\nimport {\n  countriesAsUrns,\n  expandBirdwatchUrl,\n  expandCdnUrls,\n  expandUrns,\n  ratingsAsUrns,\n} from \"../things/things.ts\";\nimport { Triple } from \"js/types.ts\";\n\nconst tripleProcessors = [\n  expandUrns,\n  ratingsAsUrns,\n  countriesAsUrns,\n  expandCdnUrls,\n  expandBirdwatchUrl\n];\n\nfunction processTriples(triple: Triple): Triple[] {\n  // derive new triples or modify old ones,\n  // sequentially apply functions against intermediate results\n\n  let outputTriples = [triple];\n  for (const fn of tripleProcessors) {\n    outputTriples = outputTriples.flatMap(fn);\n  }\n\n  return outputTriples;\n}\n\nconst tribbles = new TribblesArtifact();\n\nexport class PhotoApp extends LitElem {\n  static DEFAULT_PAGE = Pages.ALBUMS;\n\n  // TODO dislike, move to constants\n  static LOCATION_TYPE_TO_PAGE = {\n    \"album\": Pages.ALBUM,\n    \"albums\": Pages.ALBUMS,\n    \"photos\": Pages.PHOTOS,\n    \"metadata\": Pages.METADATA,\n    \"about\": Pages.ABOUT,\n    \"videos\": Pages.VIDEOS,\n    \"thing\": Pages.THING,\n  };\n\n  sidebarVisible: boolean\n  tribbleDB: object\n\n  static get properties() {\n    return {\n      title: { type: String },\n      page: { type: String },\n      sidebarVisible: { type: Boolean, state: true },\n      id: { type: String },\n      imageUrl: { type: String },\n      thumbnailUrl: { type: String },\n      route: { type: String },\n      params: { type: Object },\n      query: { type: Object },\n      darkMode: { type: Boolean },\n      tribbleDB: {\n        type: Object,\n        state: true,\n        attribute: false\n      },\n    };\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.setStateFromUrl();\n    this.requestUpdate();\n\n    this._onPopState = this.handlePopState.bind(this);\n    this.sidebarVisible = false;\n    window.addEventListener(\"popstate\", this._onPopState);\n\n    (async () => {\n      const buffer: Triple[] = [];\n      if (!this.tribbleDB) {\n        this.tribbleDB = new TribbleDB([]);\n      }\n\n      for await (const triple of tribbles.stream()) {\n        buffer.push(...[triple].flatMap(processTriples));\n\n        if (buffer.length > 500) {\n          this.tribbleDB.add(buffer);\n          this.tribbleDB = this.tribbleDB;\n          buffer.length = 0;\n          this.requestUpdate();\n        }\n      }\n\n      this.tribbleDB.add(buffer);\n      // don't love this; it forces re-render\n      this.tribbleDB = this.tribbleDB.clone();\n\n      this.requestUpdate();\n    })();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    window.removeEventListener(\"popstate\", this._onPopState);\n  }\n\n  handlePopState() {\n    this.setStateFromUrl();\n    this.requestUpdate();\n  }\n\n  /*\n   * Extract the page-type and other attributes from the URL\n   * and set the state accordingly\n   */\n  setStateFromUrl() {\n    const location = PageLocation.getUrl();\n\n    if (PhotoApp.LOCATION_TYPE_TO_PAGE[location?.type]) {\n      this.page = PhotoApp.LOCATION_TYPE_TO_PAGE[location.type];\n    } else {\n      console.error(\"did not match pagetype\", location?.type);\n      this.page = PhotoApp.DEFAULT_PAGE;\n    }\n\n    // set additional state from the url\n    if (PageLocation.pageUsesId(this.page)) {\n      this.id = location.id;\n    }\n  }\n\n  /*\n   * Navigate to the album page\n   */\n  receiveClickAlbum(event: CustomEvent) {\n    const {\n      title,\n      id,\n    } = event.detail;\n\n    this.page = Pages.PHOTOS;\n    this.id = id;\n    this.title = title;\n\n    PageLocation.showAlbumUrl(id);\n  }\n\n  /*\n   * When we click on the burger menu icon, toggle the sidebar\n   */\n  async receiveClickBurgerMenu() {\n    this.sidebarVisible = !this.sidebarVisible;\n  }\n\n  /*\n   * When we click on a photo's info icon, navigate to the photo's metadata page\n   */\n  async receiveClickPhotoMetadata(event: CustomEvent) {\n    const {\n      id,\n      imageUrl,\n      thumbnailUrl,\n    } = event.detail;\n\n    this.page = Pages.METADATA;\n    this.id = id;\n    this.imageUrl = imageUrl;\n    this.thumbnailUrl = thumbnailUrl;\n\n    PageLocation.showMetadataUrl(id);\n  }\n\n  /*\n   * Toggle between light and dark mode\n   */\n  receiveSwitchTheme(_) {\n    this.darkMode = !this.darkMode;\n\n    localStorage.setItem(\"darkMode\", this.darkMode.toString());\n\n    this.requestUpdate();\n  }\n\n  /*\n   * On @navigate-page, update the URL\n   * by using the `PageLocation` service\n   */\n  receiveNavigatePage(event: CustomEvent) {\n    // state updates\n    this.page = event.detail.page;\n    this.sidebarVisible = false;\n\n    const router = PageLocation.router(this.page);\n    if (!router) {\n      console.error(`no router found for page ${this.page}`);\n    }\n\n    if (PageLocation.pageUsesId(this.page)) {\n      router(this.id);\n    } else {\n      router();\n    }\n  }\n\n  pageClasses(sidebarVisible: boolean) {\n    const classes = [\"page\"];\n\n    if (sidebarVisible) {\n      classes.push(\"sidebar-visible\");\n    }\n\n    return classes.join(\" \");\n  }\n\n  /*\n   * Render the subpage (e.g metadata, albums, photos, etc.)\n   */\n  renderPage(sidebarVisible: boolean) {\n    const classes = this.pageClasses(sidebarVisible);\n\n    if (!this.page || this.page === \"albums\") {\n      return html`\n      <albums-page .triples=${this.tribbleDB} class=\"${classes}\"></albums-page>\n      `;\n    }\n\n    if (this.page === Pages.ABOUT) {\n      return html`<about-page class=\"${classes}\"></about-page>`;\n    }\n\n    if (this.page === Pages.PHOTOS) {\n      return html`<photos-page .triples=${this.tribbleDB} class=\"${classes}\"></photos-page>`;\n    }\n\n    if (this.page === Pages.ALBUM) {\n      if (!this.id) {\n        console.error(\"no album id provided\");\n      }\n\n      const album = this.tribbleDB.search({\n        source: { type: \"album\", id: this.id },\n      }).firstObject();\n\n      if (!album) {\n        console.error(`failed to find album with id ${this.id}`);\n      }\n      return html`\n      <album-page\n        .triples=${this.tribbleDB}\n        title=${album.name}\n        id=${this.id}\n        minDate=${album.min_date}\n        maxDate=${album.max_date}\n        imageCount=${album.photos_count}\n        description=${album.description}\n        countries=${album.flags}\n        class=\"${classes}\"></album-page>\n      `;\n    }\n\n    if (this.page === Pages.METADATA) {\n      const image = this.tribbleDB.search({\n        source: { type: \"photo\", id: this.id },\n      }).firstObject();\n\n      if (!image) {\n        console.error(`failed to find photo with id ${this.id}`);\n      }\n\n      return html`\n      <metadata-page\n        .triples=${this.tribbleDB}\n        .image=${image}\n        id=${this.id} class=\"${classes}\"></metadata-page>\n      `;\n    }\n\n    if (this.page === Pages.VIDEOS) {\n      return html`\n      <videos-page .triples=${this.tribbleDB} class=\"${classes}\"></videos-page>\n      `;\n    }\n\n    if (this.page === Pages.THING) {\n      return html`\n      <thing-page\n        .urn=${\"urn:r\u00F3:\" + this.id}\n        .triples=${this.tribbleDB}\n        class=\"${classes}\"></thing-page>\n      `;\n    }\n  }\n\n  /*\n   * Check if dark mode is enabled by examining this component\n   * and localstorage.#\n   */\n  loadDarkMode() {\n    if (typeof this.darkMode !== \"undefined\") {\n      return this.darkMode;\n    }\n    return localStorage.getItem(\"darkMode\") === \"true\";\n  }\n\n  render() {\n    const classes = [\"app-container\"];\n    if (this.sidebarVisible) {\n      classes.push(\"sidebar-visible\");\n    }\n\n    const $html = document.documentElement;\n    const topLevelClasses = [\"photos-app\"];\n    if (this.darkMode) {\n      $html.classList.add(\"dark-mode\");\n      topLevelClasses.push(\"dark-mode\");\n    } else {\n      $html.classList = [];\n    }\n\n    // events are mostly handled here\n    return html`\n    <body>\n      <div class=\"${topLevelClasses.join(\" \")}\"\n        @click-album=${this.receiveClickAlbum}\n        @click-burger-menu=${this.receiveClickBurgerMenu}\n        @click-photo-metadata=${this.receiveClickPhotoMetadata}\n        @switch-theme=${this.receiveSwitchTheme}\n        @navigate-page=${this.receiveNavigatePage}>\n\n        <photo-header .darkMode=${this.loadDarkMode()}></photo-header>\n\n        <div class=\"${classes.join(\" \")}\">\n            <photo-sidebar visible=${this.sidebarVisible}></photo-sidebar>\n            ${this.renderPage(this.sidebarVisible)}\n        </div>\n      </div>\n    </body>\n    `;\n  }\n}\n\ncustomElements.define(\"photo-app\", PhotoApp);\n"],
  "mappings": "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",
  "names": ["t", "s", "i", "e", "n", "r", "h", "e", "s", "t", "n", "c", "i", "r", "l", "a", "u", "d", "f", "p", "v", "y", "m", "b", "g", "w", "_", "S", "$", "T", "x", "E", "C", "P", "M", "A", "k", "O", "U", "V", "R", "N", "L", "z", "j", "D", "H", "I", "B", "W", "Z", "q", "F", "G", "J", "K", "Y", "Q", "X", "tt", "_tt", "o", "rt", "ot", "ht", "nt", "st", "it", "et", "ct", "lt", "at", "ut", "dt", "ft", "pt", "dt", "mt", "lt", "bt", "t", "wt", "t", "s", "_t", "Tt", "t", "xt", "Et", "s", "i", "e", "n", "r", "mt", "o", "Ct", "Pt", "Mt", "At", "kt", "Ot", "Vt", "t", "s", "Rt", "i", "Nt", "Lt", "zt", "Ht", "jt", "Dt", "e", "n", "It", "Tt", "Bt", "Wt", "Zt", "G", "r", "o", "qt", "Ft", "Ot", "Et", "Ct", "Gt", "_t", "Jt", "wt", "At", "ut", "J", "Mt", "Yt", "Vt", "Rt", "t", "s", "i", "e", "G", "Qt", "Xt", "is", "Vt", "Rt", "J", "t", "s", "i", "Mt", "es", "Tt", "G", "e", "cs", "ls", "Vt", "It", "t", "J", "s", "i", "as", "e", "n", "us", "Rt", "r", "At", "c", "l", "a", "u", "d", "f", "p", "Ct", "Et", "kt", "Mt", "G", "ds", "fs", "ps", "vs", "ys", "ms", "bs", "gs", "ws", "bt", "_s", "Ss", "Bt", "Wt", "o", "$s", "xs", "Es", "t", "Ms", "As", "t", "s", "i", "e", "n", "r", "c", "l", "a", "Es", "ks", "Z", "Os", "q", "LitElem", "ft", "label", "detail", "dispatched", "IndexedSet", "#idx", "#map", "#reverseMap", "value", "index", "idx", "Sets", "metrics", "sets", "setA", "setB", "acc", "currentSet", "TribbleParser", "line", "match", "src", "rel", "tgt", "id", "parseUrn", "urn", "namespace", "type", "urnPart", "queryString", "id", "qs", "asUrn", "value", "IndexPerformanceMetrics", "TribbleDBPerformanceMetrics", "Index", "triples", "IndexedSet", "startIdx", "jdx", "idx", "triple", "parsedSource", "relation", "parsedTarget", "sourceTypeIdx", "sourceIdIdx", "relationIdx", "targetTypeIdx", "targetIdIdx", "key", "val", "qsIdx", "sourceIdx", "targetIdx", "index", "typeIdx", "idIdx", "Triples", "joinSubqueryResults", "metrics", "acc", "tripleResult", "joinedNames", "endings", "starts", "refId", "commonLinks", "Sets", "joinedRows", "link", "startRowIndices", "endRowsIndices", "startRowIndex", "endRowIndex", "joinedRow", "TribbleDB", "_TribbleDB", "clonedDB", "objects", "obj", "relations", "target", "sub", "oldLength", "fn", "flatMappedTriples", "first", "listOnly", "output", "objs", "source", "#findMatchingRows", "params", "matchingRowSets", "allowedKeys", "sourceTypeSet", "sourceIdSet", "sourceQsSet", "targetTypeSet", "targetIdSet", "targetQsSet", "relationDsl", "unionedRelations", "rel", "relationSet", "elem", "intersection", "matchingTriples", "isValid", "rowIdx", "query", "bindings", "subqueryResults", "tripleSlice", "pattern", "bindingNames", "pair", "tripleRows", "rowData", "row", "contents", "queryResult", "outputNames", "data", "label", "CONFIG", "TribblesArtifact", "url", "parser", "TribbleParser", "response", "decoder", "reader", "buffer", "value", "done", "lines", "line", "triple", "ALBUMS_SYMBOL", "IMAGES_SYMBOL", "MANIFEST_SYMBOL", "VIDEOS_SYMBOL", "SEMANTIC_SYMBOL", "STATS_SYMBOL", "TRIPLES_SYMBOL", "BRAND_TEXT", "Pages", "KnownThings", "KnownRelations", "ExifRelations", "BinomialTypes", "PageLocation", "_PageLocation", "Pages", "page", "id", "urn", "Sidebar", "LitElem", "classes", "Z", "PhotoHeader", "LitElem", "text", "brandText", "BRAND_TEXT", "Z", "coloursCache", "Photos", "idx", "viewportWidth", "viewportHeight", "imageDimension", "maxImagesPerRow", "maxRowsInFold", "colours", "coloursList", "colour", "canvas", "ctx", "AppPhoto", "LitElem", "Z", "event", "$placeholder", "broadcastId", "parseUrn", "photoMetadata", "Photos", "div", "sanitisedDangerously", "JSONFeed", "tag", "$rss", "feedUrl", "PhotosPage", "LitElem", "JSONFeed", "left", "right", "photos", "photosIterable", "idx", "photo", "res", "Z", "asUrn", "Photos", "Ft", "PhotosStats", "LitElem", "$statsData", "stats", "Z", "Dates", "_Dates", "dateTime", "date", "time", "createdAt", "images", "minimum", "maximum", "image", "parsedDate", "minDate", "maxDate", "smallDevice", "parsedMinDate", "parsedMaxDate", "optsShort", "from", "to", "minDay", "maxDay", "minMonth", "maxMonth", "minYear", "maxYear", "monthsEqual", "yearsEqual", "opts", "CONFIG", "Triples", "triple", "Things", "relation", "_Things", "candidate", "urn", "type", "urnPart", "queryString", "id", "qs", "urn1", "urn2", "parsed1", "parsed2", "value", "urn0", "parsed0", "Binomials", "binomial", "pretty", "tdb", "KnownRelations", "parseUrn", "Countries", "name", "countriesData", "parsed", "flag", "ratingsAsUrns", "countriesAsUrns", "countryUrn", "expandCdnUrls", "expandBirdwatchUrl", "expandUrns", "source", "target", "PhotoAlbum", "LitElem", "mediaQuery", "Dates", "event", "$placeholder", "country", "flag", "urn", "Countries", "parsed", "parseUrn", "Z", "thumbnailDataUrl", "Photos", "flags", "albumId", "YearCursor", "LitElem", "yearCursor", "dates", "firstBelowPositionHeight", "row", "idx", "minimumDate", "item", "monthYearString", "$dates", "details", "date", "minDate", "Z", "AlbumsPage", "LitElem", "JSONFeed", "album", "sorted", "album0", "album1", "albumIterable", "year", "currentYear", "idx", "loading", "Photos", "albumYear", "Z", "res", "Ft", "AppVideo", "LitElem", "Z", "AlbumShareButton", "LitElem", "url", "Z", "UnescoLink", "LitElem", "Things", "Z", "ThingLink", "type", "id", "BinomialTypes", "Binomials", "name", "KnownRelations", "KnownThings", "AlbumPage", "LitElem", "JSONFeed", "tdb", "albumPhotoSources", "source", "info", "parseUrn", "albumVideoIds", "groups", "albumPhotos", "type", "KnownThings", "photo", "KnownRelations", "location", "Things", "val", "subject", "links", "urn", "Z", "mediaQuery", "range", "Dates", "photos", "idx", "Photos", "videos", "video", "flags", "country", "flag", "Countries", "parsed", "ms", "link", "ShareButton", "LitElem", "url", "response", "resourceName", "Z", "TagLink", "LitElem", "tagName", "count", "encodedTagName", "Z", "MetadataPage", "LitElem", "JSONFeed", "exif", "Z", "key", "l", "value", "subval", "ms", "Things", "urn", "KnownThings", "triples", "triple0", "triple1", "Triples", "triple", "tdb", "photo", "albumId", "imageTriples", "parseUrn", "relation", "TODO", "ExifRelations", "AboutPage", "LitElem", "JSONFeed", "Z", "ThingPage", "LitElem", "JSONFeed", "tdb", "query", "relevantPhotoIds", "photoId", "match", "asUrn", "images", "photo0", "photo1", "photo", "idx", "Z", "parseUrn", "Photos", "search", "filtered", "albumSet", "albumId", "album", "album0", "album1", "first", "id", "type", "Things", "definedName", "KnownRelations", "parsedUrn", "value", "BinomialTypes", "Binomials", "urn", "target", "queries", "label", "groups", "groupPhotos", "urnFacts", "metadata", "fcodeName", "wikipedia", "birdwatchUrl", "longitude", "latitude", "location", "googleMapsUrl", "targetSearch", "photoGroups", "relevantPhotos", "albums", "photos", "key", "Videos", "idx", "VideosPage", "LitElem", "JSONFeed", "videos", "videosIterable", "idx", "video", "res", "Z", "Videos", "Ft", "tripleProcessors", "expandUrns", "ratingsAsUrns", "countriesAsUrns", "expandCdnUrls", "expandBirdwatchUrl", "processTriples", "triple", "outputTriples", "fn", "tribbles", "TribblesArtifact", "PhotoApp", "_PhotoApp", "LitElem", "Pages", "buffer", "TribbleDB", "location", "PageLocation", "event", "title", "id", "imageUrl", "thumbnailUrl", "_", "router", "sidebarVisible", "classes", "Z", "album", "image", "$html", "topLevelClasses"]
}
